"use strict";(self.webpackChunktermmy=self.webpackChunktermmy||[]).push([[912],{7304:(D,Z,a)=>{a.d(Z,{Q:()=>E});var t=a(4650),e=a(7436),v=a(2340),_=a(4006),b=a(8262),P=a(3681),x=a(5048),h=a(4398),T=a(4329),C=a(6895),A=a(2248),M=a(3955),u=a(8804);function y(c,f){if(1&c&&(t.TgZ(0,"h4",3),t._uU(1),t.qZA()),2&c){const n=t.oxw();t.xp6(1),t.Oqu(n.title)}}function l(c,f){if(1&c&&(t.TgZ(0,"div",4),t._uU(1),t.qZA()),2&c){const n=t.oxw();t.xp6(1),t.hij(" ",n.text," ")}}let g=(()=>{class c{constructor(){this.dismissible=!1}static#e=this.\u0275fac=function(r){return new(r||c)};static#t=this.\u0275cmp=t.Xpm({type:c,selectors:[["app-alert"]],inputs:{type:"type",dismissible:"dismissible",title:"title",text:"text"},decls:3,vars:4,consts:[[3,"type","dismissible"],["class","alert-heading",4,"ngIf"],["class","alert-body",4,"ngIf"],[1,"alert-heading"],[1,"alert-body"]],template:function(r,s){1&r&&(t.TgZ(0,"ngb-alert",0),t.YNc(1,y,2,1,"h4",1),t.YNc(2,l,2,1,"div",2),t.qZA()),2&r&&(t.Q6J("type",s.type)("dismissible",s.dismissible),t.xp6(1),t.Q6J("ngIf",s.title),t.xp6(1),t.Q6J("ngIf",s.text))},dependencies:[C.O5,u.xm]})}return c})();function S(c,f){1&c&&(t.TgZ(0,"div"),t._UZ(1,"app-loader"),t.qZA())}function O(c,f){if(1&c&&(t.TgZ(0,"div",9),t._UZ(1,"app-alert",30),t.qZA()),2&c){const n=t.oxw(2);t.xp6(1),t.Q6J("type",n.appliedCodeMessage.valid?"success":"danger")("text",n.appliedCodeMessage.message)}}function L(c,f){1&c&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&c&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"paymentProcessing.needAcceptTermsAndPrivacyPolicy")," "))}function I(c,f){1&c&&t._UZ(0,"app-loader-small")}function U(c,f){if(1&c){const n=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div")(5,"div")(6,"h3",6),t._uU(7),t._UZ(8,"img",7),t.ALo(9,"translate"),t._UZ(10,"br"),t.qZA()(),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",8),t._uU(15," = "),t.qZA(),t.TgZ(16,"div")(17,"div")(18,"h3",6),t._uU(19),t._UZ(20,"br"),t.qZA()(),t.TgZ(21,"span"),t._uU(22),t.ALo(23,"translate"),t.qZA()()(),t.TgZ(24,"div",9)(25,"button",10),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.useTermmyCoins())}),t._uU(26),t.ALo(27,"translate"),t.qZA()()()(),t.TgZ(28,"div",11)(29,"ngx-stripe-elements",12),t._UZ(30,"ngx-stripe-payment",13),t.qZA()(),t.TgZ(31,"div",14)(32,"p",15),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"div",16)(36,"input",17),t.NdJ("ngModelChange",function(s){t.CHM(n);const m=t.oxw();return t.KtG(m.voucherCode=s)}),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"button",18),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.checkVoucherCode())}),t._UZ(39,"span",19),t._uU(40),t.ALo(41,"translate"),t.qZA()(),t.YNc(42,O,2,2,"div",20),t.qZA(),t.TgZ(43,"div",21)(44,"input",22),t.NdJ("ngModelChange",function(s){t.CHM(n);const m=t.oxw();return t.KtG(m.accept=s)}),t.qZA(),t.TgZ(45,"label",23),t._uU(46),t.ALo(47,"translate"),t.TgZ(48,"a",24),t._uU(49),t.ALo(50,"translate"),t.qZA(),t._uU(51),t.ALo(52,"translate"),t.TgZ(53,"a",25),t._uU(54),t.ALo(55,"translate"),t.qZA(),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.YNc(58,L,3,3,"div",26),t.qZA(),t.TgZ(59,"div",27)(60,"button",28),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.pay())}),t.YNc(61,I,1,0,"app-loader-small",0),t._UZ(62,"span",29),t._uU(63),t.ALo(64,"translate"),t.qZA()()()}if(2&c){const n=t.oxw();t.xp6(7),t.hij("",n.termmyCoinCount," "),t.xp6(1),t.s9C("title",t.lcZ(9,26,"recommended.termmyCoin")),t.xp6(4),t.Oqu(t.lcZ(13,28,"paymentProcessing.totalTermmyCoin")),t.xp6(7),t.hij("",n.convertedTermmyCoin.toFixed(2)," \u20ac "),t.xp6(3),t.Oqu(t.lcZ(23,30,"paymentProcessing.discountPrice")),t.xp6(3),t.Q6J("disabled",!(n.termmyCoinCount>0)),t.xp6(1),t.Oqu(t.lcZ(27,32,"paymentProcessing.usingTermmyCoin")),t.xp6(3),t.Q6J("stripe",n.stripe)("elementsOptions",n.elementsOptions),t.xp6(1),t.Q6J("appearance",n.appearance),t.xp6(3),t.Oqu(t.lcZ(34,34,"paymentProcessing.voucherTitle")),t.xp6(3),t.Q6J("placeholder",t.lcZ(37,36,"paymentProcessing.voucherPlaceholder"))("ngModel",n.voucherCode),t.xp6(2),t.Q6J("disabled",n.appliedCodeMessage.disabled),t.xp6(2),t.hij(" ",t.lcZ(41,38,"paymentProcessing.voucherApplyButton"),""),t.xp6(2),t.Q6J("ngIf",n.appliedCodeMessage),t.xp6(2),t.Q6J("ngModel",n.accept),t.xp6(2),t.hij(" ",t.lcZ(47,40,"paymentProcessing.acceptTermsAndPrivacyPolicyOne")," "),t.xp6(3),t.Oqu(t.lcZ(50,42,"paymentProcessing.acceptTermsAndPrivacyPolicyTerms")),t.xp6(2),t.hij(" ",t.lcZ(52,44,"paymentProcessing.acceptTermsAndPrivacyPolicyTermsAnd")," "),t.xp6(3),t.Oqu(t.lcZ(55,46,"paymentProcessing.acceptTermsAndPrivacyPolicyPrivacyPolicy")),t.xp6(2),t.hij(" ",t.lcZ(57,48,"paymentProcessing.acceptTermsAndPrivacyPolicyTwo")," "),t.xp6(2),t.Q6J("ngIf",n.submitted&&!n.accept),t.xp6(2),t.Q6J("disabled",!(n.accept&&!n.paying)),t.xp6(1),t.Q6J("ngIf",n.paying),t.xp6(2),t.hij("\xa0 ",n.buttonText?n.buttonText:n._helpService.replaceText(t.lcZ(64,50,"paymentProcessing.buttonText"),"#amount",n.amount),"")}}let E=(()=>{class c{constructor(n,r,s,m,i){this._service=n,this._helpService=r,this._storageService=s,this._translate=m,this._toastr=i,this.executeMethodEmitter=new t.vpe,this.elementsOptions={locale:"en"},this.stripe=this.stripeAccount?(0,e.kv)(v.N.STRIPE_KEY,{stripeAccount:this.stripeAccount}):(0,e.kv)(v.N.STRIPE_KEY),this.appearance={theme:"stripe",labels:"floating",variables:{colorPrimary:"#673ab7"}},this.paying=!1,this.accept=!1,this.clientData=new _.cw({firstname:new _.NI("",_.kI.required),lastname:new _.NI("",_.kI.required),email:new _.NI("",[_.kI.required,_.kI.email]),telephone:new _.NI("",[_.kI.required])}),this.appliedCodeMessage={disabled:!1},this.loader=!1,this.termmyCoinCount=0,this.convertedTermmyCoin=0,this.usedTermmyCoin=!1}ngOnInit(){this.setPaymentProcessingLanguage(),this.getTermmyCoin()}ngOnChanges(n){this.getProfileInfo(),this.createPaymentIntent(),this.originalAmount=this.amount}ngOnDestroy(){this._service.callPostMethod("api/payment/stripe/cancelPaymentIntent",{paymentId:this.paymentId}).subscribe(n=>{})}setPaymentProcessingLanguage(){this.elementsOptions.locale="sr-Latn"===this._storageService.getSelectedLanguage(!0)?"hr":this._storageService.getSelectedLanguage(!0),this._translate.onLangChange.subscribe(n=>{this.elementsOptions.locale="sr-Latn"===n.lang?"hr":this._storageService.getSelectedLanguage(!0)})}getProfileInfo(){this._service.callGetMethod("/api/getProfileInfo","").subscribe(n=>{if(n.length){const r=n[0];this.clientData.setValue({firstname:r.firstname,lastname:r.lastname,email:r.email,telephone:null})}})}getTermmyCoin(){this._service.callGetMethod("/api/getTermmyCoin").subscribe(n=>{this.termmyCoinCount=n,this.convertedTermmyCoin=n*v.N.TERMMY_COIN_PER_EURO})}createPaymentIntent(){this.loader=!0,this._service.callPostMethod("api/payment/stripe/createPaymentIntent",{amount:Number(this.amount),stripeAccount:this.stripeAccount}).subscribe(n=>{this.elementsOptions.clientSecret=n.client_secret,this.paymentId=n.id,this.loader=!1})}updatePaymentIntent(){this._service.callPostMethod("api/payment/stripe/updatePaymentIntent",{paymentId:this.paymentId,amount:Number(this.amount),stripeAccount:this.stripeAccount}).subscribe(n=>{this.elementsOptions.clientSecret=n})}pay(){this.paying=!0,this.stripe.confirmPayment({elements:this.paymentElement.elements,confirmParams:{payment_method_data:{billing_details:{name:this.clientData.value.firstname+" "+this.clientData.value.lastname,email:this.clientData.value.email,phone:this.clientData.value.telephone}}},redirect:"if_required"}).subscribe({next:n=>{console.log(n),n.error||!this.accept?(this._toastr.showErrorCustom(this._translate.instant("paymentProcessing.errorPayment")),this.paying=!1):"succeeded"===n.paymentIntent.status&&(this.paying=!1,this.usingVoucherCode(),this.resetTermmyCoins(),this.executeMethodEmitter.emit(),this.voucherCode=null,this.amount=this.originalAmount,this.appliedCodeMessage.disabled=!1,this.createPaymentIntent())},error:n=>{this.paying=!1}})}usingVoucherCode(){this.voucher&&this._service.callPostMethod("/api/setVoucherUsed",{id_voucher:this.voucher.id,id_partner:this.voucher.id_user,amount:this.amount}).subscribe(r=>{})}checkVoucherCode(){this.voucherCode&&this._service.callGetMethod("/api/checkVoucherCode",this.voucherCode).subscribe(n=>{n?(this.voucher=n,this.amount=Number((this.amount*(100-n.discount)/100).toFixed(2)),this.appliedCodeMessage={valid:!0,disabled:!0,message:this._translate.instant("paymentProcessing.voucherAppliedCode").replace("#discount",n.discount).replace("#discountAmount",this.amount)},this.updatePaymentIntent()):this.appliedCodeMessage={valid:!1,disabled:!1,message:this._translate.instant("paymentProcessing.voucherNotValid")}})}useTermmyCoins(){this.amount-=this.convertedTermmyCoin,this.appliedCodeMessage={valid:!0,disabled:!1,message:this._translate.instant("paymentProcessing.usingTermmyCoinMessage").replace("#discount",this.convertedTermmyCoin.toFixed(2)).replace("#discountAmount",this.amount)},this.usedTermmyCoin=!0,this.updatePaymentIntent()}resetTermmyCoins(){this.usedTermmyCoin&&(this.termmyCoinCount=0,this.convertedTermmyCoin=0,this._service.callPostMethod("api/resetTermmyCoin").subscribe(n=>{this.usedTermmyCoin=!1}))}static#e=this.\u0275fac=function(r){return new(r||c)(t.Y36(b.f),t.Y36(P.s),t.Y36(x.V),t.Y36(h.sK),t.Y36(T.l))};static#t=this.\u0275cmp=t.Xpm({type:c,selectors:[["app-payment-processing"]],viewQuery:function(r,s){if(1&r&&t.Gf(e._$,5),2&r){let m;t.iGM(m=t.CRH())&&(s.paymentElement=m.first)}},inputs:{amount:"amount",buttonText:"buttonText",stripeAccount:"stripeAccount"},outputs:{executeMethodEmitter:"executeMethodEmitter"},features:[t.TTD],decls:2,vars:2,consts:[[4,"ngIf"],["style","margin-bottom: 10px",4,"ngIf"],[2,"margin-bottom","10px"],[1,"termmy-coin"],[1,"container-coin"],[1,"info"],[1,"mb-0","font-weight-bolder"],["src","./assets/images/icons/termmy-coin.png",3,"title"],[1,"ml-2","mr-2"],[1,"mt-2"],[1,"btn-sm","btn-outline-primary",3,"disabled","click"],[1,"mb-2"],[3,"stripe","elementsOptions"],[3,"appearance"],[1,"mb-1"],[1,"voucher-title"],[1,"d-flex"],["name","voucher_code",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"btn","btn-outline-primary","ml-1","d-flex",3,"disabled","click"],[1,"fa","fa-check"],["class","mt-2",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","accept",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","accept",1,"custom-control-label"],["href","https://termmy.com/terms","target","_blank"],["href","https://termmy.com/privacy-policy","target","_blank"],["class","error",4,"ngIf"],[1,"pt-2","text-center"],[1,"btn","btn-primary","payment",3,"disabled","click"],[1,"fa","fa-shopping-cart"],[3,"type","text"],[1,"error"]],template:function(r,s){1&r&&(t.YNc(0,S,2,0,"div",0),t.YNc(1,U,65,52,"div",1)),2&r&&(t.Q6J("ngIf",!s.elementsOptions.clientSecret&&s.loader),t.xp6(1),t.Q6J("ngIf",s.elementsOptions.clientSecret&&!s.loader))},dependencies:[C.O5,e._$,e.Ec,_.Fj,_.Wl,_.JJ,_.On,A.R,M.T,g,h.X$],styles:[".voucher-title[_ngcontent-%COMP%]{margin:0;color:#000}.termmy-coin[_ngcontent-%COMP%]{display:flex;justify-content:end;margin-bottom:20px}.termmy-coin[_ngcontent-%COMP%]   .container-coin[_ngcontent-%COMP%]{border:1px solid lightgray;padding:14px;text-align:center;border-radius:6px}.container-coin[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.container-coin[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:bolder}.termmy-coin[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px;padding-left:3px}"]})}return c})()},912:(D,Z,a)=>{a.d(Z,{C:()=>r});var t=a(8072),e=a(4650),v=a(8262),_=a(3681),b=a(5048),P=a(4329),x=a(4398),h=a(6895),T=a(7304),C=a(3233),A=a(8723),M=a(9604);const u=["dialogConfirm"];function y(s,m){1&s&&(e.TgZ(0,"span")(1,"b"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&s&&(e.xp6(2),e.hij("(",e.lcZ(3,1,"licenseStatus.expired"),")"))}function l(s,m){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.YNc(3,y,4,3,"span",0),e.qZA()),2&s){const i=e.oxw(3);e.xp6(1),e.Oqu(e.xi3(2,2,i.license.expiry_date,"dd.MM.YYYY HH:mm")),e.xp6(2),e.Q6J("ngIf",0===i.diffDays)}}function g(s,m){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"licenseStatus.forever")))}function S(s,m){1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"licenseStatus.notifyBeforeExpired")))}const O=function(s){return{width:s}};function L(s,m){if(1&s&&(e.TgZ(0,"div",20),e._UZ(1,"div",21),e.qZA()),2&s){const i=e.oxw(4);e.xp6(1),e.MT6("progress-bar ",i.diffDays<=10?"progress-bar-error":""," ",i.diffDays>10&&i.diffDays<=30?"progress-bar-warning":"",""),e.Q6J("ngStyle",e.VKq(5,O,i.expiryPercentage))}}function I(s,m){if(1&s&&(e.TgZ(0,"div",15)(1,"div",16)(2,"h5",17),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"h5",17),e._uU(6),e.qZA()(),e.YNc(7,L,2,7,"div",18),e.TgZ(8,"p",19),e._uU(9),e.ALo(10,"translate"),e.qZA()()),2&s){const i=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,5,"licenseStatus.days")),e.xp6(3),e.Oqu(i.diffDays),e.xp6(1),e.Q6J("ngIf",i.expiryPercentage),e.xp6(2),e.AsE("",i.diffDays," ",e.lcZ(10,7,"licenseStatus.daysReminder"),"")}}function U(s,m){if(1&s){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(i),e.oxw(3);const o=e.MAs(2);return e.KtG(o.showQuestionModal())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"licenseStatus.cancelSubscription")))}function E(s,m){if(1&s&&(e.TgZ(0,"div",5)(1,"div",6)(2,"h4",7),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",8)(6,"div",5)(7,"div",9)(8,"div",10)(9,"h5"),e._uU(10),e.ALo(11,"translate"),e.TgZ(12,"strong"),e._uU(13),e.qZA()(),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"translate"),e.qZA()(),e.TgZ(17,"div",10)(18,"h5"),e._uU(19),e.ALo(20,"translate"),e.YNc(21,l,4,5,"span",0),e.YNc(22,g,3,3,"span",0),e.qZA(),e.YNc(23,S,3,3,"span",0),e.qZA(),e.TgZ(24,"div",11)(25,"h5"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"span"),e._uU(29),e.ALo(30,"translate"),e.qZA()()(),e.TgZ(31,"div",9),e.YNc(32,I,11,9,"div",12),e._UZ(33,"app-sms-counter"),e.qZA(),e.TgZ(34,"div",6)(35,"a",13),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.YNc(38,U,3,3,"button",14),e.qZA()()()()),2&s){const i=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,14,"licenseStatus.currentPlan")),e.xp6(7),e.hij("",e.lcZ(11,16,"licenseStatus.yourCurrentPlan")," "),e.xp6(3),e.Oqu(i.license.name),e.xp6(2),e.Oqu(e.lcZ(16,18,"licenseStatus.simpleStartForEveryone")),e.xp6(4),e.hij("",e.lcZ(20,20,"licenseStatus.activeUntil")," "),e.xp6(2),e.Q6J("ngIf",i.license.expiry_date),e.xp6(1),e.Q6J("ngIf",!i.license.expiry_date),e.xp6(1),e.Q6J("ngIf",i.license.expiry_date),e.xp6(3),e.AsE("",i.license.monthly_price," ",e.lcZ(27,22,"licenseStatus.perMonth")," "),e.xp6(3),e.Oqu(e.lcZ(30,24,"licenseStatus.planDescription")),e.xp6(3),e.Q6J("ngIf",i.license.expiry_date),e.xp6(4),e.hij(" ",e.lcZ(37,26,"licenseStatus.updatePlan")," "),e.xp6(2),e.Q6J("ngIf",i.license.license_id!==i.getBasicLicenseType())}}function c(s,m){if(1&s){const i=e.EpF();e.TgZ(0,"app-payment-processing",40),e.NdJ("executeMethodEmitter",function(o){e.CHM(i);const d=e.oxw(3);return e.KtG(d.executeMethod(o))}),e.qZA()}if(2&s){const i=e.oxw(3);e.Q6J("amount",i.licenseSubscription.price)}}function f(s,m){if(1&s){const i=e.EpF();e.TgZ(0,"div",23)(1,"div",24)(2,"h4",25),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",8)(6,"div",26)(7,"div",27)(8,"input",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const d=e.oxw(2);return e.KtG(d.annualSubscription=o)})("click",function(){e.CHM(i);const o=e.oxw(2);return o.annualSubscription="monthly",e.KtG(o.selectPackage(o.license.monthly_price,1))}),e.qZA(),e.TgZ(9,"label",29),e._uU(10),e.ALo(11,"translate"),e.TgZ(12,"span",30),e._uU(13),e.qZA()()(),e.TgZ(14,"div",31)(15,"input",32),e.NdJ("ngModelChange",function(o){e.CHM(i);const d=e.oxw(2);return e.KtG(d.annualSubscription=o)})("click",function(){e.CHM(i);const o=e.oxw(2);return o.annualSubscription="monthly",e.KtG(o.selectPackage(o.licensePriceFor3Months,3))}),e.qZA(),e.TgZ(16,"label",33),e._uU(17),e.ALo(18,"translate"),e.TgZ(19,"span",30),e._uU(20),e.qZA()()(),e.TgZ(21,"div",31)(22,"input",34),e.NdJ("ngModelChange",function(o){e.CHM(i);const d=e.oxw(2);return e.KtG(d.annualSubscription=o)})("click",function(){e.CHM(i);const o=e.oxw(2);return o.annualSubscription="monthly",e.KtG(o.selectPackage(o.licensePriceFor6Months,6))}),e.qZA(),e.TgZ(23,"label",35),e._uU(24),e.ALo(25,"translate"),e.TgZ(26,"span",30),e._uU(27),e.qZA()(),e._uU(28," \xa0 "),e.TgZ(29,"span",36),e._uU(30),e.ALo(31,"translate"),e.qZA()(),e.TgZ(32,"div",31)(33,"input",37),e.NdJ("ngModelChange",function(o){e.CHM(i);const d=e.oxw(2);return e.KtG(d.annualSubscription=o)})("click",function(){e.CHM(i);const o=e.oxw(2);return o.annualSubscription="annual",e.KtG(o.selectPackage(o.licensePriceFor12Months,12))}),e.qZA(),e.TgZ(34,"label",38),e._uU(35),e.ALo(36,"translate"),e.TgZ(37,"span",30),e._uU(38),e.qZA(),e._uU(39," \xa0 "),e.TgZ(40,"span",36),e._uU(41),e.ALo(42,"translate"),e.qZA()()()(),e.YNc(43,c,1,1,"app-payment-processing",39),e.qZA()()}if(2&s){const i=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,20,"licenseStatus.extendCurrentPlan")),e.xp6(5),e.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),e.xp6(2),e.hij(" ",e.lcZ(11,22,"licenseStatus.monthlySubscription")," "),e.xp6(3),e.hij(" (\u20ac",i.license.monthly_price,")"),e.xp6(2),e.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),e.xp6(2),e.hij(" ",e.lcZ(18,24,"licenseStatus.threeMonthSubscription")," "),e.xp6(3),e.hij(" (\u20ac",i.licensePriceFor3Months," )"),e.xp6(2),e.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),e.xp6(2),e.hij(" ",e.lcZ(25,26,"licenseStatus.sixMonthSubscription")," "),e.xp6(3),e.hij(" (\u20ac",i.licensePriceFor6Months," )"),e.xp6(3),e.Oqu(e.lcZ(31,28,"licenseStatus.discount5")),e.xp6(3),e.Q6J("checked",!!i.annualSubscription)("ngModel",i.annualSubscription),e.xp6(2),e.hij(" ",e.lcZ(36,30,"licenseStatus.annualSubscription")," "),e.xp6(3),e.hij(" (\u20ac",i.licensePriceFor12Months,") "),e.xp6(3),e.Oqu(e.lcZ(42,32,"licenseStatus.discount10")),e.xp6(2),e.Q6J("ngIf",i.licenseSubscription.price)}}function n(s,m){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,E,39,28,"div",3),e.YNc(2,f,44,34,"div",4),e.qZA()),2&s){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.currentStatus),e.xp6(1),e.Q6J("ngIf",i.license.monthly_price)}}let r=(()=>{class s{constructor(i,p,o,d,q){this._service=i,this._helpService=p,this._storageService=o,this._toastr=d,this._translate=q,this.currentStatus=!0,this.licenseSubscription={price:null,duration:null},this.annualSubscription="annual"}ngOnInit(){this.data?(this.license=this.data,this.additionalCalculate(),this.setInitializePrice()):this._service.callGetMethod("/api/getMyLicense","").subscribe(i=>{this.license=i[0],this.additionalCalculate(),this.setInitializePrice()})}ngOnChanges(i){i.data&&(this.license=i.data.currentValue),this.setInitializePrice()}setInitializePrice(){this.licenseSubscription.duration=12,this.licensePriceFor3Months=(3*this.license.monthly_price).toFixed(2),this.licensePriceFor6Months=(6*this.license.monthly_price*.95).toFixed(2),this.licensePriceFor12Months=(12*this.license.monthly_price*.9).toFixed(2),this.licenseSubscription.price=this.licensePriceFor12Months}additionalCalculate(){this.calculateDiffDays(),this.getSubscriptionPeriod(),this.calculatePercentage()}calculateDiffDays(){this.diffDays=this._helpService.calculateDiffInDays(this.license.expiry_date)}getSubscriptionPeriod(){this.subscriptionPeriod=this.license.annual_subscription?this._helpService.daysInYear((new Date).getFullYear()):this._helpService.daysInMonth((new Date).getMonth(),(new Date).getFullYear())}calculatePercentage(){this.expiryPercentage=this.diffDays+"%"}selectPackage(i,p){this.licenseSubscription.price=null,this.licenseSubscription.duration=p,setTimeout(()=>{this.licenseSubscription.price=i.toString()},20)}cancelSubscription(){this._service.callPostMethod("api/cancelSubscription",{license_id:t.y.Basic}).subscribe(i=>{this._toastr.showSuccessCustom(this._translate.instant("licenseStatus.successfullyPaidLicense")),this.ngOnInit()})}confirmCancelSubscription(){}getBasicLicenseType(){return t.y.Basic}executeMethod(i){this.license.expiry_date=this._helpService.addMonthsToCurrentDate(this.license.expiry_date,this.licenseSubscription.duration),this._service.callPostMethod("/api/updateLicense",{value:this._storageService.encrypt({id:this.license.id,license_id:this.license.license_id,expiry_date:this.license.expiry_date})}).subscribe(o=>{o&&(this.calculateDiffDays(),this._toastr.showSuccessCustom(this._translate.instant("licenseStatus.successfullyPaidLicense")))})}static#e=this.\u0275fac=function(p){return new(p||s)(e.Y36(v.f),e.Y36(_.s),e.Y36(b.V),e.Y36(P.l),e.Y36(x.sK))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-license-status"]],viewQuery:function(p,o){if(1&p&&e.Gf(u,5),2&p){let d;e.iGM(d=e.CRH())&&(o.dialogConfirm=d.first)}},inputs:{data:"data",currentStatus:"currentStatus"},features:[e.TTD],decls:4,vars:4,consts:[[4,"ngIf"],[3,"content","confirm"],["dialogConfirm",""],["class","row",4,"ngIf"],["class","card",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"ml-75","card-title","full-width","border-bottom"],[1,"card-body"],[1,"col-md-6"],[1,"mb-2","pb-50"],[1,"mb-2","mb-md-1"],["class","plan-statistics pt-1",4,"ngIf"],["routerLink","/dashboard/admin/payment/license-packages",1,"btn","btn-primary","me-1","mt-1","mr-1","waves-effect","waves-float","waves-light"],["class","btn btn-outline-danger cancel-subscription mt-1 waves-effect",3,"click",4,"ngIf"],[1,"plan-statistics","pt-1"],[1,"d-flex","justify-content-between"],[1,"fw-bolder"],["class","progress",4,"ngIf"],[1,"mt-50"],[1,"progress"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",3,"ngStyle"],[1,"btn","btn-outline-danger","cancel-subscription","mt-1","waves-effect",3,"click"],[1,"card"],[1,"card-header"],[1,"card-title","full-width","border-bottom"],[1,"mb-3"],[1,"custom-control","custom-radio"],["type","radio","name","subscription","id","monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","monthly",1,"custom-control-label"],[1,"price"],[1,"custom-control","custom-radio","mt-1"],["type","radio","name","subscription","id","3monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","3monthly",1,"custom-control-label"],["type","radio","name","subscription","id","6monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","6monthly",1,"custom-control-label"],[1,"badge","badge-light-primary"],["type","radio","name","subscription","id","annual","value","annual",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","annual",1,"custom-control-label"],[3,"amount","executeMethodEmitter",4,"ngIf"],[3,"amount","executeMethodEmitter"]],template:function(p,o){1&p&&(e.YNc(0,n,3,2,"div",0),e.TgZ(1,"app-dialog-confirm",1,2),e.NdJ("confirm",function(){return o.cancelSubscription()}),e.ALo(3,"translate"),e.qZA()),2&p&&(e.Q6J("ngIf",o.license),e.xp6(1),e.Q6J("content",e.lcZ(3,2,"licenseStatus.cancelSubscriptionQuestion")))},dependencies:[h.O5,h.PC,T.Q,C.p,A.rH,M.q,h.uU,x.X$],styles:[".price[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);font-size:16px}.progress-bar-error[_ngcontent-%COMP%]{background:#ef0000!important}.progress-bar-warning[_ngcontent-%COMP%]{background:#d3be04!important}"]})}return s})()},9604:(D,Z,a)=>{a.d(Z,{q:()=>M});var t=a(4650),e=a(3681),v=a(8262),_=a(6895),b=a(8723),P=a(4398);const x=function(u){return{width:u}};function h(u,y){if(1&u&&(t.TgZ(0,"div",12),t._UZ(1,"div",13),t.qZA()),2&u){const l=t.oxw(3);t.xp6(1),t.MT6("progress-bar ",l.smsCount.count<=40?"progress-bar-error":""," ",l.smsCount.count>40&&l.smsCount.count<=70?"progress-bar-warning":"",""),t.Q6J("ngStyle",t.VKq(5,x,l.generateProgressBar()))}}function T(u,y){1&u&&(t.TgZ(0,"span",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"smsReminder.pleaseBuySmsOnTime")))}function C(u,y){if(1&u&&(t.TgZ(0,"div",6)(1,"div",7)(2,"h5",8),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"h5",8),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.YNc(8,h,2,7,"div",9),t.TgZ(9,"p",10),t._uU(10),t.ALo(11,"translate"),t.YNc(12,T,3,3,"span",11),t.qZA()()),2&u){const l=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,6,"smsReminder.leftMessage")),t.xp6(3),t.AsE("",l.smsCount.count," ",t.lcZ(7,8,"smsReminder.sms"),""),t.xp6(2),t.Q6J("ngIf",l.smsCount),t.xp6(2),t.hij("",l._helpService.replaceText(t.lcZ(11,10,"smsReminder.leftMessageText"),"{numberOfLeftMessage}",l.smsCount.count)," "),t.xp6(2),t.Q6J("ngIf",l.smsCount.count<=40)}}function A(u,y){if(1&u&&(t.TgZ(0,"div",1)(1,"div"),t.YNc(2,C,13,12,"div",2),t.qZA(),t.TgZ(3,"div",3)(4,"a",4),t._UZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()()()),2&u){const l=t.oxw();t.xp6(2),t.Q6J("ngIf",l.smsCount),t.xp6(4),t.hij(" \xa0 ",t.lcZ(7,2,"smsReminder.buyMoreSMS"),"")}}let M=(()=>{class u{constructor(l,g){this._helpService=l,this._service=g,this.smsCount={count:0},this.loader=!0}ngOnInit(){this.getNumberOfSms()}getNumberOfSms(){this.loader=!0,this._service.callGetMethod("/api/getNumberOfSms","").subscribe(l=>{l.length&&(this.smsCount=l[0],this.loader=!1)})}generateProgressBar(){return this.smsCount.count+"%"}static#e=this.\u0275fac=function(g){return new(g||u)(t.Y36(e.s),t.Y36(v.f))};static#t=this.\u0275cmp=t.Xpm({type:u,selectors:[["app-sms-counter"]],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],["class","plan-statistics pt-1",4,"ngIf"],[1,"text-right"],["routerLink","/dashboard/admin/payment/buy-more-sms",1,"btn","btn-primary"],[1,"fa","fa-shopping-cart"],[1,"plan-statistics","pt-1"],[1,"d-flex","justify-content-between"],[1,"fw-bolder"],["class","progress",4,"ngIf"],[1,"mt-50"],["class","text-danger",4,"ngIf"],[1,"progress"],["role","progressbar","aria-valuenow","12","aria-valuemin","0","aria-valuemax","100",3,"ngStyle"],[1,"text-danger"]],template:function(g,S){1&g&&t.YNc(0,A,8,4,"div",0),2&g&&t.Q6J("ngIf",!S.loader)},dependencies:[_.O5,_.PC,b.rH,P.X$],styles:[".progress-bar-error[_ngcontent-%COMP%]{background:#ef0000!important}.progress-bar-warning[_ngcontent-%COMP%]{background:#d3be04!important}.recommended[_ngcontent-%COMP%]{font-size:10px}"]})}return u})()}}]);