"use strict";(self.webpackChunktermmy=self.webpackChunktermmy||[]).push([[655],{9655:(X,z,m)=>{m.r(z),m.d(z,{AuthenticationModule:()=>c,MSALInstanceFactory:()=>s});var l=m(6895),A=m(4006),R=m(8723),U=m(8804),N=m(5078),I=m(5861),b=m(7625),d=m(8929),C=m(2340),r=m(4650),_=m(2553),B=m(8262),Q=m(5048),G=m(591),T=m(6831),W=m(2654);class h extends d.xQ{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(g){return this.hasError?(g.error(this.thrownError),W.w.EMPTY):this.hasCompleted&&this.hasNext?(g.next(this.value),g.complete(),W.w.EMPTY):super._subscribe(g)}next(g){this.hasCompleted||(this.value=g,this.hasNext=!0)}error(g){this.hasCompleted||super.error(g)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}var f=m(4715),M=m(1307),P=m(2198),S=m(2986);class K{constructor(){}loadScript(g,a,u,p=null){if(typeof document<"u"&&!document.getElementById(g)){let E=document.createElement("script");E.async=!0,E.src=a,E.onload=u,p||(p=document.head),p.appendChild(E)}}}class k{}const O={oneTapEnabled:!0};let x=(()=>{class i extends K{constructor(a,u){super(),this.clientId=a,this.initOptions=u,this.changeUser=new r.vpe,this._socialUser=new G.X(null),this._accessToken=new G.X(null),this._receivedAccessToken=new r.vpe,this.initOptions={...O,...this.initOptions},this._socialUser.pipe((0,M.T)(1)).subscribe(this.changeUser),this._accessToken.pipe((0,M.T)(1)).subscribe(this._receivedAccessToken)}initialize(a){return new Promise((u,p)=>{try{this.loadScript(i.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:a,callback:({credential:E})=>{const L=this.createSocialUser(E);this._socialUser.next(L)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,P.h)(E=>null===E)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const E=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(L=>L).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:E,prompt:this.initOptions.prompt,callback:L=>{L.error?this._accessToken.error({code:L.error,description:L.error_description,uri:L.error_uri}):this._accessToken.next(L.access_token)}})}u()})}catch(E){p(E)}})}getLoginStatus(){return new Promise((a,u)=>{this._socialUser.value?a(this._socialUser.value):u(`No user is currently logged in with ${i.PROVIDER_ID}`)})}refreshToken(){return new Promise((a,u)=>{google.accounts.id.revoke(this._socialUser.value.id,p=>{p.error?u(p.error):a(this._socialUser.value)})})}getAccessToken(){return new Promise((a,u)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,S.q)(1)).subscribe(a)):u(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((a,u)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),a()}):u("No access token to revoke"):u("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var a=this;return(0,I.Z)(function*(){google.accounts.id.disableAutoSelect(),a._socialUser.next(null)})()}createSocialUser(a){const u=new k;u.idToken=a;const p=this.decodeJwt(a);return u.id=p.sub,u.name=p.name,u.email=p.email,u.photoUrl=p.picture,u.firstName=p.given_name,u.lastName=p.family_name,u}decodeJwt(a){const p=a.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),E=decodeURIComponent(window.atob(p).split("").map(function(L){return"%"+("00"+L.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(E)}}return i.PROVIDER_ID="GOOGLE",i})(),H=(()=>{class i{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(a,u,p){this._ngZone=u,this._injector=p,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new T.t(1),this.initialized=!1,this._initState=new h,a instanceof Promise?a.then(E=>{this.initialize(E)}):this.initialize(a)}initialize(a){this.autoLogin=void 0!==a.autoLogin&&a.autoLogin;const{onError:u=console.error}=a;a.providers.forEach(p=>{this.providers.set(p.id,"prototype"in p.provider?this._injector.get(p.provider):p.provider)}),Promise.all(Array.from(this.providers.values()).map(p=>p.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const p=[];let E=!1;this.providers.forEach((L,$)=>{const ee=L.getLoginStatus();p.push(ee),ee.then(ae=>{this.setUser(ae,$),E=!0}).catch(console.debug)}),Promise.all(p).catch(()=>{E||(this._user=null,this._authState.next(null))})}this.providers.forEach((p,E)=>{(0,f.b)(p.changeUser)&&p.changeUser.subscribe(L=>{this._ngZone.run(()=>{this.setUser(L,E)})})})}).catch(p=>{u(p)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(a){var u=this;return(0,I.Z)(function*(){const p=u.providers.get(a);if(!u.initialized)throw i.ERR_NOT_INITIALIZED;if(!p)throw i.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(p instanceof x))throw i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield p.getAccessToken()})()}refreshAuthToken(a){return new Promise((u,p)=>{if(this.initialized){const E=this.providers.get(a);E?"function"!=typeof E.refreshToken?p(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):E.refreshToken().then(L=>{this.setUser(L,a),u()}).catch(L=>{p(L)}):p(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else p(i.ERR_NOT_INITIALIZED)})}refreshAccessToken(a){return new Promise((u,p)=>{if(this.initialized)if(a!==x.PROVIDER_ID)p(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const E=this.providers.get(a);E instanceof x?E.revokeAccessToken().then(u).catch(p):p(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else p(i.ERR_NOT_INITIALIZED)})}signIn(a,u){return new Promise((p,E)=>{if(this.initialized){let L=this.providers.get(a);L?L.signIn(u).then($=>{this.setUser($,a),p($)}).catch($=>{E($)}):E(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else E(i.ERR_NOT_INITIALIZED)})}signOut(a=!1){return new Promise((u,p)=>{if(this.initialized)if(this._user){let L=this.providers.get(this._user.provider);L?L.signOut(a).then(()=>{u(),this.setUser(null)}).catch($=>{p($)}):p(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else p(i.ERR_NOT_LOGGED_IN);else p(i.ERR_NOT_INITIALIZED)})}setUser(a,u){a&&u&&(a.provider=u),this._user=a,this._authState.next(a)}}return i.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",i.ERR_NOT_LOGGED_IN="Not logged in",i.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",i.\u0275fac=function(a){return new(a||i)(r.LFG("SocialAuthServiceConfig"),r.LFG(r.R0b),r.LFG(r.zs3))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),F=(()=>{class i{static initialize(a){return{ngModule:i,providers:[H,{provide:"SocialAuthServiceConfig",useValue:a}]}}constructor(a){if(a)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(i,12))},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({providers:[H],imports:[l.ez]}),i})();var v=m(8468),se=m(6521);class we{static getInteractionStatusFromEvent(g,a){switch(g.eventType){case se.t.LOGIN_START:return v.$H.Login;case se.t.SSO_SILENT_START:return v.$H.SsoSilent;case se.t.ACQUIRE_TOKEN_START:if(g.interactionType===v.s_.Redirect||g.interactionType===v.s_.Popup)return v.$H.AcquireToken;break;case se.t.HANDLE_REDIRECT_START:return v.$H.HandleRedirect;case se.t.LOGOUT_START:return v.$H.Logout;case se.t.SSO_SILENT_SUCCESS:case se.t.SSO_SILENT_FAILURE:if(a&&a!==v.$H.SsoSilent)break;return v.$H.None;case se.t.LOGOUT_END:if(a&&a!==v.$H.Logout)break;return v.$H.None;case se.t.HANDLE_REDIRECT_END:if(a&&a!==v.$H.HandleRedirect)break;return v.$H.None;case se.t.LOGIN_SUCCESS:case se.t.LOGIN_FAILURE:case se.t.ACQUIRE_TOKEN_SUCCESS:case se.t.ACQUIRE_TOKEN_FAILURE:case se.t.RESTORE_FROM_BFCACHE:if(g.interactionType===v.s_.Redirect||g.interactionType===v.s_.Popup){if(a&&a!==v.$H.Login&&a!==v.$H.AcquireToken)break;return v.$H.None}}return null}}var ve=m(6290),ye=m(3886),ce=m(6644),ie=m(5254),he=m(1086),q=m(4850),Oe=m(1406),qe=m(7221);const oe="@azure/msal-angular",V="3.0.17",Me=new r.OlP("MSAL_INSTANCE"),Te=new r.OlP("MSAL_GUARD_CONFIG"),pe=new r.OlP("MSAL_INTERCEPTOR_CONFIG"),He=new r.OlP("MSAL_BROADCAST_CONFIG");let Se=(()=>{class i{constructor(a,u){this.instance=a,this.location=u;const p=this.location.path(!0).split("#").pop();p&&(this.redirectHash=`#${p}`),this.instance.initializeWrapperLibrary(v.lA.Angular,V)}initialize(){return(0,ie.D)(this.instance.initialize())}acquireTokenPopup(a){return(0,ie.D)(this.instance.acquireTokenPopup(a))}acquireTokenRedirect(a){return(0,ie.D)(this.instance.acquireTokenRedirect(a))}acquireTokenSilent(a){return(0,ie.D)(this.instance.acquireTokenSilent(a))}handleRedirectObservable(a){return(0,ie.D)(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(a||this.redirectHash)))}loginPopup(a){return(0,ie.D)(this.instance.loginPopup(a))}loginRedirect(a){return(0,ie.D)(this.instance.loginRedirect(a))}logout(a){return(0,ie.D)(this.instance.logout(a))}logoutRedirect(a){return(0,ie.D)(this.instance.logoutRedirect(a))}logoutPopup(a){return(0,ie.D)(this.instance.logoutPopup(a))}ssoSilent(a){return(0,ie.D)(this.instance.ssoSilent(a))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(oe,V)),this.logger}setLogger(a){this.logger=a.clone(oe,V),this.instance.setLogger(a)}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Me),r.LFG(l.Ye))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),ct=(()=>{class i{constructor(a,u,p){this.msalInstance=a,this.authService=u,this.msalBroadcastConfig=p,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new T.t(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new d.xQ,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new G.X(v.$H.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(E=>{this._msalSubject.next(E);const L=we.getInteractionStatusFromEvent(E,this._inProgress.value);null!==L&&(this.authService.getLogger().verbose(`BroadcastService - ${E.eventType} results in setting inProgress from ${this._inProgress.value} to ${L}`),this._inProgress.next(L))})}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Me),r.LFG(Se),r.LFG(He,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),lt=(()=>{class i{constructor(a,u,p,E,L){this.msalGuardConfig=a,this.msalBroadcastService=u,this.authService=p,this.location=E,this.router=L,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(a){return this.router.parseUrl(a)}getDestinationUrl(a){this.authService.getLogger().verbose("Guard - getting destination url");const u=document.getElementsByTagName("base"),p=this.location.normalize(u.length?u[0].href:window.location.origin),E=this.location.prepareExternalUrl(a);return E.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${p}/${E}`):`${p}${a}`}loginInteractively(a){const u="function"==typeof this.msalGuardConfig.authRequest?this.msalGuardConfig.authRequest(this.authService,a):{...this.msalGuardConfig.authRequest};if(this.msalGuardConfig.interactionType===v.s_.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(u).pipe((0,q.U)(E=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(E.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");const p=this.getDestinationUrl(a.url);return this.authService.loginRedirect({redirectStartPage:p,...u}).pipe((0,q.U)(()=>!1))}activateHelper(a){if(this.msalGuardConfig.interactionType!==v.s_.Popup&&this.msalGuardConfig.interactionType!==v.s_.Redirect)throw new ve.WK("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),!(typeof window<"u"))return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),(0,he.of)(!0);if(ye.G.hashContainsKnownProperties(window.location.hash)&&ce.zd()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),(0,he.of)(!1);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));const u=this.location.path(!0);return this.authService.initialize().pipe((0,Oe.b)(()=>this.authService.handleRedirectObservable()),(0,Oe.b)(()=>{if(!this.authService.instance.getAllAccounts().length)return a?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(a)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),(0,he.of)(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),a){const p=this.includesCode(a.url),E=!!a.root&&!!a.root.fragment&&this.includesCode(`#${a.root.fragment}`),L=0===this.location.prepareExternalUrl(a.url).indexOf("#");if(p&&(E||L))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),u.indexOf("#")>-1?(0,he.of)(this.parseUrl(this.location.path())):(0,he.of)(this.parseUrl(""))}return(0,he.of)(!0)}),(0,qe.K)(p=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${p.message}`),this.loginFailedRoute&&a?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),(0,he.of)(this.loginFailedRoute)):(0,he.of)(!1))))}includesCode(a){return a.lastIndexOf("/code")>-1&&a.lastIndexOf("/code")===a.length-5||a.indexOf("#code=")>-1||a.indexOf("&code=")>-1}canActivate(a,u){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(u)}canActivateChild(a,u){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(u)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Te),r.LFG(ct),r.LFG(Se),r.LFG(l.Ye),r.LFG(R.F0))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Be=(()=>{class i{constructor(a){this.authService=a}ngOnInit(){this.authService.getLogger().verbose("MsalRedirectComponent activated"),this.authService.handleRedirectObservable().subscribe()}}return i.\u0275fac=function(a){return new(a||i)(r.Y36(Se))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-redirect"]],decls:0,vars:0,template:function(a,u){},encapsulation:2}),i})(),dt=(()=>{class i{static forRoot(a,u,p){return{ngModule:i,providers:[{provide:Me,useValue:a},{provide:Te,useValue:u},{provide:pe,useValue:p},Se]}}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({providers:[lt,ct],imports:[l.ez]}),i})();var de=m(4398),me=m(4784),le=m(5287);let fe=(()=>{class i{constructor(){this.loginWithGoogle=new r.vpe,this.createFakeGoogleWrapper=()=>{const a=document.createElement("div");a.style.display="none",a.classList.add("custom-google-button"),document.body.appendChild(a),window.google.accounts.id.renderButton(a,{type:"icon",width:"200"});const u=a.querySelector("div[role=button]");return{click:()=>{u?.click()}}}}handleGoogleLogin(){this.loginWithGoogle.emit(this.createFakeGoogleWrapper())}static#e=this.\u0275fac=function(u){return new(u||i)};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-google-signin"]],outputs:{loginWithGoogle:"loginWithGoogle"},decls:4,vars:3,consts:[[1,"bsk-btn","bsk-btn-default","social-signup","google-auth","mb-1",3,"click"],["src","../../../assets/images/icons/google.png",1,"google-signin-img"]],template:function(u,p){1&u&&(r.TgZ(0,"button",0),r.NdJ("click",function(){return p.handleGoogleLogin()}),r._UZ(1,"img",1),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&u&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"login.signInWithGoogle"),""))},dependencies:[de.X$],styles:[".google-signin-img[_ngcontent-%COMP%]{width:26px}.google-auth[_ngcontent-%COMP%]{transition:all .2s linear 0s,background-position 1ms ease 0s,background-size 1ms ease 0s;color:#fff;border:1px solid rgb(0,107,255);background-color:#006bff}.google-auth[_ngcontent-%COMP%]:hover{background-color:#004eba;border-color:#004eba}"]})}return i})();var kt=m(8170),Ne=m(7489);function bt(i,g){if(1&i){const a=r.EpF();r.TgZ(0,"a",5),r.NdJ("click",function(){const E=r.CHM(a).$implicit,L=r.oxw();return r.KtG(L.setLanguage(E))}),r._UZ(1,"i"),r._uU(2),r.qZA()}if(2&i){const a=g.$implicit,u=r.oxw();r.xp6(1),r.Gre("flag-icon flag-icon-",u.languageOptions[a].flag,""),r.xp6(1),r.hij(" ",u.languageOptions[a].title," ")}}let Ge=(()=>{class i{constructor(a,u,p){this._translateService=a,this._coreConfigService=u,this._activatedRouter=p}ngOnInit(){this.languageOptions=kt,this._activatedRouter.snapshot.params.lang?this.setLanguage(this._activatedRouter.snapshot.params.lang):this.selectedLanguage=Ne.find(this.languageOptions,{id:this._translateService.currentLang})}setLanguage(a){this.selectedLanguage=a,setTimeout(()=>{this._translateService.use(a),this._translateService.setDefaultLang(a),this._coreConfigService.setConfig({app:{appLanguage:a},layout:{enableLocalStorage:!0,footer:{hidden:!1},menu:{hidden:!1},navbar:{hidden:!1}}},{emitEvent:!1})},20)}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(de.sK),r.Y36(_.R),r.Y36(R.gz))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-select-language"]],decls:7,vars:5,consts:[["ngbDropdown","",1,"nav-item","dropdown","dropdown-language"],["id","dropdown-flag","ngbDropdownToggle","",1,"nav-link","dropdown-toggle"],[1,"selected-language"],["ngbDropdownMenu","","aria-labelledby","dropdown-flag"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],["ngbDropdownItem","",3,"click"]],template:function(u,p){1&u&&(r.TgZ(0,"div",0)(1,"a",1),r._UZ(2,"i"),r.TgZ(3,"span",2),r._uU(4),r.qZA()(),r.TgZ(5,"div",3),r.YNc(6,bt,3,4,"a",4),r.qZA()()),2&u&&(r.xp6(2),r.Gre("flag-icon flag-icon-",p.languageOptions[p._translateService.currentLang].flag,""),r.xp6(2),r.Oqu(p.languageOptions[p._translateService.currentLang].title),r.xp6(2),r.Q6J("ngForOf",p._translateService.getLangs()))},dependencies:[l.sg,U.jt,U.iD,U.Vi,U.TH],styles:[".flag-icon[_ngcontent-%COMP%]{margin-right:5px}@media (max-width: 993px){.dropdown-language[_ngcontent-%COMP%]{top:28px!important}}.dropdown-language[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px}"]})}return i})();function Ve(i,g){1&i&&(r.TgZ(0,"p"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.verifiedError")))}function Pt(i,g){1&i&&(r.TgZ(0,"p"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.activeError")))}function be(i,g){1&i&&(r.TgZ(0,"p"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.notExistsError")))}function We(i,g){if(1&i&&(r.TgZ(0,"ngb-alert",40)(1,"div",41),r.YNc(2,Ve,3,3,"p",42),r.YNc(3,Pt,3,3,"p",42),r.YNc(4,be,3,3,"p",42),r.qZA()()),2&i){const a=r.oxw();r.Q6J("type","danger")("dismissible",!1),r.xp6(2),r.Q6J("ngIf","verified"===a.error),r.xp6(1),r.Q6J("ngIf","active"===a.error),r.xp6(1),r.Q6J("ngIf","exist"===a.error)}}function Ot(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.emailIsRequired")))}function ht(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.emailMustBeValid")))}function $e(i,g){if(1&i&&(r.TgZ(0,"div",43),r.YNc(1,Ot,3,3,"div",42),r.YNc(2,ht,3,3,"div",42),r.qZA()),2&i){const a=r.oxw();r.xp6(1),r.Q6J("ngIf",a.f.email.errors.required),r.xp6(1),r.Q6J("ngIf",a.f.email.errors.email)}}function gt(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"login.passwordIsRequired")))}const Fe=function(i){return{"d-block":i}};function pt(i,g){if(1&i&&(r.TgZ(0,"div",44),r.YNc(1,gt,3,3,"div",42),r.qZA()),2&i){const a=r.oxw();r.Q6J("ngClass",r.VKq(2,Fe,a.submitted&&a.f.password.errors)),r.xp6(1),r.Q6J("ngIf",a.f.password.errors.required)}}function Ae(i,g){1&i&&r._UZ(0,"span",45)}const mt=function(i){return{"is-invalid":i}},Mt=function(i){return{"is-invalid error":i}},Nt=function(i,g){return{"icon-eye-off":i,"icon-eye":g}};let ze=(()=>{class i{constructor(a,u,p,E,L,$,ee,ae,ge){this._coreConfigService=a,this._formBuilder=u,this._route=p,this._router=E,this._service=L,this._storageService=$,this.authService=ee,this.msalService=ae,this._translate=ge,this.GOOGLE_AUTH_URL=C.N.GOOGLE_AUTH_URL,this.loading=!1,this.submitted=!1,this.error="",this._unsubscribeAll=new d.xQ,this._coreConfigService.config={layout:{navbar:{hidden:!0},menu:{hidden:!0},footer:{hidden:!0},customizer:!1,enableLocalStorage:!1}}}get f(){return this.loginForm.controls}togglePasswordTextType(){this.passwordTextType=!this.passwordTextType}onSubmit(){this.submitted=!0,!this.loginForm.invalid&&(this.loading=!0,this._service.callPostMethod("/api/login",this.loginForm.value).subscribe(a=>{a&&a.token?(this._storageService.setToken(a.token),window.open("dashboard/admin","_self"),this.loading=!1):(this.error=a.type,this.loading=!1)}))}ngOnInit(){var a=this;return(0,I.Z)(function*(){a.loginForm=a._formBuilder.group({email:["",[A.kI.required,A.kI.email]],password:["",A.kI.required]}),a.returnUrl=a._route.snapshot.queryParams.returnUrl||"/",a._coreConfigService.config.pipe((0,b.R)(a._unsubscribeAll)).subscribe(u=>{a.coreConfig=u}),a._translate.onLangChange.subscribe(u=>{a.lang=u.lang}),a.authSubscription=a.authService.authState.subscribe(u=>{a._service.callPostMethod("api/google/auth",{idToken:u.idToken}).subscribe(p=>{a._router.navigate([p])})}),a.lang=a._storageService.getSelectedLanguage(),yield a.msalService.instance.initialize()})()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete(),this.authSubscription.unsubscribe()}isLoggedIn(){return null!=this.msalService.instance.getActiveAccount()}loginWithMicrosoft(){this.msalService.loginPopup().subscribe(a=>{console.log(a),a&&a.account&&this._service.callPostMethod("api/microsoft/findOrCreateUserViaMicrosoft",{email:a.account.username}).subscribe(u=>{this._router.navigate([u])})})}googleSignin(a){a.click()}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(_.R),r.Y36(A.QS),r.Y36(R.gz),r.Y36(R.F0),r.Y36(B.f),r.Y36(Q.V),r.Y36(H),r.Y36(Se),r.Y36(de.sK))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["login"]],decls:68,vars:50,consts:[[1,"auth-wrapper","auth-v2"],[1,"auth-inner","row","m-0"],["href","https://termmy.com",1,"brand-logo"],["alt","brand-logo","height","28",3,"src"],[1,"brand-text","text-primary","ml-1"],[1,"d-none","d-lg-flex","col-lg-8","align-items-center","p-5"],[1,"w-100","d-lg-flex","align-items-center","justify-content-center","px-5"],["alt","Login V2",1,"img-fluid",3,"src"],[1,"d-flex","col-lg-4","align-items-center","auth-bg","px-2","p-lg-5"],[1,"col-12","col-sm-8","col-md-6","col-lg-12","px-xl-2","mx-auto"],[1,"card-title","font-weight-bold","mb-1"],[1,"card-text","mb-2"],[3,"type","dismissible",4,"ngIf"],[1,"auth-login-form","mt-2",3,"formGroup","ngSubmit"],[1,"form-group"],["for","login-email",1,"form-label"],["type","text","formControlName","email","placeholder","admin@demo.com","aria-describedby","login-email","autofocus","","tabindex","1",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"d-flex","justify-content-between"],["for","login-password"],["routerLink","/auth/forgot-password"],[1,"input-group","input-group-merge","form-password-toggle"],["formControlName","password","placeholder","\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7","aria-describedby","login-password","tabindex","2",1,"form-control","form-control-merge",3,"type","ngClass"],[1,"input-group-append"],[1,"input-group-text","cursor-pointer"],[1,"feather","font-small-4",3,"ngClass","click"],["class","invalid-feedback",3,"ngClass",4,"ngIf"],[1,"custom-control","custom-checkbox"],["id","remember-me","type","checkbox","tabindex","3",1,"custom-control-input"],["for","remember-me",1,"custom-control-label"],["tabindex","4","rippleEffect","",1,"btn","btn-primary","btn-block",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"text-center","mt-2"],["routerLink","/auth/signup"],[1,"divider","my-2"],[1,"divider-text"],[1,"auth-footer-btn","d-flex","justify-content-center","row"],[3,"loginWithGoogle"],[1,"bsk-btn","bsk-btn-default","social-signup","microsoft-auth",3,"click"],["src","../../../assets/images/icons/microsoft.svg"],[3,"type","dismissible"],[1,"alert-body"],[4,"ngIf"],[1,"invalid-feedback"],[1,"invalid-feedback",3,"ngClass"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(u,p){1&u&&(r.TgZ(0,"div",0)(1,"div",1)(2,"a",2),r._UZ(3,"img",3),r.TgZ(4,"h2",4),r._uU(5),r.qZA()(),r.TgZ(6,"div",5)(7,"div",6),r._UZ(8,"img",7),r.qZA()(),r.TgZ(9,"div",8),r._UZ(10,"app-select-language"),r.TgZ(11,"div",9)(12,"h2",10),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"p",11),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.YNc(18,We,5,5,"ngb-alert",12),r.TgZ(19,"form",13),r.NdJ("ngSubmit",function(){return p.onSubmit()}),r.TgZ(20,"div",14)(21,"label",15),r._uU(22,"Email"),r.qZA(),r._UZ(23,"input",16),r.YNc(24,$e,3,2,"div",17),r.qZA(),r.TgZ(25,"div",14)(26,"div",18)(27,"label",19),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.TgZ(30,"a",20)(31,"small"),r._uU(32),r.ALo(33,"translate"),r.qZA()()(),r.TgZ(34,"div",21),r._UZ(35,"input",22),r.TgZ(36,"div",23)(37,"span",24)(38,"i",25),r.NdJ("click",function(){return p.togglePasswordTextType()}),r.qZA()()()(),r.YNc(39,pt,2,4,"div",26),r.qZA(),r.TgZ(40,"div",14)(41,"div",27),r._UZ(42,"input",28),r.TgZ(43,"label",29),r._uU(44),r.ALo(45,"translate"),r.qZA()()(),r.TgZ(46,"button",30),r.YNc(47,Ae,1,0,"span",31),r._uU(48),r.ALo(49,"translate"),r.qZA()(),r.TgZ(50,"p",32)(51,"span"),r._uU(52),r.ALo(53,"translate"),r.qZA(),r.TgZ(54,"a",33)(55,"span"),r._uU(56),r.ALo(57,"translate"),r.qZA()()(),r.TgZ(58,"div",34)(59,"div",35),r._uU(60),r.ALo(61,"translate"),r.qZA()(),r.TgZ(62,"div",36)(63,"app-google-signin",37),r.NdJ("loginWithGoogle",function(L){return p.googleSignin(L)}),r.qZA(),r.TgZ(64,"button",38),r.NdJ("click",function(){return p.loginWithMicrosoft()}),r._UZ(65,"img",39),r._uU(66),r.ALo(67,"translate"),r.qZA()()()()()()),2&u&&(r.xp6(3),r.s9C("src",p.coreConfig.app.appLogoImage,r.LSH),r.xp6(2),r.Oqu(p.coreConfig.app.appName),r.xp6(3),r.Q6J("src","dark"===p.coreConfig.layout.skin?"assets/images/pages/login-v2-dark.svg":"assets/images/pages/login-v2.svg",r.LSH),r.xp6(5),r.Oqu(r.lcZ(14,23,"login.title")),r.xp6(3),r.Oqu(r.lcZ(17,25,"login.subtitle")),r.xp6(2),r.Q6J("ngIf",p.error),r.xp6(1),r.Q6J("formGroup",p.loginForm),r.xp6(4),r.Q6J("ngClass",r.VKq(43,mt,p.submitted&&p.f.email.errors)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.email.errors),r.xp6(4),r.Oqu(r.lcZ(29,27,"login.password")),r.xp6(4),r.Oqu(r.lcZ(33,29,"login.forgotPassword")),r.xp6(3),r.Q6J("type",p.passwordTextType?"text":"password")("ngClass",r.VKq(45,Mt,p.submitted&&p.f.password.errors)),r.xp6(3),r.Q6J("ngClass",r.WLB(47,Nt,p.passwordTextType,!p.passwordTextType)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.password.errors),r.xp6(5),r.hij(" ",r.lcZ(45,31,"login.rememberMe"),""),r.xp6(2),r.Q6J("disabled",p.loading),r.xp6(1),r.Q6J("ngIf",p.loading),r.xp6(1),r.hij("",r.lcZ(49,33,"login.signIn")," "),r.xp6(4),r.Oqu(r.lcZ(53,35,"login.newOnPlatform")),r.xp6(4),r.hij("\xa0",r.lcZ(57,37,"login.createAnAccount"),""),r.xp6(4),r.Oqu(r.lcZ(61,39,"login.or")),r.xp6(6),r.hij(" ",r.lcZ(67,41,"login.signInWithMicrosoft"),""))},dependencies:[l.mk,l.O5,R.rH,U.xm,A._Y,A.Fj,A.JJ,A.JL,A.sg,A.u,me.oO,le.R,fe,Ge,de.X$],styles:['.auth-wrapper{display:flex;flex-basis:100%;min-height:100vh;min-height:calc(var(--vh, 1vh) * 100);width:100%}.auth-wrapper .auth-inner{width:100%;position:relative}.auth-wrapper.auth-v1{align-items:center;justify-content:center;overflow:hidden}.auth-wrapper.auth-v1 .auth-inner:before{width:244px;height:243px;content:" ";position:absolute;top:-54px;left:-46px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAADzCAMAAACG9Mt0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA9KADAAQAAAABAAAA8wAAAADhQHfUAAAAyVBMVEUAAAD///+AgP+AgP9mZv+AgNWAgP9tbf9gYP+AgP9xcf9mZv+AZuaAgP9dXf90dOhiYv92dv9mZu5mZv93d+53d/9paf94afCAcfFrXvJra/9mZvJzZvJzc/JoaP96b/Rqav91aupsYvV2bOt2bPVxaPZ7cfZqavZyau1waPd4aO9xafBxafh4afB1bfh4avFuZ/F2afJzZvJzZ/N0aPN0bvN3bPR0ae5yZ/R3be93bfR1au9zafBxbPVzavV0a/F0a/ZyafFwaPKZm3nTAAAAQ3RSTlMAAQIEBQYGBwgICQoKCgsLDQ0PDw8PERESExMUFBQWFxgYGhoaGxsdHSAgIiIiIyQlJygqLCwtLi8vLzAzNDU3Nzg7h9vbHgAAA9RJREFUeNrt3ftS2kAUx/Fc1gSyWsErtuJdRDQiiteolb7/QzUoTm07k4AzObuu3/MCez45yWbzT36eZ6b8erO1e1B97baadd+zocJWmg0HaXe/+uqmg2GWtkLT5Lle1m9LdhG2+1lvzuiUO1knEF81yFc1N+35m15kZOGodz1vyLx+v2Lseq/erxtZd/NuweCTtfiwaWLOD5FnsqI7+VnP3y8afnEs3Es/1+H1qvETwuq18B7e6VlwLup1ZM8kWWQBOsrmHL7GVtxvYRZYgQ4ywae61ffsqH5Lbq20bQm6ncp9P2ehJegwE/u+rl95ttSwLrVSc2ANetAU28dSa9Cp2E623bUG3d2VWmn/wBq0XCugQYMGLdVKoOJaoiuok1NdXSW1WAUfRPtRUllflaJf5ZE/O9pXVbZUPTov5c+IDqvtRwStdTgLutoxy6GnGfYb2o+1I2gd+1OiqzfLocvVE7TSDqG1mgodaqfQZbvZC9rXjqG1X45WzqFVKVpk0LLo4lGP0ZGD6KgMnTiITkrQgXYQrYNitHISrYrRsZPouBhdcxJdK0YnTqKTYrR2Eq1BgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRoh9DH59ag86ACoSYOL61B55EUQk1s3VqDzsNHhJpYe7QGncfMSHUxaliCHgcKSXVxeWQJehwdJdXF4dAS9DgkTKqLxuibFeiXODixNi7OrEC/BP+JtbE0WrYA/RrxKNfH2YUF6NegSbk+Gk87xtErN6EsWm88fzeMXpwE9EruLns/l42io4dJFLPo2/Po1w+D6IW7t9Bt2SPx3vOOMfS7eHVZtN54ulg2go56138Ct4XRunE2Ovsmjg46WeddUoUWr6WL0fCoIYgO2/2s91fstDZQjcPL0ePt5flpdXUwqW46uMrS1j95JNpQrW0dHp9UV/uT2m416/8HVGg3qzhpBjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KC/FDpx0pwUo2tOomvF6NhJdFyMVk6iVTE6cBIdeF9vJyvZx/I/AzuIjsrQvoNovwzt4FamSs0Ojrp80PmvoB0zh940pb7azf1yg7t0LIt978uppzbnalfucDW92ZndLPRmKweGPduYJ+zoM5/Dk+gD5NdvLhXXPp88qcUqmEH5G5JZRs6cuxwIAAAAAElFTkSuQmCC)}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:before{display:none}}.auth-wrapper.auth-v1 .auth-inner:after{width:272px;height:272px;content:" ";position:absolute;bottom:-55px;right:-75px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARAAAAEQCAMAAABP1NsnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABEKADAAQAAAABAAABEAAAAAAQWxS2AAAAwFBMVEUAAAD///+AgICAgP9VVaqqVf+qqv+AgL+AgP9mZsxmZv+ZZv+AgNWAgP9tbdttbf+Sbf+AYN+AgN+AgP9xceNmZv+AZuaAZv90dOh0dP9qav+AauqAav+AgP92dv9tbf+Abe2Abf93Zu53d+6AcO94afCAcfF5a+R5a/JzZuaAZvKAc/J5bed5bfOAaPN6b/R1auqAavR6ZvV6cPV2bOuAbPV7aPZ2be2AbfZ7au17avZ3Zu53b+57a+97a/d4aO9J6CoeAAAAQHRSTlMAAQICAwMDBAQFBQUGBgcHBwgICAkKCgoLCwwMDAwNDg4ODw8QERITExQUFBUVFhcYGBkZGhobHBwdHR4eHx8gJ5uMWwAAA/FJREFUeNrt2G1XEkEYxvHZNk2xHGzdbKFl0cTwgdSkCKzu7/+t4pw6sAjtjIueE/f8r3fMO35nZnbuy5gVGcvfzJe0rnTfGI+MggGJRUZnbpPIhJKt88nU53JnFULvyISY6KAv8vPj0vr2rYwiE2Z2B9J+uNYcyyQxwWZvaeGH3G4bMjsvI/kcwTC/V+7kLoahlITzQojP3ZFgsJCh7IJQzpX0QFj4uMiY18eDMZ9bZCF9OQahnK6cm/Y7js0sh/LF3Auv1PlQd3MxbdXYIQspV44EEEAAAWTNDAYYkKdJbNMsLzYueZbaZ2iM46RVbHBaiZ9Js+nHEdli42N9XuSen5hGp1CQTuOJQDRsD99N4gMSpYWapNH6IJo83CIeILZQFesEaber79NCWRoukOpNEnW0gXQqD81w6ACxhbrYde7VuFCYeA2QRCNIsgZISyNIqz6IyhPjOjNVIFYniK3dmKU6QdLaJUimEySrDZLrBMlrgxRKU7sxCw/EMe0CAggggADySJCqxixIkKpNEh6IozELD8RxjQACCCCAAPJIkKrGLEgQXqqAAEJjxrQLCCCAAEJjRmNGY8a0CwgggABCYwYIfQgggNCYMe0CAggggNCY0ZjRmDHtAgIIIIAAQmNGHwIIIDRmTLuAAAIIIDRmNGY0Zky7gAACCCCA0JjRhwACCI0Z0y4ggAACCI0ZjRmNGdMuIIAAAgggNGb0IYAAQmPGtAsIIIAAQmNGY0ZjxrQLCCCAAAIIjRl9CCCA0Jgx7QICCCCA0JjRmNGYMe0CAggggABCY0YfAgggNGZMu4AAAgggNGY0ZjRmTLuAAAIIIIDQmNGHAAIIjRnTLiCAAAIIjRmNGY0ZIEy7gAACCCA0ZvQhgABCY8a0CwgggABCY0ZjBgiNGdMuIIAAAgiN2f/Sh+Q6PfLaIJlOkKw2SKoTJK3dmFmdILb2tBvrBIlrg5iWRo+WqQ+SaARJ1gCJAzsxThCN16p1vNurGjNjoo42j07kAHFskoY2kEbl33U0ZgoPjXW+Rl0gkarnahqtDaJKxMPDDWIiNafGenh4gExvVhXfmk7Da6L1AVGxSby2h6MxK79Zk42ea1pJbJ48sU2zDezQ8iy1z6BBwoyjMQsvXp8YQAAhgADilRfyy+wf8WqZZUfGZihvgZiB3FybC+kCUU5XLkAo50C+gbBQdUzkAIVyejIAYfFTI1solHP2HgNCnHn5AYNy4jvpoVB6fVzL91cwzLJ9Lfd7S0jhehxO5H5/yePr1W6gHonI7fJ5ORSR/n6Q2yQanq763zuXU5LJZRKiyD/W9/pjkdPZz0/yJ8fqVyry+qQZDMjJKoDfy8bRVhHhQTwAAAAASUVORK5CYII=);z-index:-1}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:after{display:none}}.auth-wrapper.auth-v2{align-items:flex-start}.auth-wrapper.auth-v2 .auth-inner{height:100vh;overflow-y:auto;height:calc(var(--vh, 1vh) * 100)}.auth-wrapper.auth-v2 .brand-logo{position:absolute;top:2rem;left:2rem;margin:0;z-index:1}.auth-wrapper.auth-v1 .auth-inner{max-width:400px}.auth-wrapper .brand-logo{display:flex;justify-content:center;margin:1rem 0 2rem}.auth-wrapper .brand-logo .brand-text{font-weight:600}.auth-wrapper .auth-footer-btn .btn{padding:.6rem!important}.auth-wrapper .auth-footer-btn .btn:not(:last-child){margin-right:1rem}@media (min-width: 1200px){.auth-wrapper.auth-v2 .auth-card{width:400px}}.auth-wrapper .auth-bg{background-color:#fff}.dark-layout .auth-wrapper .auth-bg{background-color:#283046}@media (max-height: 625px){.dark-layout .auth-wrapper .auth-inner{background-color:#283046}.auth-wrapper .auth-bg{padding-top:3rem}.auth-wrapper .auth-inner{background-color:#fff;padding-bottom:1rem}.auth-wrapper.auth-v2 .brand-logo{width:100%;display:flex;justify-content:unset;position:relative;left:0;padding-left:1.5rem}}@media (max-width: 992px){.social-signup{margin-left:0;margin-top:10px}.g_id_signin{display:flex;justify-content:center}}@media (min-width: 993px){.social-signup{margin-left:7px;width:100%}}#g_id_onload{display:contents}.auth-help-icon{position:absolute;top:10px;right:10px}.social-signup{border:0px;border-radius:50px;height:41px;padding:9px 10px;font-weight:700;font-size:13px;background:none;border:1px solid lightgray;width:auto}.bsk-container{text-align:center}.social-signup img{padding-right:5px}.microsoft-auth{cursor:pointer;transition:all .2s linear 0s,background-position 1ms ease 0s,background-size 1ms ease 0s;color:#fff;border:1px solid rgb(11,53,88);background-color:#0b3558}.microsoft-auth:hover{background-color:#476788;border-color:#476788}\n'],encapsulation:2})}return i})();class Le{}var ft=m(4329);function Xe(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"form.emailIsRequired")))}function et(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"form.emailMustBeValid")))}function tt(i,g){if(1&i&&(r.TgZ(0,"div",41),r.YNc(1,Xe,3,3,"div",42),r.YNc(2,et,3,3,"div",42),r.qZA()),2&i){const a=r.oxw();r.xp6(1),r.Q6J("ngIf",a.f.email.errors.required),r.xp6(1),r.Q6J("ngIf",a.f.email.errors.email)}}function Lt(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.qZA()),2&i&&(r.xp6(1),r.Oqu("form.passwordIsRequired"))}const Ye=function(i){return{"d-block":i}};function xe(i,g){if(1&i&&(r.TgZ(0,"div",43),r.YNc(1,Lt,2,1,"div",42),r.qZA()),2&i){const a=r.oxw();r.Q6J("ngClass",r.VKq(2,Ye,a.submitted&&a.f.password.errors)),r.xp6(1),r.Q6J("ngIf",a.f.password.errors.required)}}function At(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.qZA()),2&i&&(r.xp6(1),r.Oqu("signUp.passwordIsRequired"))}function xt(i,g){if(1&i&&(r.TgZ(0,"div",43),r.YNc(1,At,2,1,"div",42),r.qZA()),2&i){const a=r.oxw();r.Q6J("ngClass",r.VKq(2,Ye,a.submitted&&a.f.password.errors)),r.xp6(1),r.Q6J("ngIf",a.f.password.errors.required)}}function Ct(i,g){1&i&&(r.TgZ(0,"div",44)(1,"p",45),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"signUp.fillRequredFields")))}function Ut(i,g){1&i&&(r.TgZ(0,"div",44)(1,"p",46),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"signUp.mailExists"),""))}function Bt(i,g){1&i&&(r.TgZ(0,"div",44)(1,"p",46),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"signUp.passwordNotMatch"),""))}function Dt(i,g){1&i&&(r.TgZ(0,"div",44)(1,"p",45),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"signUp.privacyAndTermsNeedToAccept"),""))}function Zt(i,g){1&i&&(r.TgZ(0,"div",44)(1,"p",47),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"signUp.verifyYouMail"),""))}function Kt(i,g){1&i&&r._UZ(0,"span",48)}const Ht=function(i){return{"is-invalid":i}},vt=function(i){return{"is-invalid error":i}},Tt=function(i,g){return{"icon-eye-off":i,"icon-eye":g}},Ie=function(){return{standalone:!0}};let Pe=(()=>{class i{constructor(a,u,p,E,L,$,ee,ae,ge,Re){this._coreConfigService=a,this._formBuilder=u,this._service=p,this._router=E,this._activatedRouter=L,this._toastr=$,this._translate=ee,this._storageService=ae,this.authService=ge,this.msalService=Re,this.submitted=!1,this.response=new Le,this.loading=!1,this.privacyAndTerms=!1,this._unsubscribeAll=new d.xQ,this._coreConfigService.config={layout:{navbar:{hidden:!0},menu:{hidden:!0},footer:{hidden:!0},customizer:!1,enableLocalStorage:!1}}}get f(){return this.registerForm.controls}togglePasswordTextType(){this.passwordTextType=!this.passwordTextType}onSubmit(){this.submitted=!0,!this.registerForm.invalid&&this.privacyAndTerms&&this.signUp(this.registerForm.value)}ngOnInit(){var a=this;return(0,I.Z)(function*(){a.registerForm=a._formBuilder.group({email:["",[A.kI.required,A.kI.email]],password:["",A.kI.required],rePassword:["",A.kI.required]}),a._coreConfigService.config.pipe((0,b.R)(a._unsubscribeAll)).subscribe(u=>{a.coreConfig=u}),a.validateRecommenedBonusLink(),a._translate.onLangChange.subscribe(u=>{a.lang=u.lang}),a.authSubscription=a.authService.authState.subscribe(u=>{a._service.callPostMethod("api/google/auth",{idToken:u.idToken}).subscribe(p=>{a._router.navigate([p])})}),a.lang=a._storageService.getSelectedLanguage(),yield a.msalService.instance.initialize()})()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}signUp(a){this.response=new Le,this.loading=!0,a.password===a.rePassword?this._service.callPostMethod("/api/signUp",{data:a,lang:this._storageService.getSelectedLanguage()}).subscribe(u=>{u?(this.response.verifyYourMail=!0,this.loading=!1,this.createRecommendedBonus(),setTimeout(()=>{this._router.navigate(["/auth/login"])},6e3)):(this.loading=!1,this.response.mailExists=!0)}):(this.loading=!1,this.response.passwordNotMatch=!0)}validateRecommenedBonusLink(){const a=this._activatedRouter.snapshot.queryParams.id;a&&this._service.callGetMethod("/api/validateRecommenedBonusLink",a).subscribe(u=>{u||(this._router.navigate(["/auth/signup"]),this._toastr.showErrorCustom(this._translate.instant("recommended.wrongRecommendedBonusLink")))})}createRecommendedBonus(){const a=this._activatedRouter.snapshot.queryParams.id;a&&this._service.callPostMethod("/api/createRecommendedBonus",{id:a}).subscribe(u=>{})}loginWithMicrosoft(){this.msalService.loginPopup().subscribe(a=>{console.log(a),a&&a.account&&this._service.callPostMethod("api/microsoft/findOrCreateUserViaMicrosoft",{email:a.account.username}).subscribe(u=>{this._router.navigate([u])})})}googleSignin(a){a.click()}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(_.R),r.Y36(A.QS),r.Y36(B.f),r.Y36(R.F0),r.Y36(R.gz),r.Y36(ft.l),r.Y36(de.sK),r.Y36(Q.V),r.Y36(H),r.Y36(Se))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-signup"]],decls:87,vars:77,consts:[[1,"auth-wrapper","auth-v2"],[1,"auth-inner","row","m-0"],["href","https://termmy.com",1,"brand-logo"],["alt","brand-logo","height","28",3,"src"],[1,"brand-text","text-primary","ml-1"],[1,"d-none","d-lg-flex","col-lg-8","align-items-center","p-5"],[1,"w-100","d-lg-flex","align-items-center","justify-content-center","px-5"],["alt","Register V2",1,"img-fluid",3,"src"],[1,"d-flex","col-lg-4","align-items-center","auth-bg","px-2","p-lg-5"],[1,"col-12","col-sm-8","col-md-6","col-lg-12","px-xl-2","mx-auto"],[1,"card-title","font-weight-bold","mb-1"],[1,"card-text","mb-2"],[1,"auth-register-form","mt-2",3,"formGroup","ngSubmit"],[1,"form-group"],["for","register-email",1,"form-label"],["type","text","formControlName","email","placeholder","email@termmy.com","aria-describedby","register-email","tabindex","2",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","register-password",1,"form-label"],[1,"input-group","input-group-merge","form-password-toggle"],["formControlName","password","placeholder","\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7","aria-describedby","register-password","tabindex","3",1,"form-control","form-control-merge",3,"type","ngClass"],[1,"input-group-append"],[1,"input-group-text","cursor-pointer"],[1,"feather","font-small-4",3,"ngClass","click"],["class","invalid-feedback",3,"ngClass",4,"ngIf"],["formControlName","rePassword","placeholder","\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7","aria-describedby","register-password","tabindex","3",1,"form-control","form-control-merge",3,"type","ngClass"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","register-privacy-policy","tabindex","4",1,"custom-control-input",3,"ngModel","ngModelOptions","ngModelChange"],["for","register-privacy-policy",1,"custom-control-label"],["href","https://termmy.com/privacy-policy","target","_blank"],["href","https://termmy.com/terms","target","_blank"],["class","text-center",4,"ngIf"],["tabindex","5","rippleEffect","",1,"btn","btn-primary","btn-block"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"text-center","mt-2"],["routerLink","/auth/login"],[1,"divider","my-2"],[1,"divider-text"],[1,"auth-footer-btn","d-flex","justify-content-center","row"],[3,"loginWithGoogle"],[1,"bsk-btn","bsk-btn-default","social-signup","microsoft-auth",3,"click"],["src","../../../assets/images/icons/microsoft.svg"],[1,"invalid-feedback"],[4,"ngIf"],[1,"invalid-feedback",3,"ngClass"],[1,"text-center"],[1,"badge","badge-light-danger","badge-pill","full-width","p-1"],[1,"badge","badge-light-danger","badge-pill","full-width","p-1","white-space-break"],[1,"badge","badge-light-success","badge-pill","full-width","p-1","white-space-break"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(u,p){1&u&&(r.TgZ(0,"div",0)(1,"div",1)(2,"a",2),r._UZ(3,"img",3),r.TgZ(4,"h2",4),r._uU(5),r.qZA()(),r.TgZ(6,"div",5)(7,"div",6),r._UZ(8,"img",7),r.qZA()(),r.TgZ(9,"div",8),r._UZ(10,"app-select-language"),r.TgZ(11,"div",9)(12,"h2",10),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"p",11),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"form",12),r.NdJ("ngSubmit",function(){return p.onSubmit()}),r.TgZ(19,"div",13)(20,"label",14),r._uU(21),r.ALo(22,"translate"),r.qZA(),r._UZ(23,"input",15),r.YNc(24,tt,3,2,"div",16),r.qZA(),r.TgZ(25,"div",13)(26,"label",17),r._uU(27),r.ALo(28,"translate"),r.qZA(),r.TgZ(29,"div",18),r._UZ(30,"input",19),r.TgZ(31,"div",20)(32,"span",21)(33,"i",22),r.NdJ("click",function(){return p.togglePasswordTextType()}),r.qZA()()()(),r.YNc(34,xe,2,4,"div",23),r.qZA(),r.TgZ(35,"div",13)(36,"label",17),r._uU(37),r.ALo(38,"translate"),r.qZA(),r.TgZ(39,"div",18),r._UZ(40,"input",24),r.TgZ(41,"div",20)(42,"span",21)(43,"i",22),r.NdJ("click",function(){return p.togglePasswordTextType()}),r.qZA()()()(),r.YNc(44,xt,2,4,"div",23),r.qZA(),r.TgZ(45,"div",13)(46,"div",25)(47,"input",26),r.NdJ("ngModelChange",function(L){return p.privacyAndTerms=L}),r.qZA(),r.TgZ(48,"label",27),r._uU(49),r.ALo(50,"translate"),r.TgZ(51,"a",28),r._uU(52),r.ALo(53,"translate"),r.qZA(),r._uU(54),r.ALo(55,"translate"),r.TgZ(56,"a",29),r._uU(57),r.ALo(58,"translate"),r.qZA()()()(),r.TgZ(59,"div"),r.YNc(60,Ct,4,3,"div",30),r.YNc(61,Ut,4,3,"div",30),r.YNc(62,Bt,4,3,"div",30),r.YNc(63,Dt,4,3,"div",30),r.YNc(64,Zt,4,3,"div",30),r.qZA(),r.TgZ(65,"button",31),r.YNc(66,Kt,1,0,"span",32),r._uU(67),r.ALo(68,"translate"),r.qZA()(),r.TgZ(69,"p",33)(70,"span"),r._uU(71),r.ALo(72,"translate"),r.qZA(),r.TgZ(73,"a",34)(74,"span"),r._uU(75),r.ALo(76,"translate"),r.qZA()()(),r.TgZ(77,"div",35)(78,"div",36),r._uU(79),r.ALo(80,"translate"),r.qZA()(),r.TgZ(81,"div",37)(82,"app-google-signin",38),r.NdJ("loginWithGoogle",function(L){return p.googleSignin(L)}),r.qZA(),r.TgZ(83,"button",39),r.NdJ("click",function(){return p.loginWithMicrosoft()}),r._UZ(84,"img",40),r._uU(85),r.ALo(86,"translate"),r.qZA()()()()()()),2&u&&(r.xp6(3),r.s9C("src",p.coreConfig.app.appLogoImage,r.LSH),r.xp6(2),r.Oqu(p.coreConfig.app.appName),r.xp6(3),r.Q6J("src","dark"===p.coreConfig.layout.skin?"assets/images/pages/register-v2-dark.svg":"assets/images/pages/register-v2.svg",r.LSH),r.xp6(5),r.Oqu(r.lcZ(14,36,"signUp.title")),r.xp6(3),r.Oqu(r.lcZ(17,38,"signUp.text")),r.xp6(2),r.Q6J("formGroup",p.registerForm),r.xp6(3),r.Oqu(r.lcZ(22,40,"commonFields.email")),r.xp6(2),r.Q6J("ngClass",r.VKq(64,Ht,p.submitted&&p.f.email.errors)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.email.errors),r.xp6(3),r.Oqu(r.lcZ(28,42,"commonFields.password")),r.xp6(3),r.Q6J("type",p.passwordTextType?"text":"password")("ngClass",r.VKq(66,vt,p.submitted&&p.f.password.errors)),r.xp6(3),r.Q6J("ngClass",r.WLB(68,Tt,p.passwordTextType,!p.passwordTextType)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.password.errors),r.xp6(3),r.Oqu(r.lcZ(38,44,"commonFields.rePassword")),r.xp6(3),r.Q6J("type",p.passwordTextType?"text":"password")("ngClass",r.VKq(71,vt,p.submitted&&p.f.password.errors)),r.xp6(3),r.Q6J("ngClass",r.WLB(73,Tt,p.passwordTextType,!p.passwordTextType)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.password.errors),r.xp6(3),r.Q6J("ngModel",p.privacyAndTerms)("ngModelOptions",r.DdM(76,Ie)),r.xp6(2),r.hij(" ",r.lcZ(50,46,"signUp.IAgreeTo")," "),r.xp6(3),r.Oqu(r.lcZ(53,48,"signUp.privacyPolicy")),r.xp6(2),r.hij(" ",r.lcZ(55,50,"signUp.and")," "),r.xp6(3),r.Oqu(r.lcZ(58,52,"signUp.terms")),r.xp6(3),r.Q6J("ngIf",p.submitted&&p.registerForm.invalid),r.xp6(1),r.Q6J("ngIf",p.response.mailExists),r.xp6(1),r.Q6J("ngIf",p.response.passwordNotMatch),r.xp6(1),r.Q6J("ngIf",p.submitted&&!p.privacyAndTerms),r.xp6(1),r.Q6J("ngIf",p.response.verifyYourMail),r.xp6(2),r.Q6J("ngIf",p.loading),r.xp6(1),r.Oqu(r.lcZ(68,54,"signUp.signUp")),r.xp6(4),r.Oqu(r.lcZ(72,56,"signUp.alreadyHaveAnAccount")),r.xp6(4),r.hij("\xa0",r.lcZ(76,58,"signUp.signInInstead"),""),r.xp6(4),r.Oqu(r.lcZ(80,60,"login.or")),r.xp6(6),r.hij(" ",r.lcZ(86,62,"login.signInWithMicrosoft"),""))},dependencies:[l.mk,l.O5,R.rH,A._Y,A.Fj,A.Wl,A.JJ,A.JL,A.On,A.sg,A.u,me.oO,le.R,fe,Ge,de.X$],styles:['.auth-wrapper{display:flex;flex-basis:100%;min-height:100vh;min-height:calc(var(--vh, 1vh) * 100);width:100%}.auth-wrapper .auth-inner{width:100%;position:relative}.auth-wrapper.auth-v1{align-items:center;justify-content:center;overflow:hidden}.auth-wrapper.auth-v1 .auth-inner:before{width:244px;height:243px;content:" ";position:absolute;top:-54px;left:-46px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAADzCAMAAACG9Mt0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA9KADAAQAAAABAAAA8wAAAADhQHfUAAAAyVBMVEUAAAD///+AgP+AgP9mZv+AgNWAgP9tbf9gYP+AgP9xcf9mZv+AZuaAgP9dXf90dOhiYv92dv9mZu5mZv93d+53d/9paf94afCAcfFrXvJra/9mZvJzZvJzc/JoaP96b/Rqav91aupsYvV2bOt2bPVxaPZ7cfZqavZyau1waPd4aO9xafBxafh4afB1bfh4avFuZ/F2afJzZvJzZ/N0aPN0bvN3bPR0ae5yZ/R3be93bfR1au9zafBxbPVzavV0a/F0a/ZyafFwaPKZm3nTAAAAQ3RSTlMAAQIEBQYGBwgICQoKCgsLDQ0PDw8PERESExMUFBQWFxgYGhoaGxsdHSAgIiIiIyQlJygqLCwtLi8vLzAzNDU3Nzg7h9vbHgAAA9RJREFUeNrt3ftS2kAUx/Fc1gSyWsErtuJdRDQiiteolb7/QzUoTm07k4AzObuu3/MCez45yWbzT36eZ6b8erO1e1B97baadd+zocJWmg0HaXe/+uqmg2GWtkLT5Lle1m9LdhG2+1lvzuiUO1knEF81yFc1N+35m15kZOGodz1vyLx+v2Lseq/erxtZd/NuweCTtfiwaWLOD5FnsqI7+VnP3y8afnEs3Es/1+H1qvETwuq18B7e6VlwLup1ZM8kWWQBOsrmHL7GVtxvYRZYgQ4ywae61ffsqH5Lbq20bQm6ncp9P2ehJegwE/u+rl95ttSwLrVSc2ANetAU28dSa9Cp2E623bUG3d2VWmn/wBq0XCugQYMGLdVKoOJaoiuok1NdXSW1WAUfRPtRUllflaJf5ZE/O9pXVbZUPTov5c+IDqvtRwStdTgLutoxy6GnGfYb2o+1I2gd+1OiqzfLocvVE7TSDqG1mgodaqfQZbvZC9rXjqG1X45WzqFVKVpk0LLo4lGP0ZGD6KgMnTiITkrQgXYQrYNitHISrYrRsZPouBhdcxJdK0YnTqKTYrR2Eq1BgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRoh9DH59ag86ACoSYOL61B55EUQk1s3VqDzsNHhJpYe7QGncfMSHUxaliCHgcKSXVxeWQJehwdJdXF4dAS9DgkTKqLxuibFeiXODixNi7OrEC/BP+JtbE0WrYA/RrxKNfH2YUF6NegSbk+Gk87xtErN6EsWm88fzeMXpwE9EruLns/l42io4dJFLPo2/Po1w+D6IW7t9Bt2SPx3vOOMfS7eHVZtN54ulg2go56138Ct4XRunE2Ovsmjg46WeddUoUWr6WL0fCoIYgO2/2s91fstDZQjcPL0ePt5flpdXUwqW46uMrS1j95JNpQrW0dHp9UV/uT2m416/8HVGg3qzhpBjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KC/FDpx0pwUo2tOomvF6NhJdFyMVk6iVTE6cBIdeF9vJyvZx/I/AzuIjsrQvoNovwzt4FamSs0Ojrp80PmvoB0zh940pb7azf1yg7t0LIt978uppzbnalfucDW92ZndLPRmKweGPduYJ+zoM5/Dk+gD5NdvLhXXPp88qcUqmEH5G5JZRs6cuxwIAAAAAElFTkSuQmCC)}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:before{display:none}}.auth-wrapper.auth-v1 .auth-inner:after{width:272px;height:272px;content:" ";position:absolute;bottom:-55px;right:-75px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARAAAAEQCAMAAABP1NsnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABEKADAAQAAAABAAABEAAAAAAQWxS2AAAAwFBMVEUAAAD///+AgICAgP9VVaqqVf+qqv+AgL+AgP9mZsxmZv+ZZv+AgNWAgP9tbdttbf+Sbf+AYN+AgN+AgP9xceNmZv+AZuaAZv90dOh0dP9qav+AauqAav+AgP92dv9tbf+Abe2Abf93Zu53d+6AcO94afCAcfF5a+R5a/JzZuaAZvKAc/J5bed5bfOAaPN6b/R1auqAavR6ZvV6cPV2bOuAbPV7aPZ2be2AbfZ7au17avZ3Zu53b+57a+97a/d4aO9J6CoeAAAAQHRSTlMAAQICAwMDBAQFBQUGBgcHBwgICAkKCgoLCwwMDAwNDg4ODw8QERITExQUFBUVFhcYGBkZGhobHBwdHR4eHx8gJ5uMWwAAA/FJREFUeNrt2G1XEkEYxvHZNk2xHGzdbKFl0cTwgdSkCKzu7/+t4pw6sAjtjIueE/f8r3fMO35nZnbuy5gVGcvfzJe0rnTfGI+MggGJRUZnbpPIhJKt88nU53JnFULvyISY6KAv8vPj0vr2rYwiE2Z2B9J+uNYcyyQxwWZvaeGH3G4bMjsvI/kcwTC/V+7kLoahlITzQojP3ZFgsJCh7IJQzpX0QFj4uMiY18eDMZ9bZCF9OQahnK6cm/Y7js0sh/LF3Auv1PlQd3MxbdXYIQspV44EEEAAAWTNDAYYkKdJbNMsLzYueZbaZ2iM46RVbHBaiZ9Js+nHEdli42N9XuSen5hGp1CQTuOJQDRsD99N4gMSpYWapNH6IJo83CIeILZQFesEaber79NCWRoukOpNEnW0gXQqD81w6ACxhbrYde7VuFCYeA2QRCNIsgZISyNIqz6IyhPjOjNVIFYniK3dmKU6QdLaJUimEySrDZLrBMlrgxRKU7sxCw/EMe0CAggggADySJCqxixIkKpNEh6IozELD8RxjQACCCCAAPJIkKrGLEgQXqqAAEJjxrQLCCCAAEJjRmNGY8a0CwgggABCYwYIfQgggNCYMe0CAggggNCY0ZjRmDHtAgIIIIAAQmNGHwIIIDRmTLuAAAIIIDRmNGY0Zky7gAACCCCA0JjRhwACCI0Z0y4ggAACCI0ZjRmNGdMuIIAAAgggNGb0IYAAQmPGtAsIIIAAQmNGY0ZjxrQLCCCAAAIIjRl9CCCA0Jgx7QICCCCA0JjRmNGYMe0CAggggABCY0YfAgggNGZMu4AAAgggNGY0ZjRmTLuAAAIIIIDQmNGHAAIIjRnTLiCAAAIIjRmNGY0ZIEy7gAACCCA0ZvQhgABCY8a0CwgggABCY0ZjBgiNGdMuIIAAAgiN2f/Sh+Q6PfLaIJlOkKw2SKoTJK3dmFmdILb2tBvrBIlrg5iWRo+WqQ+SaARJ1gCJAzsxThCN16p1vNurGjNjoo42j07kAHFskoY2kEbl33U0ZgoPjXW+Rl0gkarnahqtDaJKxMPDDWIiNafGenh4gExvVhXfmk7Da6L1AVGxSby2h6MxK79Zk42ea1pJbJ48sU2zDezQ8iy1z6BBwoyjMQsvXp8YQAAhgADilRfyy+wf8WqZZUfGZihvgZiB3FybC+kCUU5XLkAo50C+gbBQdUzkAIVyejIAYfFTI1solHP2HgNCnHn5AYNy4jvpoVB6fVzL91cwzLJ9Lfd7S0jhehxO5H5/yePr1W6gHonI7fJ5ORSR/n6Q2yQanq763zuXU5LJZRKiyD/W9/pjkdPZz0/yJ8fqVyry+qQZDMjJKoDfy8bRVhHhQTwAAAAASUVORK5CYII=);z-index:-1}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:after{display:none}}.auth-wrapper.auth-v2{align-items:flex-start}.auth-wrapper.auth-v2 .auth-inner{height:100vh;overflow-y:auto;height:calc(var(--vh, 1vh) * 100)}.auth-wrapper.auth-v2 .brand-logo{position:absolute;top:2rem;left:2rem;margin:0;z-index:1}.auth-wrapper.auth-v1 .auth-inner{max-width:400px}.auth-wrapper .brand-logo{display:flex;justify-content:center;margin:1rem 0 2rem}.auth-wrapper .brand-logo .brand-text{font-weight:600}.auth-wrapper .auth-footer-btn .btn{padding:.6rem!important}.auth-wrapper .auth-footer-btn .btn:not(:last-child){margin-right:1rem}@media (min-width: 1200px){.auth-wrapper.auth-v2 .auth-card{width:400px}}.auth-wrapper .auth-bg{background-color:#fff}.dark-layout .auth-wrapper .auth-bg{background-color:#283046}@media (max-height: 625px){.dark-layout .auth-wrapper .auth-inner{background-color:#283046}.auth-wrapper .auth-bg{padding-top:3rem}.auth-wrapper .auth-inner{background-color:#fff;padding-bottom:1rem}.auth-wrapper.auth-v2 .brand-logo{width:100%;display:flex;justify-content:unset;position:relative;left:0;padding-left:1.5rem}}.auth-help-icon{position:absolute;top:10px;right:10px}\n'],encapsulation:2})}return i})();var Qe=m(6279);function Gt(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"form.passwordIsRequired")))}const je=function(i){return{"d-block":i}};function Ft(i,g){if(1&i&&(r.TgZ(0,"div",29),r.YNc(1,Gt,3,3,"div",30),r.qZA()),2&i){const a=r.oxw();r.Q6J("ngClass",r.VKq(2,je,a.submitted&&a.f.newPassword.errors)),r.xp6(1),r.Q6J("ngIf",a.f.newPassword.errors.required)}}function It(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.hij("",r.lcZ(2,1,"form.passwordIsRequired")," "))}function nt(i,g){if(1&i&&(r.TgZ(0,"div",29),r.YNc(1,It,3,3,"div",30),r.qZA()),2&i){const a=r.oxw();r.Q6J("ngClass",r.VKq(2,je,a.submitted&&a.f.confirmPassword.errors)),r.xp6(1),r.Q6J("ngIf",a.f.confirmPassword.errors.required)}}function Ue(i,g){1&i&&(r.TgZ(0,"div",31)(1,"p",32),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"resetPassword.passwordNotMatch")))}function Ce(i,g){1&i&&(r.TgZ(0,"div",31)(1,"p",33),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"resetPassword.changedPasswordSuccessfuly"),""))}const Je=function(i){return{"is-invalid error":i}},De=function(i,g){return{"icon-eye-off":i,"icon-eye":g}};let yt=(()=>{class i{constructor(a,u,p,E,L){this._coreConfigService=a,this._formBuilder=u,this._service=p,this._activateRouter=E,this._router=L,this.submitted=!1,this.response=new Le,this._unsubscribeAll=new d.xQ,this._coreConfigService.config={layout:{navbar:{hidden:!0},menu:{hidden:!0},footer:{hidden:!0},customizer:!1,enableLocalStorage:!1}}}get f(){return this.resetPasswordForm.controls}togglePasswordTextType(){this.passwordTextType=!this.passwordTextType}toggleConfPasswordTextType(){this.confPasswordTextType=!this.confPasswordTextType}onSubmit(){this.submitted=!0,!this.resetPasswordForm.invalid&&this.resetPassword()}ngOnInit(){this.resetPasswordForm=this._formBuilder.group({newPassword:["",[A.kI.required]],confirmPassword:["",[A.kI.required]]}),this._coreConfigService.config.pipe((0,b.R)(this._unsubscribeAll)).subscribe(a=>{this.coreConfig=a}),this.checkIfMailExists()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}checkIfMailExists(){this._service.callGetMethod("/api/checkIfMailExists",this._activateRouter.snapshot.params.email).pipe((0,b.R)(this._unsubscribeAll)).subscribe(a=>{a||this._router.navigate(["/miscellaneous/something-happened"])},a=>{this._router.navigate(["/miscellaneous/something-happened"])})}resetPassword(){this.response=new Le,this.resetPasswordForm.value.newPassword===this.resetPasswordForm.value.confirmPassword?this._service.callPostMethod("/api/resetPassword",{password:this.resetPasswordForm.value.newPassword,email:this._activateRouter.snapshot.params.email}).subscribe(u=>{u&&(this.response.changedPasswordSuccessfuly=!0,setTimeout(()=>{this._router.navigate(["/auth/login"])},3e3))}):this.response.passwordNotMatch=!0}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(_.R),r.Y36(A.QS),r.Y36(B.f),r.Y36(R.gz),r.Y36(R.F0))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-reset-password"]],decls:51,vars:42,consts:[[1,"auth-wrapper","auth-v2"],[1,"auth-inner","row","m-0"],["href","https://termmy.com",1,"brand-logo"],["alt","brand-logo","height","28",3,"src"],[1,"brand-text","text-primary","ml-1"],[1,"d-none","d-lg-flex","col-lg-8","align-items-center","p-5"],[1,"w-100","d-lg-flex","align-items-center","justify-content-center","px-5"],["img-fluid","img-fluid","alt","Register V2",3,"src"],[1,"d-flex","col-lg-4","align-items-center","auth-bg","px-2","p-lg-5"],[1,"col-12","col-sm-8","col-md-6","col-lg-12","px-xl-2","mx-auto"],[1,"card-title","font-weight-bold","mb-1"],[1,"card-text","mb-2"],[1,"auth-reset-password-form","mt-2",3,"formGroup","ngSubmit"],[1,"form-group"],[1,"d-flex","justify-content-between"],["for","reset-password-new"],[1,"input-group","input-group-merge","form-password-toggle"],["formControlName","newPassword","placeholder","\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7","aria-describedby","reset-password-new","tabindex","1","autofocus","",1,"form-control","form-control-merge",3,"type","ngClass"],[1,"input-group-append"],[1,"input-group-text","cursor-pointer"],[1,"feather","font-small-4",3,"ngClass","click"],["class","invalid-feedback",3,"ngClass",4,"ngIf"],["for","reset-password-confirm"],["formControlName","confirmPassword","placeholder","\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7\xb7","aria-describedby","reset-password-confirm","tabindex","2",1,"form-control","form-control-merge",3,"type","ngClass"],["class","text-center",4,"ngIf"],["tabindex","3","rippleEffect","",1,"btn","btn-primary","btn-block"],[1,"text-center","mt-2"],["routerLink","/auth/login"],["data-feather","chevron-left",1,"mb-25"],[1,"invalid-feedback",3,"ngClass"],[4,"ngIf"],[1,"text-center"],[1,"badge","badge-light-danger","badge-pill","full-width","p-1"],[1,"badge","badge-light-success","badge-pill","full-width","p-1","white-space-break"]],template:function(u,p){1&u&&(r.TgZ(0,"div",0)(1,"div",1)(2,"a",2),r._UZ(3,"img",3),r.TgZ(4,"h2",4),r._uU(5),r.qZA()(),r.TgZ(6,"div",5)(7,"div",6),r._UZ(8,"img",7),r.qZA()(),r.TgZ(9,"div",8),r._UZ(10,"app-select-language"),r.TgZ(11,"div",9)(12,"h2",10),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"p",11),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"form",12),r.NdJ("ngSubmit",function(){return p.onSubmit()}),r.TgZ(19,"div",13)(20,"div",14)(21,"label",15),r._uU(22),r.ALo(23,"translate"),r.qZA()(),r.TgZ(24,"div",16),r._UZ(25,"input",17),r.TgZ(26,"div",18)(27,"span",19)(28,"i",20),r.NdJ("click",function(){return p.togglePasswordTextType()}),r.qZA()()()(),r.YNc(29,Ft,2,4,"div",21),r.qZA(),r.TgZ(30,"div",13)(31,"div",14)(32,"label",22),r._uU(33),r.ALo(34,"translate"),r.qZA()(),r.TgZ(35,"div",16),r._UZ(36,"input",23),r.TgZ(37,"div",18)(38,"span",19)(39,"i",20),r.NdJ("click",function(){return p.toggleConfPasswordTextType()}),r.qZA()()()(),r.YNc(40,nt,2,4,"div",21),r.qZA(),r.YNc(41,Ue,4,3,"div",24),r.YNc(42,Ce,4,3,"div",24),r.TgZ(43,"button",25),r._uU(44),r.ALo(45,"translate"),r.qZA()(),r.TgZ(46,"p",26)(47,"a",27),r._UZ(48,"i",28),r._uU(49),r.ALo(50,"translate"),r.qZA()()()()()()),2&u&&(r.xp6(3),r.s9C("src",p.coreConfig.app.appLogoImage,r.LSH),r.xp6(2),r.Oqu(p.coreConfig.app.appName),r.xp6(3),r.Q6J("src","dark"===p.coreConfig.layout.skin?"assets/images/pages/reset-password-v2-dark.svg":"assets/images/pages/reset-password-v2.svg",r.LSH),r.xp6(5),r.Oqu(r.lcZ(14,20,"resetPassword.title")),r.xp6(3),r.Oqu(r.lcZ(17,22,"resetPassword.text")),r.xp6(2),r.Q6J("formGroup",p.resetPasswordForm),r.xp6(4),r.Oqu(r.lcZ(23,24,"resetPassword.newPassword")),r.xp6(3),r.Q6J("type",p.passwordTextType?"text":"password")("ngClass",r.VKq(32,Je,p.submitted&&p.f.newPassword.errors)),r.xp6(3),r.Q6J("ngClass",r.WLB(34,De,p.passwordTextType,!p.passwordTextType)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.newPassword.errors),r.xp6(4),r.Oqu(r.lcZ(34,26,"resetPassword.confirmPassword")),r.xp6(3),r.Q6J("type",p.confPasswordTextType?"text":"password")("ngClass",r.VKq(37,Je,p.submitted&&p.f.confirmPassword.errors)),r.xp6(3),r.Q6J("ngClass",r.WLB(39,De,p.confPasswordTextType,!p.confPasswordTextType)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.confirmPassword.errors),r.xp6(1),r.Q6J("ngIf",p.response.passwordNotMatch),r.xp6(1),r.Q6J("ngIf",p.response.changedPasswordSuccessfuly),r.xp6(2),r.Oqu(r.lcZ(45,28,"resetPassword.setNewPassword")),r.xp6(5),r.hij(" ",r.lcZ(50,30,"authGlobal.backToLogin"),""))},dependencies:[l.mk,l.O5,R.rH,A._Y,A.Fj,A.JJ,A.JL,A.sg,A.u,me.oO,le.R,Qe.R,Ge,de.X$],styles:['.auth-wrapper{display:flex;flex-basis:100%;min-height:100vh;min-height:calc(var(--vh, 1vh) * 100);width:100%}.auth-wrapper .auth-inner{width:100%;position:relative}.auth-wrapper.auth-v1{align-items:center;justify-content:center;overflow:hidden}.auth-wrapper.auth-v1 .auth-inner:before{width:244px;height:243px;content:" ";position:absolute;top:-54px;left:-46px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAADzCAMAAACG9Mt0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA9KADAAQAAAABAAAA8wAAAADhQHfUAAAAyVBMVEUAAAD///+AgP+AgP9mZv+AgNWAgP9tbf9gYP+AgP9xcf9mZv+AZuaAgP9dXf90dOhiYv92dv9mZu5mZv93d+53d/9paf94afCAcfFrXvJra/9mZvJzZvJzc/JoaP96b/Rqav91aupsYvV2bOt2bPVxaPZ7cfZqavZyau1waPd4aO9xafBxafh4afB1bfh4avFuZ/F2afJzZvJzZ/N0aPN0bvN3bPR0ae5yZ/R3be93bfR1au9zafBxbPVzavV0a/F0a/ZyafFwaPKZm3nTAAAAQ3RSTlMAAQIEBQYGBwgICQoKCgsLDQ0PDw8PERESExMUFBQWFxgYGhoaGxsdHSAgIiIiIyQlJygqLCwtLi8vLzAzNDU3Nzg7h9vbHgAAA9RJREFUeNrt3ftS2kAUx/Fc1gSyWsErtuJdRDQiiteolb7/QzUoTm07k4AzObuu3/MCez45yWbzT36eZ6b8erO1e1B97baadd+zocJWmg0HaXe/+uqmg2GWtkLT5Lle1m9LdhG2+1lvzuiUO1knEF81yFc1N+35m15kZOGodz1vyLx+v2Lseq/erxtZd/NuweCTtfiwaWLOD5FnsqI7+VnP3y8afnEs3Es/1+H1qvETwuq18B7e6VlwLup1ZM8kWWQBOsrmHL7GVtxvYRZYgQ4ywae61ffsqH5Lbq20bQm6ncp9P2ehJegwE/u+rl95ttSwLrVSc2ANetAU28dSa9Cp2E623bUG3d2VWmn/wBq0XCugQYMGLdVKoOJaoiuok1NdXSW1WAUfRPtRUllflaJf5ZE/O9pXVbZUPTov5c+IDqvtRwStdTgLutoxy6GnGfYb2o+1I2gd+1OiqzfLocvVE7TSDqG1mgodaqfQZbvZC9rXjqG1X45WzqFVKVpk0LLo4lGP0ZGD6KgMnTiITkrQgXYQrYNitHISrYrRsZPouBhdcxJdK0YnTqKTYrR2Eq1BgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRoh9DH59ag86ACoSYOL61B55EUQk1s3VqDzsNHhJpYe7QGncfMSHUxaliCHgcKSXVxeWQJehwdJdXF4dAS9DgkTKqLxuibFeiXODixNi7OrEC/BP+JtbE0WrYA/RrxKNfH2YUF6NegSbk+Gk87xtErN6EsWm88fzeMXpwE9EruLns/l42io4dJFLPo2/Po1w+D6IW7t9Bt2SPx3vOOMfS7eHVZtN54ulg2go56138Ct4XRunE2Ovsmjg46WeddUoUWr6WL0fCoIYgO2/2s91fstDZQjcPL0ePt5flpdXUwqW46uMrS1j95JNpQrW0dHp9UV/uT2m416/8HVGg3qzhpBjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KC/FDpx0pwUo2tOomvF6NhJdFyMVk6iVTE6cBIdeF9vJyvZx/I/AzuIjsrQvoNovwzt4FamSs0Ojrp80PmvoB0zh940pb7azf1yg7t0LIt978uppzbnalfucDW92ZndLPRmKweGPduYJ+zoM5/Dk+gD5NdvLhXXPp88qcUqmEH5G5JZRs6cuxwIAAAAAElFTkSuQmCC)}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:before{display:none}}.auth-wrapper.auth-v1 .auth-inner:after{width:272px;height:272px;content:" ";position:absolute;bottom:-55px;right:-75px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARAAAAEQCAMAAABP1NsnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABEKADAAQAAAABAAABEAAAAAAQWxS2AAAAwFBMVEUAAAD///+AgICAgP9VVaqqVf+qqv+AgL+AgP9mZsxmZv+ZZv+AgNWAgP9tbdttbf+Sbf+AYN+AgN+AgP9xceNmZv+AZuaAZv90dOh0dP9qav+AauqAav+AgP92dv9tbf+Abe2Abf93Zu53d+6AcO94afCAcfF5a+R5a/JzZuaAZvKAc/J5bed5bfOAaPN6b/R1auqAavR6ZvV6cPV2bOuAbPV7aPZ2be2AbfZ7au17avZ3Zu53b+57a+97a/d4aO9J6CoeAAAAQHRSTlMAAQICAwMDBAQFBQUGBgcHBwgICAkKCgoLCwwMDAwNDg4ODw8QERITExQUFBUVFhcYGBkZGhobHBwdHR4eHx8gJ5uMWwAAA/FJREFUeNrt2G1XEkEYxvHZNk2xHGzdbKFl0cTwgdSkCKzu7/+t4pw6sAjtjIueE/f8r3fMO35nZnbuy5gVGcvfzJe0rnTfGI+MggGJRUZnbpPIhJKt88nU53JnFULvyISY6KAv8vPj0vr2rYwiE2Z2B9J+uNYcyyQxwWZvaeGH3G4bMjsvI/kcwTC/V+7kLoahlITzQojP3ZFgsJCh7IJQzpX0QFj4uMiY18eDMZ9bZCF9OQahnK6cm/Y7js0sh/LF3Auv1PlQd3MxbdXYIQspV44EEEAAAWTNDAYYkKdJbNMsLzYueZbaZ2iM46RVbHBaiZ9Js+nHEdli42N9XuSen5hGp1CQTuOJQDRsD99N4gMSpYWapNH6IJo83CIeILZQFesEaber79NCWRoukOpNEnW0gXQqD81w6ACxhbrYde7VuFCYeA2QRCNIsgZISyNIqz6IyhPjOjNVIFYniK3dmKU6QdLaJUimEySrDZLrBMlrgxRKU7sxCw/EMe0CAggggADySJCqxixIkKpNEh6IozELD8RxjQACCCCAAPJIkKrGLEgQXqqAAEJjxrQLCCCAAEJjRmNGY8a0CwgggABCYwYIfQgggNCYMe0CAggggNCY0ZjRmDHtAgIIIIAAQmNGHwIIIDRmTLuAAAIIIDRmNGY0Zky7gAACCCCA0JjRhwACCI0Z0y4ggAACCI0ZjRmNGdMuIIAAAgggNGb0IYAAQmPGtAsIIIAAQmNGY0ZjxrQLCCCAAAIIjRl9CCCA0Jgx7QICCCCA0JjRmNGYMe0CAggggABCY0YfAgggNGZMu4AAAgggNGY0ZjRmTLuAAAIIIIDQmNGHAAIIjRnTLiCAAAIIjRmNGY0ZIEy7gAACCCA0ZvQhgABCY8a0CwgggABCY0ZjBgiNGdMuIIAAAgiN2f/Sh+Q6PfLaIJlOkKw2SKoTJK3dmFmdILb2tBvrBIlrg5iWRo+WqQ+SaARJ1gCJAzsxThCN16p1vNurGjNjoo42j07kAHFskoY2kEbl33U0ZgoPjXW+Rl0gkarnahqtDaJKxMPDDWIiNafGenh4gExvVhXfmk7Da6L1AVGxSby2h6MxK79Zk42ea1pJbJ48sU2zDezQ8iy1z6BBwoyjMQsvXp8YQAAhgADilRfyy+wf8WqZZUfGZihvgZiB3FybC+kCUU5XLkAo50C+gbBQdUzkAIVyejIAYfFTI1solHP2HgNCnHn5AYNy4jvpoVB6fVzL91cwzLJ9Lfd7S0jhehxO5H5/yePr1W6gHonI7fJ5ORSR/n6Q2yQanq763zuXU5LJZRKiyD/W9/pjkdPZz0/yJ8fqVyry+qQZDMjJKoDfy8bRVhHhQTwAAAAASUVORK5CYII=);z-index:-1}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:after{display:none}}.auth-wrapper.auth-v2{align-items:flex-start}.auth-wrapper.auth-v2 .auth-inner{height:100vh;overflow-y:auto;height:calc(var(--vh, 1vh) * 100)}.auth-wrapper.auth-v2 .brand-logo{position:absolute;top:2rem;left:2rem;margin:0;z-index:1}.auth-wrapper.auth-v1 .auth-inner{max-width:400px}.auth-wrapper .brand-logo{display:flex;justify-content:center;margin:1rem 0 2rem}.auth-wrapper .brand-logo .brand-text{font-weight:600}.auth-wrapper .auth-footer-btn .btn{padding:.6rem!important}.auth-wrapper .auth-footer-btn .btn:not(:last-child){margin-right:1rem}@media (min-width: 1200px){.auth-wrapper.auth-v2 .auth-card{width:400px}}.auth-wrapper .auth-bg{background-color:#fff}.dark-layout .auth-wrapper .auth-bg{background-color:#283046}@media (max-height: 625px){.dark-layout .auth-wrapper .auth-inner{background-color:#283046}.auth-wrapper .auth-bg{padding-top:3rem}.auth-wrapper .auth-inner{background-color:#fff;padding-bottom:1rem}.auth-wrapper.auth-v2 .brand-logo{width:100%;display:flex;justify-content:unset;position:relative;left:0;padding-left:1.5rem}}.auth-help-icon{position:absolute;top:10px;right:10px}\n'],encapsulation:2})}return i})();function zt(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"form.emailIsRequired")))}function Yt(i,g){1&i&&(r.TgZ(0,"div"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&i&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"form.emailMustBeValid")))}function _t(i,g){if(1&i&&(r.TgZ(0,"div",22),r.YNc(1,zt,3,3,"div",23),r.YNc(2,Yt,3,3,"div",23),r.qZA()),2&i){const a=r.oxw();r.xp6(1),r.Q6J("ngIf",a.f.email.errors.required),r.xp6(1),r.Q6J("ngIf",a.f.email.errors.email)}}function Qt(i,g){1&i&&(r.TgZ(0,"div",24)(1,"p",25),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"forgot.mailNotExists")))}function Et(i,g){1&i&&(r.TgZ(0,"div",24)(1,"p",26),r._uU(2),r.ALo(3,"translate"),r.qZA()()),2&i&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"forgot.sendLinkForResetOnMail"),""))}const jt=function(i){return{"is-invalid":i}};let rt=(()=>{class i{constructor(a,u,p,E){this._coreConfigService=a,this._formBuilder=u,this._service=p,this._storageService=E,this.submitted=!1,this.response=new Le,this._unsubscribeAll=new d.xQ,this._coreConfigService.config={layout:{navbar:{hidden:!0},menu:{hidden:!0},footer:{hidden:!0},customizer:!1,enableLocalStorage:!1}}}get f(){return this.forgotPasswordForm.controls}onSubmit(){this.submitted=!0,!this.forgotPasswordForm.invalid&&this.sendResetLink()}ngOnInit(){this.forgotPasswordForm=this._formBuilder.group({email:["",[A.kI.required,A.kI.email]]}),this._coreConfigService.config.pipe((0,b.R)(this._unsubscribeAll)).subscribe(a=>{this.coreConfig=a})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}sendResetLink(){this.response=new Le,this._service.callPostMethod("/api/forgotPassword",{data:this.forgotPasswordForm.value,lang:this._storageService.getSelectedLanguage()}).subscribe(a=>{a?this.response.sendLinkForResetOnMail=!0:this.response.mailNotExists=!0})}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(_.R),r.Y36(A.QS),r.Y36(B.f),r.Y36(Q.V))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-forgot-password"]],decls:35,vars:25,consts:[[1,"auth-wrapper","auth-v2"],[1,"auth-inner","row","m-0"],["href","https://termmy.com",1,"brand-logo"],["alt","brand-logo","height","28",3,"src"],[1,"brand-text","text-primary","ml-1"],[1,"d-none","d-lg-flex","col-lg-8","align-items-center","p-5"],[1,"w-100","d-lg-flex","align-items-center","justify-content-center","px-5"],["alt","Forgot password V2",1,"img-fluid",3,"src"],[1,"d-flex","col-lg-4","align-items-center","auth-bg","px-2","p-lg-5"],[1,"col-12","col-sm-8","col-md-6","col-lg-12","px-xl-2","mx-auto"],[1,"card-title","font-weight-bold","mb-1"],[1,"card-text","mb-2"],[1,"auth-forgot-password-form","mt-2",3,"formGroup","ngSubmit"],[1,"form-group"],["for","forgot-password-email",1,"form-label"],["type","text","formControlName","email","placeholder","john@example.com","aria-describedby","forgot-password-email","autofocus","","tabindex","1",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["class","text-center",4,"ngIf"],["tabindex","2","rippleEffect","",1,"btn","btn-primary","btn-block"],[1,"text-center","mt-2"],["routerLink","/auth/login"],["data-feather","chevron-left",1,"mb-25"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text-center"],[1,"badge","badge-light-danger","badge-pill","full-width","p-1"],[1,"badge","badge-light-success","badge-pill","full-width","p-1","white-space-break"]],template:function(u,p){1&u&&(r.TgZ(0,"div",0)(1,"div",1)(2,"a",2),r._UZ(3,"img",3),r.TgZ(4,"h2",4),r._uU(5),r.qZA()(),r.TgZ(6,"div",5)(7,"div",6),r._UZ(8,"img",7),r.qZA()(),r.TgZ(9,"div",8),r._UZ(10,"app-select-language"),r.TgZ(11,"div",9)(12,"h2",10),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"p",11),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"form",12),r.NdJ("ngSubmit",function(){return p.onSubmit()}),r.TgZ(19,"div",13)(20,"label",14),r._uU(21),r.ALo(22,"translate"),r.qZA(),r._UZ(23,"input",15),r.qZA(),r.YNc(24,_t,3,2,"div",16),r.YNc(25,Qt,4,3,"div",17),r.YNc(26,Et,4,3,"div",17),r.TgZ(27,"button",18),r._uU(28),r.ALo(29,"translate"),r.qZA()(),r.TgZ(30,"p",19)(31,"a",20),r._UZ(32,"i",21),r._uU(33),r.ALo(34,"translate"),r.qZA()()()()()()),2&u&&(r.xp6(3),r.s9C("src",p.coreConfig.app.appLogoImage,r.LSH),r.xp6(2),r.Oqu(p.coreConfig.app.appName),r.xp6(3),r.Q6J("src","dark"===p.coreConfig.layout.skin?"assets/images/pages/forgot-password-v2-dark.svg":"assets/images/pages/forgot-password-v2.svg",r.LSH),r.xp6(5),r.Oqu(r.lcZ(14,13,"forgot.title")),r.xp6(3),r.Oqu(r.lcZ(17,15,"forgot.text")),r.xp6(2),r.Q6J("formGroup",p.forgotPasswordForm),r.xp6(3),r.Oqu(r.lcZ(22,17,"commonFields.email")),r.xp6(2),r.Q6J("ngClass",r.VKq(23,jt,p.submitted&&p.f.email.errors)),r.xp6(1),r.Q6J("ngIf",p.submitted&&p.f.email.errors),r.xp6(1),r.Q6J("ngIf",p.response.mailNotExists),r.xp6(1),r.Q6J("ngIf",p.response.sendLinkForResetOnMail),r.xp6(2),r.Oqu(r.lcZ(29,19,"forgot.sendResetLink")),r.xp6(5),r.hij(" ",r.lcZ(34,21,"authGlobal.backToLogin"),""))},dependencies:[l.mk,l.O5,R.rH,A._Y,A.Fj,A.JJ,A.JL,A.sg,A.u,me.oO,le.R,Qe.R,Ge,de.X$],styles:['.auth-wrapper{display:flex;flex-basis:100%;min-height:100vh;min-height:calc(var(--vh, 1vh) * 100);width:100%}.auth-wrapper .auth-inner{width:100%;position:relative}.auth-wrapper.auth-v1{align-items:center;justify-content:center;overflow:hidden}.auth-wrapper.auth-v1 .auth-inner:before{width:244px;height:243px;content:" ";position:absolute;top:-54px;left:-46px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAADzCAMAAACG9Mt0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA9KADAAQAAAABAAAA8wAAAADhQHfUAAAAyVBMVEUAAAD///+AgP+AgP9mZv+AgNWAgP9tbf9gYP+AgP9xcf9mZv+AZuaAgP9dXf90dOhiYv92dv9mZu5mZv93d+53d/9paf94afCAcfFrXvJra/9mZvJzZvJzc/JoaP96b/Rqav91aupsYvV2bOt2bPVxaPZ7cfZqavZyau1waPd4aO9xafBxafh4afB1bfh4avFuZ/F2afJzZvJzZ/N0aPN0bvN3bPR0ae5yZ/R3be93bfR1au9zafBxbPVzavV0a/F0a/ZyafFwaPKZm3nTAAAAQ3RSTlMAAQIEBQYGBwgICQoKCgsLDQ0PDw8PERESExMUFBQWFxgYGhoaGxsdHSAgIiIiIyQlJygqLCwtLi8vLzAzNDU3Nzg7h9vbHgAAA9RJREFUeNrt3ftS2kAUx/Fc1gSyWsErtuJdRDQiiteolb7/QzUoTm07k4AzObuu3/MCez45yWbzT36eZ6b8erO1e1B97baadd+zocJWmg0HaXe/+uqmg2GWtkLT5Lle1m9LdhG2+1lvzuiUO1knEF81yFc1N+35m15kZOGodz1vyLx+v2Lseq/erxtZd/NuweCTtfiwaWLOD5FnsqI7+VnP3y8afnEs3Es/1+H1qvETwuq18B7e6VlwLup1ZM8kWWQBOsrmHL7GVtxvYRZYgQ4ywae61ffsqH5Lbq20bQm6ncp9P2ehJegwE/u+rl95ttSwLrVSc2ANetAU28dSa9Cp2E623bUG3d2VWmn/wBq0XCugQYMGLdVKoOJaoiuok1NdXSW1WAUfRPtRUllflaJf5ZE/O9pXVbZUPTov5c+IDqvtRwStdTgLutoxy6GnGfYb2o+1I2gd+1OiqzfLocvVE7TSDqG1mgodaqfQZbvZC9rXjqG1X45WzqFVKVpk0LLo4lGP0ZGD6KgMnTiITkrQgXYQrYNitHISrYrRsZPouBhdcxJdK0YnTqKTYrR2Eq1BgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRoh9DH59ag86ACoSYOL61B55EUQk1s3VqDzsNHhJpYe7QGncfMSHUxaliCHgcKSXVxeWQJehwdJdXF4dAS9DgkTKqLxuibFeiXODixNi7OrEC/BP+JtbE0WrYA/RrxKNfH2YUF6NegSbk+Gk87xtErN6EsWm88fzeMXpwE9EruLns/l42io4dJFLPo2/Po1w+D6IW7t9Bt2SPx3vOOMfS7eHVZtN54ulg2go56138Ct4XRunE2Ovsmjg46WeddUoUWr6WL0fCoIYgO2/2s91fstDZQjcPL0ePt5flpdXUwqW46uMrS1j95JNpQrW0dHp9UV/uT2m416/8HVGg3qzhpBjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KC/FDpx0pwUo2tOomvF6NhJdFyMVk6iVTE6cBIdeF9vJyvZx/I/AzuIjsrQvoNovwzt4FamSs0Ojrp80PmvoB0zh940pb7azf1yg7t0LIt978uppzbnalfucDW92ZndLPRmKweGPduYJ+zoM5/Dk+gD5NdvLhXXPp88qcUqmEH5G5JZRs6cuxwIAAAAAElFTkSuQmCC)}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:before{display:none}}.auth-wrapper.auth-v1 .auth-inner:after{width:272px;height:272px;content:" ";position:absolute;bottom:-55px;right:-75px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARAAAAEQCAMAAABP1NsnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABEKADAAQAAAABAAABEAAAAAAQWxS2AAAAwFBMVEUAAAD///+AgICAgP9VVaqqVf+qqv+AgL+AgP9mZsxmZv+ZZv+AgNWAgP9tbdttbf+Sbf+AYN+AgN+AgP9xceNmZv+AZuaAZv90dOh0dP9qav+AauqAav+AgP92dv9tbf+Abe2Abf93Zu53d+6AcO94afCAcfF5a+R5a/JzZuaAZvKAc/J5bed5bfOAaPN6b/R1auqAavR6ZvV6cPV2bOuAbPV7aPZ2be2AbfZ7au17avZ3Zu53b+57a+97a/d4aO9J6CoeAAAAQHRSTlMAAQICAwMDBAQFBQUGBgcHBwgICAkKCgoLCwwMDAwNDg4ODw8QERITExQUFBUVFhcYGBkZGhobHBwdHR4eHx8gJ5uMWwAAA/FJREFUeNrt2G1XEkEYxvHZNk2xHGzdbKFl0cTwgdSkCKzu7/+t4pw6sAjtjIueE/f8r3fMO35nZnbuy5gVGcvfzJe0rnTfGI+MggGJRUZnbpPIhJKt88nU53JnFULvyISY6KAv8vPj0vr2rYwiE2Z2B9J+uNYcyyQxwWZvaeGH3G4bMjsvI/kcwTC/V+7kLoahlITzQojP3ZFgsJCh7IJQzpX0QFj4uMiY18eDMZ9bZCF9OQahnK6cm/Y7js0sh/LF3Auv1PlQd3MxbdXYIQspV44EEEAAAWTNDAYYkKdJbNMsLzYueZbaZ2iM46RVbHBaiZ9Js+nHEdli42N9XuSen5hGp1CQTuOJQDRsD99N4gMSpYWapNH6IJo83CIeILZQFesEaber79NCWRoukOpNEnW0gXQqD81w6ACxhbrYde7VuFCYeA2QRCNIsgZISyNIqz6IyhPjOjNVIFYniK3dmKU6QdLaJUimEySrDZLrBMlrgxRKU7sxCw/EMe0CAggggADySJCqxixIkKpNEh6IozELD8RxjQACCCCAAPJIkKrGLEgQXqqAAEJjxrQLCCCAAEJjRmNGY8a0CwgggABCYwYIfQgggNCYMe0CAggggNCY0ZjRmDHtAgIIIIAAQmNGHwIIIDRmTLuAAAIIIDRmNGY0Zky7gAACCCCA0JjRhwACCI0Z0y4ggAACCI0ZjRmNGdMuIIAAAgggNGb0IYAAQmPGtAsIIIAAQmNGY0ZjxrQLCCCAAAIIjRl9CCCA0Jgx7QICCCCA0JjRmNGYMe0CAggggABCY0YfAgggNGZMu4AAAgggNGY0ZjRmTLuAAAIIIIDQmNGHAAIIjRnTLiCAAAIIjRmNGY0ZIEy7gAACCCA0ZvQhgABCY8a0CwgggABCY0ZjBgiNGdMuIIAAAgiN2f/Sh+Q6PfLaIJlOkKw2SKoTJK3dmFmdILb2tBvrBIlrg5iWRo+WqQ+SaARJ1gCJAzsxThCN16p1vNurGjNjoo42j07kAHFskoY2kEbl33U0ZgoPjXW+Rl0gkarnahqtDaJKxMPDDWIiNafGenh4gExvVhXfmk7Da6L1AVGxSby2h6MxK79Zk42ea1pJbJ48sU2zDezQ8iy1z6BBwoyjMQsvXp8YQAAhgADilRfyy+wf8WqZZUfGZihvgZiB3FybC+kCUU5XLkAo50C+gbBQdUzkAIVyejIAYfFTI1solHP2HgNCnHn5AYNy4jvpoVB6fVzL91cwzLJ9Lfd7S0jhehxO5H5/yePr1W6gHonI7fJ5ORSR/n6Q2yQanq763zuXU5LJZRKiyD/W9/pjkdPZz0/yJ8fqVyry+qQZDMjJKoDfy8bRVhHhQTwAAAAASUVORK5CYII=);z-index:-1}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:after{display:none}}.auth-wrapper.auth-v2{align-items:flex-start}.auth-wrapper.auth-v2 .auth-inner{height:100vh;overflow-y:auto;height:calc(var(--vh, 1vh) * 100)}.auth-wrapper.auth-v2 .brand-logo{position:absolute;top:2rem;left:2rem;margin:0;z-index:1}.auth-wrapper.auth-v1 .auth-inner{max-width:400px}.auth-wrapper .brand-logo{display:flex;justify-content:center;margin:1rem 0 2rem}.auth-wrapper .brand-logo .brand-text{font-weight:600}.auth-wrapper .auth-footer-btn .btn{padding:.6rem!important}.auth-wrapper .auth-footer-btn .btn:not(:last-child){margin-right:1rem}@media (min-width: 1200px){.auth-wrapper.auth-v2 .auth-card{width:400px}}.auth-wrapper .auth-bg{background-color:#fff}.dark-layout .auth-wrapper .auth-bg{background-color:#283046}@media (max-height: 625px){.dark-layout .auth-wrapper .auth-inner{background-color:#283046}.auth-wrapper .auth-bg{padding-top:3rem}.auth-wrapper .auth-inner{background-color:#fff;padding-bottom:1rem}.auth-wrapper.auth-v2 .brand-logo{width:100%;display:flex;justify-content:unset;position:relative;left:0;padding-left:1.5rem}}.auth-help-icon{position:absolute;top:10px;right:10px}\n'],encapsulation:2})}return i})();function Jt(i,g){if(1&i&&(r.TgZ(0,"div",1)(1,"a",2),r._UZ(2,"img",3),r.TgZ(3,"h2",4),r._uU(4),r.qZA()(),r.TgZ(5,"div",5)(6,"div",6)(7,"h2",7),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"p",8),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.TgZ(13,"form",9)(14,"div",10)(15,"button",11),r._uU(16),r.ALo(17,"translate"),r.qZA()()(),r._UZ(18,"img",12),r.qZA()()()),2&i){const a=r.oxw();r.xp6(2),r.s9C("src",a.coreConfig.app.appLogoImage,r.LSH),r.xp6(2),r.Oqu(a.coreConfig.app.appName),r.xp6(4),r.hij("",r.lcZ(9,5,"verifiedMail.title")," "),r.xp6(3),r.hij("",r.lcZ(12,7,"verifiedMail.text")," "),r.xp6(5),r.Oqu(r.lcZ(17,9,"verifiedMail.goToLogin"))}}let ot=(()=>{class i{constructor(a,u,p,E){this._coreConfigService=a,this._service=u,this._activateRouter=p,this._router=E,this.display=!1,this._unsubscribeAll=new d.xQ,this._coreConfigService.config={layout:{navbar:{hidden:!0},menu:{hidden:!0},footer:{hidden:!0},customizer:!1,enableLocalStorage:!1}}}ngOnInit(){this._coreConfigService.config.pipe((0,b.R)(this._unsubscribeAll)).subscribe(a=>{this.coreConfig=a}),this._service.callGetMethod("/api/checkIfMailVerified",this._activateRouter.snapshot.params.email).pipe((0,b.R)(this._unsubscribeAll)).subscribe(a=>{this.display=!0,!a&&this._router.navigate(["/miscellaneous/something-happened"])},a=>{this._router.navigate(["/miscellaneous/something-happened"])})}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(_.R),r.Y36(B.f),r.Y36(R.gz),r.Y36(R.F0))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-verified-mail"]],decls:1,vars:1,consts:[["class","misc-wrapper",4,"ngIf"],[1,"misc-wrapper"],["href","javascript:void(0);",1,"brand-logo","d-flex","p-2"],["alt","brand-logo","height","28",3,"src"],[1,"brand-text","text-primary","ml-1"],[1,"misc-inner","p-2","p-sm-3"],[1,"w-100","text-center"],[1,"mb-1"],[1,"mb-3"],["action","javascript:void(0)",1,"row","row-cols-md-auto","row","justify-content-center","align-items-center","m-0","mb-2","gx-3"],[1,"col-12","d-md-block","d-grid","ps-md-0","ps-auto"],["routerLink","/auth/login","type","submit",1,"btn","btn-primary","mb-1","btn-sm-block"],["src","../../../../assets/images/illustration/verified-mail.png","alt","Under maintenance page",1,"img-fluid"]],template:function(u,p){1&u&&r.YNc(0,Jt,19,11,"div",0),2&u&&r.Q6J("ngIf",p.display)},dependencies:[l.O5,R.rH,A._Y,A.JL,A.F,de.X$],styles:['.auth-wrapper{display:flex;flex-basis:100%;min-height:100vh;min-height:calc(var(--vh, 1vh) * 100);width:100%}.auth-wrapper .auth-inner{width:100%;position:relative}.auth-wrapper.auth-v1{align-items:center;justify-content:center;overflow:hidden}.auth-wrapper.auth-v1 .auth-inner:before{width:244px;height:243px;content:" ";position:absolute;top:-54px;left:-46px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPQAAADzCAMAAACG9Mt0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA9KADAAQAAAABAAAA8wAAAADhQHfUAAAAyVBMVEUAAAD///+AgP+AgP9mZv+AgNWAgP9tbf9gYP+AgP9xcf9mZv+AZuaAgP9dXf90dOhiYv92dv9mZu5mZv93d+53d/9paf94afCAcfFrXvJra/9mZvJzZvJzc/JoaP96b/Rqav91aupsYvV2bOt2bPVxaPZ7cfZqavZyau1waPd4aO9xafBxafh4afB1bfh4avFuZ/F2afJzZvJzZ/N0aPN0bvN3bPR0ae5yZ/R3be93bfR1au9zafBxbPVzavV0a/F0a/ZyafFwaPKZm3nTAAAAQ3RSTlMAAQIEBQYGBwgICQoKCgsLDQ0PDw8PERESExMUFBQWFxgYGhoaGxsdHSAgIiIiIyQlJygqLCwtLi8vLzAzNDU3Nzg7h9vbHgAAA9RJREFUeNrt3ftS2kAUx/Fc1gSyWsErtuJdRDQiiteolb7/QzUoTm07k4AzObuu3/MCez45yWbzT36eZ6b8erO1e1B97baadd+zocJWmg0HaXe/+uqmg2GWtkLT5Lle1m9LdhG2+1lvzuiUO1knEF81yFc1N+35m15kZOGodz1vyLx+v2Lseq/erxtZd/NuweCTtfiwaWLOD5FnsqI7+VnP3y8afnEs3Es/1+H1qvETwuq18B7e6VlwLup1ZM8kWWQBOsrmHL7GVtxvYRZYgQ4ywae61ffsqH5Lbq20bQm6ncp9P2ehJegwE/u+rl95ttSwLrVSc2ANetAU28dSa9Cp2E623bUG3d2VWmn/wBq0XCugQYMGLdVKoOJaoiuok1NdXSW1WAUfRPtRUllflaJf5ZE/O9pXVbZUPTov5c+IDqvtRwStdTgLutoxy6GnGfYb2o+1I2gd+1OiqzfLocvVE7TSDqG1mgodaqfQZbvZC9rXjqG1X45WzqFVKVpk0LLo4lGP0ZGD6KgMnTiITkrQgXYQrYNitHISrYrRsZPouBhdcxJdK0YnTqKTYrR2Eq1BgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRoh9DH59ag86ACoSYOL61B55EUQk1s3VqDzsNHhJpYe7QGncfMSHUxaliCHgcKSXVxeWQJehwdJdXF4dAS9DgkTKqLxuibFeiXODixNi7OrEC/BP+JtbE0WrYA/RrxKNfH2YUF6NegSbk+Gk87xtErN6EsWm88fzeMXpwE9EruLns/l42io4dJFLPo2/Po1w+D6IW7t9Bt2SPx3vOOMfS7eHVZtN54ulg2go56138Ct4XRunE2Ovsmjg46WeddUoUWr6WL0fCoIYgO2/2s91fstDZQjcPL0ePt5flpdXUwqW46uMrS1j95JNpQrW0dHp9UV/uT2m416/8HVGg3qzhpBjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KBBgwYNGjRo0KC/FDpx0pwUo2tOomvF6NhJdFyMVk6iVTE6cBIdeF9vJyvZx/I/AzuIjsrQvoNovwzt4FamSs0Ojrp80PmvoB0zh940pb7azf1yg7t0LIt978uppzbnalfucDW92ZndLPRmKweGPduYJ+zoM5/Dk+gD5NdvLhXXPp88qcUqmEH5G5JZRs6cuxwIAAAAAElFTkSuQmCC)}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:before{display:none}}.auth-wrapper.auth-v1 .auth-inner:after{width:272px;height:272px;content:" ";position:absolute;bottom:-55px;right:-75px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARAAAAEQCAMAAABP1NsnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABEKADAAQAAAABAAABEAAAAAAQWxS2AAAAwFBMVEUAAAD///+AgICAgP9VVaqqVf+qqv+AgL+AgP9mZsxmZv+ZZv+AgNWAgP9tbdttbf+Sbf+AYN+AgN+AgP9xceNmZv+AZuaAZv90dOh0dP9qav+AauqAav+AgP92dv9tbf+Abe2Abf93Zu53d+6AcO94afCAcfF5a+R5a/JzZuaAZvKAc/J5bed5bfOAaPN6b/R1auqAavR6ZvV6cPV2bOuAbPV7aPZ2be2AbfZ7au17avZ3Zu53b+57a+97a/d4aO9J6CoeAAAAQHRSTlMAAQICAwMDBAQFBQUGBgcHBwgICAkKCgoLCwwMDAwNDg4ODw8QERITExQUFBUVFhcYGBkZGhobHBwdHR4eHx8gJ5uMWwAAA/FJREFUeNrt2G1XEkEYxvHZNk2xHGzdbKFl0cTwgdSkCKzu7/+t4pw6sAjtjIueE/f8r3fMO35nZnbuy5gVGcvfzJe0rnTfGI+MggGJRUZnbpPIhJKt88nU53JnFULvyISY6KAv8vPj0vr2rYwiE2Z2B9J+uNYcyyQxwWZvaeGH3G4bMjsvI/kcwTC/V+7kLoahlITzQojP3ZFgsJCh7IJQzpX0QFj4uMiY18eDMZ9bZCF9OQahnK6cm/Y7js0sh/LF3Auv1PlQd3MxbdXYIQspV44EEEAAAWTNDAYYkKdJbNMsLzYueZbaZ2iM46RVbHBaiZ9Js+nHEdli42N9XuSen5hGp1CQTuOJQDRsD99N4gMSpYWapNH6IJo83CIeILZQFesEaber79NCWRoukOpNEnW0gXQqD81w6ACxhbrYde7VuFCYeA2QRCNIsgZISyNIqz6IyhPjOjNVIFYniK3dmKU6QdLaJUimEySrDZLrBMlrgxRKU7sxCw/EMe0CAggggADySJCqxixIkKpNEh6IozELD8RxjQACCCCAAPJIkKrGLEgQXqqAAEJjxrQLCCCAAEJjRmNGY8a0CwgggABCYwYIfQgggNCYMe0CAggggNCY0ZjRmDHtAgIIIIAAQmNGHwIIIDRmTLuAAAIIIDRmNGY0Zky7gAACCCCA0JjRhwACCI0Z0y4ggAACCI0ZjRmNGdMuIIAAAgggNGb0IYAAQmPGtAsIIIAAQmNGY0ZjxrQLCCCAAAIIjRl9CCCA0Jgx7QICCCCA0JjRmNGYMe0CAggggABCY0YfAgggNGZMu4AAAgggNGY0ZjRmTLuAAAIIIIDQmNGHAAIIjRnTLiCAAAIIjRmNGY0ZIEy7gAACCCA0ZvQhgABCY8a0CwgggABCY0ZjBgiNGdMuIIAAAgiN2f/Sh+Q6PfLaIJlOkKw2SKoTJK3dmFmdILb2tBvrBIlrg5iWRo+WqQ+SaARJ1gCJAzsxThCN16p1vNurGjNjoo42j07kAHFskoY2kEbl33U0ZgoPjXW+Rl0gkarnahqtDaJKxMPDDWIiNafGenh4gExvVhXfmk7Da6L1AVGxSby2h6MxK79Zk42ea1pJbJ48sU2zDezQ8iy1z6BBwoyjMQsvXp8YQAAhgADilRfyy+wf8WqZZUfGZihvgZiB3FybC+kCUU5XLkAo50C+gbBQdUzkAIVyejIAYfFTI1solHP2HgNCnHn5AYNy4jvpoVB6fVzL91cwzLJ9Lfd7S0jhehxO5H5/yePr1W6gHonI7fJ5ORSR/n6Q2yQanq763zuXU5LJZRKiyD/W9/pjkdPZz0/yJ8fqVyry+qQZDMjJKoDfy8bRVhHhQTwAAAAASUVORK5CYII=);z-index:-1}@media (max-width: 575.98px){.auth-wrapper.auth-v1 .auth-inner:after{display:none}}.auth-wrapper.auth-v2{align-items:flex-start}.auth-wrapper.auth-v2 .auth-inner{height:100vh;overflow-y:auto;height:calc(var(--vh, 1vh) * 100)}.auth-wrapper.auth-v2 .brand-logo{position:absolute;top:2rem;left:2rem;margin:0;z-index:1}.auth-wrapper.auth-v1 .auth-inner{max-width:400px}.auth-wrapper .brand-logo{display:flex;justify-content:center;margin:1rem 0 2rem}.auth-wrapper .brand-logo .brand-text{font-weight:600}.auth-wrapper .auth-footer-btn .btn{padding:.6rem!important}.auth-wrapper .auth-footer-btn .btn:not(:last-child){margin-right:1rem}@media (min-width: 1200px){.auth-wrapper.auth-v2 .auth-card{width:400px}}.auth-wrapper .auth-bg{background-color:#fff}.dark-layout .auth-wrapper .auth-bg{background-color:#283046}@media (max-height: 625px){.dark-layout .auth-wrapper .auth-inner{background-color:#283046}.auth-wrapper .auth-bg{padding-top:3rem}.auth-wrapper .auth-inner{background-color:#fff;padding-bottom:1rem}.auth-wrapper.auth-v2 .brand-logo{width:100%;display:flex;justify-content:unset;position:relative;left:0;padding-left:1.5rem}}.auth-help-icon{position:absolute;top:10px;right:10px}\n'],encapsulation:2})}return i})();var qt=m(8184),Vt=m(529),_e=m(2526),Wt=m(1216),Rt=m(9509);class it{static loggerCallback(g,a){switch(g){case _e.i.Error:return void console.error(a);case _e.i.Info:return void console.info(a);case _e.i.Verbose:return void console.debug(a);case _e.i.Warning:return void console.warn(a);default:return void console.log(a)}}constructor(g){let a;this.browserEnvironment=typeof window<"u",this.config=(0,Wt._7)(g,this.browserEnvironment);try{a=window[v.Ix.SessionStorage]}catch{}const u=a?.getItem(v.bg),p=a?.getItem(v.PK)?.toLowerCase(),E="true"===p||"false"!==p&&void 0,L={...this.config.system.loggerOptions},$=u&&Object.keys(_e.i).includes(u)?_e.i[u]:void 0;$&&(L.loggerCallback=it.loggerCallback,L.logLevel=$),void 0!==E&&(L.piiLoggingEnabled=E),this.logger=new _e.Y(L,Rt.u,Rt.i),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}let wt=(()=>{class i extends it{getModuleName(){return i.MODULE_NAME}getId(){return i.ID}initialize(){var a=this;return(0,I.Z)(function*(){return a.available=typeof window<"u",a.available})()}}return i.MODULE_NAME="",i.ID="StandardOperatingContext",i})();function at(){return(at=(0,I.Z)(function*(i){const g=new wt(i);return yield g.initialize(),(yield Promise.resolve().then(m.bind(m,2009))).StandardController.createController(g)})).apply(this,arguments)}var Xt=m(2009);class y{static createPublicClientApplication(g){return(0,I.Z)(function*(){const a=yield function $t(i){return at.apply(this,arguments)}(g);return new y(g,a)})()}constructor(g,a){if(a)this.controller=a;else{const u=new wt(g);this.controller=new Xt.StandardController(u)}}initialize(){var g=this;return(0,I.Z)(function*(){return g.controller.initialize()})()}acquireTokenPopup(g){var a=this;return(0,I.Z)(function*(){return a.controller.acquireTokenPopup(g)})()}acquireTokenRedirect(g){return this.controller.acquireTokenRedirect(g)}acquireTokenSilent(g){return this.controller.acquireTokenSilent(g)}acquireTokenByCode(g){return this.controller.acquireTokenByCode(g)}addEventCallback(g){return this.controller.addEventCallback(g)}removeEventCallback(g){return this.controller.removeEventCallback(g)}addPerformanceCallback(g){return this.controller.addPerformanceCallback(g)}removePerformanceCallback(g){return this.controller.removePerformanceCallback(g)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(g){return this.controller.getAccount(g)}getAccountByHomeId(g){return this.controller.getAccountByHomeId(g)}getAccountByLocalId(g){return this.controller.getAccountByLocalId(g)}getAccountByUsername(g){return this.controller.getAccountByUsername(g)}getAllAccounts(g){return this.controller.getAllAccounts(g)}handleRedirectPromise(g){return this.controller.handleRedirectPromise(g)}loginPopup(g){return this.controller.loginPopup(g)}loginRedirect(g){return this.controller.loginRedirect(g)}logout(g){return this.controller.logout(g)}logoutRedirect(g){return this.controller.logoutRedirect(g)}logoutPopup(g){return this.controller.logoutPopup(g)}ssoSilent(g){return this.controller.ssoSilent(g)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(g){this.controller.setLogger(g)}setActiveAccount(g){this.controller.setActiveAccount(g)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(g,a){return this.controller.initializeWrapperLibrary(g,a)}setNavigationClient(g){this.controller.setNavigationClient(g)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(g,a){var u=this;return(0,I.Z)(function*(){return u.controller.hydrateCache(g,a)})()}clearCache(g){return this.controller.clearCache(g)}}let e=(()=>{class i{constructor(a,u,p){this._activatedRouter=a,this._storageService=u,this._router=p}ngOnInit(){const a=this._activatedRouter.snapshot.params.token;a&&(this._storageService.setToken(a),window.open("dashboard/admin","_self"))}static#e=this.\u0275fac=function(u){return new(u||i)(r.Y36(R.gz),r.Y36(Q.V),r.Y36(R.F0))};static#t=this.\u0275cmp=r.Xpm({type:i,selectors:[["app-auth-user"]],decls:0,vars:0,template:function(u,p){}})}return i})();var t=m(1463);window.navigator.userAgent.indexOf("MSIE ")>-1||window.navigator.userAgent.indexOf("Trident/");const o=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:ze,data:{animation:"auth"}},{path:"signup",component:Pe,data:{animation:"auth"}},{path:"login/:lang",component:ze,data:{animation:"auth"}},{path:"signup/:lang",component:Pe,data:{animation:"auth"}},{path:"forgot-password",component:rt},{path:"reset-password/:email",component:yt},{path:"verified-mail/:email",component:ot},{path:"user-auth/:token",component:e}];function s(){return new y({auth:{clientId:C.N.MICROSOFT_CLIENT_ID,redirectUri:C.N.MICROSOFT_AUTH_URL}})}let c=(()=>{class i{static#e=this.\u0275fac=function(u){return new(u||i)};static#t=this.\u0275mod=r.oAB({type:i,bootstrap:[Be]});static#n=this.\u0275inj=r.cJS({providers:[ft.l,{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:x.PROVIDER_ID,provider:new x(C.N.GOOGLE_CLIENT_ID)}],onError:a=>{console.error(a)}}},{provide:Me,useFactory:s},Se],imports:[l.ez,R.Bz.forChild(o),U.IJ,A.u5,A.UX,N.$,de.aw.forChild({loader:{provide:de.Zw,useFactory:qt.g,deps:[Vt.eN]}}),F,t._,dt]})}return i})()},6555:(X,z,m)=>{m.d(z,{k:()=>l});class l{constructor(){this.cache=new Map}getItem(R){return this.cache.get(R)||null}setItem(R,U){this.cache.set(R,U)}removeItem(R){this.cache.delete(R)}getKeys(){const R=[];return this.cache.forEach((U,N)=>{R.push(N)}),R}containsKey(R){return this.cache.has(R)}clear(){this.cache.clear()}}},1216:(X,z,m)=>{m.d(z,{Is:()=>S,_7:()=>O});var l=m(9128),A=m(1763),R=m(6145),U=m(2526),N=m(1878),I=m(464),b=m(2224);const d={sendGetRequestAsync:()=>Promise.reject((0,I.zP)(b.M2)),sendPostRequestAsync:()=>Promise.reject((0,I.zP)(b.M2))};var C=m(905);class r{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class _{generateId(){return"callback-id"}startMeasurement(H,F){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:C.$L.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:H,startTimeMs:Date.now(),correlationId:F||""},measurement:new r}}startPerformanceMeasurement(){return new r}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var B=m(8061),Q=m(1288),G=m(8468);class T{navigateInternal(H,F){return T.defaultNavigateWindow(H,F)}navigateExternal(H,F){return T.defaultNavigateWindow(H,F)}static defaultNavigateWindow(H,F){return F.noHistory?window.location.replace(H):window.location.assign(H),new Promise(w=>{setTimeout(()=>{w(!0)},F.timeout)})}}var W=m(5861),h=m(9141),f=m(9238);class M{sendGetRequestAsync(H,F){var w=this;return(0,W.Z)(function*(){let D;try{D=yield fetch(H,{method:G.EC.GET,headers:w.getFetchHeaders(F)})}catch{throw window.navigator.onLine?(0,h.Z_)(f.C8):(0,h.Z_)(f.Mq)}try{return{headers:w.getHeaderDict(D.headers),body:yield D.json(),status:D.status}}catch{throw(0,h.Z_)(f.w6)}})()}sendPostRequestAsync(H,F){var w=this;return(0,W.Z)(function*(){const D=F&&F.body||l.gT.EMPTY_STRING;let Z;try{Z=yield fetch(H,{method:G.EC.POST,headers:w.getFetchHeaders(F),body:D})}catch{throw window.navigator.onLine?(0,h.Z_)(f.Dc):(0,h.Z_)(f.Mq)}try{return{headers:w.getHeaderDict(Z.headers),body:yield Z.json(),status:Z.status}}catch{throw(0,h.Z_)(f.w6)}})()}getFetchHeaders(H){const F=new Headers;if(!H||!H.headers)return F;const w=H.headers;return Object.keys(w).forEach(D=>{F.append(D,w[D])}),F}getHeaderDict(H){const F={};return H.forEach((w,D)=>{F[D]=w}),F}}const P=6e4,S=1e4,K=3e4,k=2e3;function O({auth:x,cache:H,system:F,telemetry:w},D){const Z={clientId:l.gT.EMPTY_STRING,authority:`${l.gT.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:l.gT.EMPTY_STRING,authorityMetadata:l.gT.EMPTY_STRING,redirectUri:l.gT.EMPTY_STRING,postLogoutRedirectUri:l.gT.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:A.A.AAD,OIDCOptions:{serverResponseType:l.rg.FRAGMENT,defaultScopes:[l.gT.OPENID_SCOPE,l.gT.PROFILE_SCOPE,l.gT.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:R.z.None,tenant:l.gT.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},j={cacheLocation:G.Ix.SessionStorage,temporaryCacheLocation:G.Ix.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!H||H.cacheLocation!==G.Ix.LocalStorage),claimsBasedCachingEnabled:!1},J={loggerCallback:()=>{},logLevel:U.i.Info,piiLoggingEnabled:!1},ne={...{...N.z,loggerOptions:J,networkClient:D?new M:d,navigationClient:new T,loadFrameTimeout:0,windowHashTimeout:F?.loadFrameTimeout||P,iframeHashTimeout:F?.loadFrameTimeout||S,navigateFrameWait:0,redirectNavigationTimeout:K,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:F?.nativeBrokerHandshakeTimeout||k,pollIntervalMilliseconds:G.qx.DEFAULT_POLL_INTERVAL_MS},...F,loggerOptions:F?.loggerOptions||J},re={application:{appName:l.gT.EMPTY_STRING,appVersion:l.gT.EMPTY_STRING},client:new _};if(x?.protocolMode!==A.A.OIDC&&x?.OIDCOptions&&new U.Y(ne.loggerOptions).warning(JSON.stringify((0,B.ei)(Q.qz))),x?.protocolMode&&x.protocolMode!==A.A.AAD&&ne?.allowNativeBroker)throw(0,B.ei)(Q.Ol);return{auth:{...Z,...x,OIDCOptions:{...Z.OIDCOptions,...x?.OIDCOptions}},cache:{...j,...H},system:ne,telemetry:{...re,...w}}}},2009:(X,z,m)=>{m.r(z),m.d(z,{StandardController:()=>Ze});var l=m(5861),A=m(3540),R=m(368),U=m(842),I=m(3886),b=m(464),d=m(9128),C=m(7247),r=m(8061),_=m(1763),B=m(6145),T=m(905);const W=(y,e,t,n,o)=>(...s)=>{t.trace(`Executing function ${e}`);const c=n?.startMeasurement(e,o);o&&n?.incrementFields({[e+"CallCount"]:1},o);try{const i=y(...s);return c?.end({success:!0}),t.trace(`Returning result from ${e}`),i}catch(i){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(i))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},i),i}},h=(y,e,t,n,o)=>(...s)=>{t.trace(`Executing function ${e}`);const c=n?.startMeasurement(e,o);return o&&n?.incrementFields({[e+"CallCount"]:1},o),n?.setPreQueueTime(e,o),y(...s).then(i=>(t.trace(`Returning result from ${e}`),c?.end({success:!0}),i)).catch(i=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(i))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},i),i})};let f=(()=>{class y{constructor(t,n,o,s){this.networkInterface=t,this.logger=n,this.performanceClient=o,this.correlationId=s}detectRegion(t,n){var o=this;return(0,l.Z)(function*(){o.performanceClient?.addQueueMeasurement(T.Ak.RegionDiscoveryDetectRegion,o.correlationId);let s=t;if(s)n.region_source=d.W.ENVIRONMENT_VARIABLE;else{const c=y.IMDS_OPTIONS;try{const i=yield h(o.getRegionFromIMDS.bind(o),T.Ak.RegionDiscoveryGetRegionFromIMDS,o.logger,o.performanceClient,o.correlationId)(d.gT.IMDS_VERSION,c);if(i.status===d.YY.httpSuccess&&(s=i.body,n.region_source=d.W.IMDS),i.status===d.YY.httpBadRequest){const g=yield h(o.getCurrentVersion.bind(o),T.Ak.RegionDiscoveryGetCurrentVersion,o.logger,o.performanceClient,o.correlationId)(c);if(!g)return n.region_source=d.W.FAILED_AUTO_DETECTION,null;const a=yield h(o.getRegionFromIMDS.bind(o),T.Ak.RegionDiscoveryGetRegionFromIMDS,o.logger,o.performanceClient,o.correlationId)(g,c);a.status===d.YY.httpSuccess&&(s=a.body,n.region_source=d.W.IMDS)}}catch{return n.region_source=d.W.FAILED_AUTO_DETECTION,null}}return s||(n.region_source=d.W.FAILED_AUTO_DETECTION),s||null})()}getRegionFromIMDS(t,n){var o=this;return(0,l.Z)(function*(){return o.performanceClient?.addQueueMeasurement(T.Ak.RegionDiscoveryGetRegionFromIMDS,o.correlationId),o.networkInterface.sendGetRequestAsync(`${d.gT.IMDS_ENDPOINT}?api-version=${t}&format=text`,n,d.gT.IMDS_TIMEOUT)})()}getCurrentVersion(t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.RegionDiscoveryGetCurrentVersion,n.correlationId);try{const o=yield n.networkInterface.sendGetRequestAsync(`${d.gT.IMDS_ENDPOINT}?format=json`,t);return o.status===d.YY.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?o.body["newest-versions"][0]:null}catch{return null}})()}}return y.IMDS_OPTIONS={headers:{Metadata:"true"}},y})();var M=m(4191),P=m(1783),S=m(2224),K=m(1288);class k{constructor(e,t,n,o,s,c,i,g){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=s,this.performanceClient=i,this.correlationId=c,this.managedIdentity=g||!1,this.regionDiscovery=new f(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(d.gT.CIAM_AUTH_URL))return U.a.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case d.gT.ADFS:return U.a.Adfs;case d.gT.DSTS:return U.a.Dsts}return U.a.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new I.G(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw(0,b.zP)(S.HO)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw(0,b.zP)(S.HO)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw(0,b.zP)(S.HO)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw(0,b.zP)(S.ig);return this.replacePath(this.metadata.end_session_endpoint)}throw(0,b.zP)(S.HO)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw(0,b.zP)(S.HO)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw(0,b.zP)(S.HO)}canReplaceTenant(e){return 1===e.PathSegments.length&&!k.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===U.a.Default&&this.protocolMode===_.A.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const o=new I.G(this.metadata.canonical_authority).getUrlComponents(),s=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((i,g)=>{let a=s[g];if(0===g&&this.canReplaceTenant(o)){const u=new I.G(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];a!==u&&(this.logger.verbose(`Replacing tenant domain name ${a} with id ${u}`),a=u)}i!==a&&(t=t.replace(`/${a}/`,`/${i}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===U.a.Adfs||this.protocolMode!==_.A.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){var e=this;return(0,l.Z)(function*(){e.performanceClient?.addQueueMeasurement(T.Ak.AuthorityResolveEndpointsAsync,e.correlationId);const t=e.getCurrentMetadataEntity(),n=yield h(e.updateCloudDiscoveryMetadata.bind(e),T.Ak.AuthorityUpdateCloudDiscoveryMetadata,e.logger,e.performanceClient,e.correlationId)(t);e.canonicalAuthority=e.canonicalAuthority.replace(e.hostnameAndPort,t.preferred_network);const o=yield h(e.updateEndpointMetadata.bind(e),T.Ak.AuthorityUpdateEndpointMetadata,e.logger,e.performanceClient,e.correlationId)(t);e.updateCachedMetadata(t,n,{source:o}),e.performanceClient?.addFields({cloudDiscoverySource:n,authorityEndpointSource:o},e.correlationId)})()}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:(0,P.Rw)(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==d.pQ.CACHE&&n?.source!==d.pQ.CACHE&&(e.expiresAt=(0,P.Rw)(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}updateEndpointMetadata(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.AuthorityUpdateEndpointMetadata,t.correlationId);const n=t.updateEndpointMetadataFromLocalSources(e);if(n){if(n.source===d.pQ.HARDCODED_VALUES&&t.authorityOptions.azureRegionConfiguration?.azureRegion&&n.metadata){const s=yield h(t.updateMetadataWithRegionalInformation.bind(t),T.Ak.AuthorityUpdateMetadataWithRegionalInformation,t.logger,t.performanceClient,t.correlationId)(n.metadata);(0,P.xc)(e,s,!1),e.canonical_authority=t.canonicalAuthority}return n.source}let o=yield h(t.getEndpointMetadataFromNetwork.bind(t),T.Ak.AuthorityGetEndpointMetadataFromNetwork,t.logger,t.performanceClient,t.correlationId)();if(o)return t.authorityOptions.azureRegionConfiguration?.azureRegion&&(o=yield h(t.updateMetadataWithRegionalInformation.bind(t),T.Ak.AuthorityUpdateMetadataWithRegionalInformation,t.logger,t.performanceClient,t.correlationId)(o)),(0,P.xc)(e,o,!0),d.pQ.NETWORK;throw(0,b.zP)(S.Ce,t.defaultOpenIdConfigurationEndpoint)})()}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),(0,P.xc)(e,t,!1),{source:d.pQ.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return(0,P.xc)(e,o,!1),{source:d.pQ.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=(0,P.k5)(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:d.pQ.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new I.G(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw(0,r.ei)(K.zx)}return null}getEndpointMetadataFromNetwork(){var e=this;return(0,l.Z)(function*(){e.performanceClient?.addQueueMeasurement(T.Ak.AuthorityGetEndpointMetadataFromNetwork,e.correlationId);const t={},n=e.defaultOpenIdConfigurationEndpoint;e.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{const o=yield e.networkInterface.sendGetRequestAsync(n,t);return function N(y){return y.hasOwnProperty("authorization_endpoint")&&y.hasOwnProperty("token_endpoint")&&y.hasOwnProperty("issuer")&&y.hasOwnProperty("jwks_uri")}(o.body)?o.body:(e.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return e.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}})()}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in C.Qh?C.Qh[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.AuthorityUpdateMetadataWithRegionalInformation,t.correlationId);const n=t.authorityOptions.azureRegionConfiguration?.azureRegion;if(n){if(n!==d.gT.AZURE_REGION_AUTO_DISCOVER_FLAG)return t.regionDiscoveryMetadata.region_outcome=d.ki.CONFIGURED_NO_AUTO_DETECTION,t.regionDiscoveryMetadata.region_used=n,k.replaceWithRegionalInformation(e,n);const o=yield h(t.regionDiscovery.detectRegion.bind(t.regionDiscovery),T.Ak.RegionDiscoveryDetectRegion,t.logger,t.performanceClient,t.correlationId)(t.authorityOptions.azureRegionConfiguration?.environmentRegion,t.regionDiscoveryMetadata);if(o)return t.regionDiscoveryMetadata.region_outcome=d.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL,t.regionDiscoveryMetadata.region_used=o,k.replaceWithRegionalInformation(e,o);t.regionDiscoveryMetadata.region_outcome=d.ki.AUTO_DETECTION_REQUESTED_FAILED}return e})()}updateCloudDiscoveryMetadata(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.AuthorityUpdateCloudDiscoveryMetadata,t.correlationId);const n=t.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const o=yield h(t.getCloudDiscoveryMetadataFromNetwork.bind(t),T.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,t.logger,t.performanceClient,t.correlationId)();if(o)return(0,P.Cd)(e,o,!0),d.pQ.NETWORK;throw(0,r.ei)(K.o_)})()}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||d.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||d.gT.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||d.gT.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),(0,P.Cd)(e,t,!1),d.pQ.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=(0,C.ix)(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),(0,P.Cd)(e,o,!1),d.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const n=(0,P.k5)(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),d.pQ.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===U.a.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),k.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=(0,C.eM)(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),(0,r.ei)(K.E)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),k.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){var e=this;return(0,l.Z)(function*(){e.performanceClient?.addQueueMeasurement(T.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,e.correlationId);const t=`${d.gT.AAD_INSTANCE_DISCOVERY_ENDPT}${e.canonicalAuthority}oauth2/v2.0/authorize`,n={};let o=null;try{const s=yield e.networkInterface.sendGetRequestAsync(t,n);let c,i;if(function Q(y){return y.hasOwnProperty("tenant_discovery_endpoint")&&y.hasOwnProperty("metadata")}(s.body))c=s.body,i=c.metadata,e.logger.verbosePii(`tenant_discovery_endpoint is: ${c.tenant_discovery_endpoint}`);else{if(!function G(y){return y.hasOwnProperty("error")&&y.hasOwnProperty("error_description")}(s.body))return e.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(e.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${s.status}`),c=s.body,c.error===d.gT.INVALID_INSTANCE)return e.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;e.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${c.error}`),e.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${c.error_description}`),e.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}e.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=(0,C.eM)(i,e.hostnameAndPort)}catch(s){return e.logger.error(s instanceof M.l4?`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${s.errorCode}\nError Description: ${s.errorMessage}`:`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${s.name}\nError Description: ${s.message}`),null}return o||(e.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),e.logger.verbose("Creating custom Authority for custom domain scenario."),o=k.createCloudDiscoveryMetadataFromHost(e.hostnameAndPort)),o})()}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&I.G.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;return t&&t.azureCloudInstance!==B.z.None&&(n=`${t.azureCloudInstance}/${t.tenant?t.tenant:d.gT.DEFAULT_COMMON_TENANT}/`),n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return d.gT.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw(0,b.zP)(S.HO)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return C.wn.has(e)}static isPublicCloudAuthority(e){return d.gT.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const o=new I.G(e);o.validateAsUri();const s=o.getUrlComponents();let c=`${t}.${s.HostNameAndPort}`;this.isPublicCloudAuthority(s.HostNameAndPort)&&(c=`${t}.${d.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const i=I.G.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:c}).urlString;return n?`${i}?${n}`:i}static replaceWithRegionalInformation(e,t){const n={...e};return n.authorization_endpoint=k.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=k.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=k.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const o=new I.G(e).getUrlComponents();return 0===o.PathSegments.length&&o.HostNameAndPort.endsWith(d.gT.CIAM_AUTH_URL)&&(t=`${t}${o.HostNameAndPort.split(".")[0]}${d.gT.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function x(y){return y.endsWith(d.gT.FORWARD_SLASH)?y:`${y}${d.gT.FORWARD_SLASH}`}k.reservedTenantDomains=new Set(["{tenant}","{tenantid}",d.Nb.COMMON,d.Nb.CONSUMERS,d.Nb.ORGANIZATIONS]);var F=m(1635),w=m(7712),D=m(1071),Z=m(5764),j=m(2007);class J{static setRequestState(e,t,n){const o=J.generateLibraryState(e,n);return t?`${o}${d.gT.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw(0,b.zP)(S.QL);const n={id:e.createNewGuid()};t&&(n.meta=t);const o=JSON.stringify(n);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw(0,b.zP)(S.QL);if(!t)throw(0,b.zP)(S.r8);try{const n=t.split(d.gT.RESOURCE_DELIM),o=n[0],s=n.length>1?n.slice(1).join(d.gT.RESOURCE_DELIM):d.gT.EMPTY_STRING,c=e.base64Decode(o),i=JSON.parse(c);return{userRequestState:s||d.gT.EMPTY_STRING,libraryState:i}}catch{throw(0,b.zP)(S.r8)}}}var ne=m(2103);class re{constructor(e,t,n,o,s){this.account=e||null,this.idToken=t||null,this.accessToken=n||null,this.refreshToken=o||null,this.appMetadata=s||null}}var ue=m(5183),Y=m(9141),v=m(8468),se=m(6290),we=m(9616);class ve{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==v.Ix.LocalStorage&&e!==v.Ix.SessionStorage||!window[e])throw(0,se.Z1)(we.m4)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}var ye=m(6555);function ce(y,e){if(!e)return null;try{return J.parseRequestState(y,e).libraryState.meta}catch{throw(0,b.zP)(S.r8)}}var ie=m(3830),he=m(3675),q=m(9238);class Oe extends Z.L{constructor(e,t,n,o,s,c){super(e,n,o,s),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=t,this.logger=o,this.internalStorage=new ye.k,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=c}setupBrowserStorage(e){switch(e){case v.Ix.LocalStorage:case v.Ix.SessionStorage:try{return new ve(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=v.Ix.MemoryStorage,new ye.k}setupTemporaryCacheStorage(e,t){switch(t){case v.Ix.LocalStorage:case v.Ix.SessionStorage:try{return new ve(e||v.Ix.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}default:return this.internalStorage}}migrateCacheEntries(){const t=`${d.gT.CACHE_PREFIX}.${d.Vi.CLIENT_INFO}`,n=`${d.gT.CACHE_PREFIX}.${d.Vi.ERROR}`,o=`${d.gT.CACHE_PREFIX}.${d.Vi.ERROR_DESC}`,a=[this.browserStorage.getItem(`${d.gT.CACHE_PREFIX}.${d.Vi.ID_TOKEN}`),this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[d.Vi.ID_TOKEN,d.Vi.CLIENT_INFO,d.Vi.ERROR,d.Vi.ERROR_DESC].forEach((p,E)=>{const L=a[E];L&&this.setTemporaryCache(p,L,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(v.Oq.ACCOUNT_KEYS),t=this.getItem(`${v.Oq.TOKEN_KEYS}.${this.clientId}`);e&&t?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){const s=this.getItem(o);if(s){const c=this.validateAndParseJson(s);if(c&&c.hasOwnProperty("credentialType"))switch(c.credentialType){case d.d3.ID_TOKEN:if(P.Bq(c)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);const g=this.updateCredentialCacheKey(o,c);return void this.addTokenKey(g,d.d3.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case d.d3.ACCESS_TOKEN:case d.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(P.Om(c)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);const g=this.updateCredentialCacheKey(o,c);return void this.addTokenKey(g,d.d3.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case d.d3.REFRESH_TOKEN:if(P.x4(c)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);const g=this.updateCredentialCacheKey(o,c);return void this.addTokenKey(g,d.d3.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`)}}}if(this.isAccountKey(o)){const s=this.getItem(o);if(s){const c=this.validateAndParseJson(s);c&&w.r.isAccountEntity(c)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}getCachedAccountEntity(e){const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const n=this.validateAndParseJson(t);return n&&w.r.isAccountEntity(n)?Z.L.toObject(new w.r,n):(this.removeAccountKeyFromMap(e),null)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(v.Oq.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(v.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(v.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e){var t=()=>super.removeAccount,n=this;return(0,l.Z)(function*(){t().call(n,e),n.removeAccountKeyFromMap(e)})()}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,d.d3.ID_TOKEN)}removeAccessToken(e){var t=()=>super.removeAccessToken,n=this;return(0,l.Z)(function*(){t().call(n,e),n.removeTokenKey(e,d.d3.ACCESS_TOKEN)})()}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,d.d3.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${v.Oq.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const n=this.getTokenKeys();switch(t){case d.d3.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case d.d3.ACCESS_TOKEN:-1===n.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case d.d3.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),(0,b.zP)(S.cy)}this.setItem(`${v.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const n=this.getTokenKeys();switch(t){case d.d3.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const o=n.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case d.d3.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const s=n.accessToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case d.d3.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const c=n.refreshToken.indexOf(e);c>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(c,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),(0,b.zP)(S.cy)}this.setItem(`${v.Oq.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.ID_TOKEN),null;const n=this.validateAndParseJson(t);return n&&P.Bq(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.ID_TOKEN),null)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=P.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,d.d3.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.ACCESS_TOKEN),null;const n=this.validateAndParseJson(t);return n&&P.Om(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.ACCESS_TOKEN),null)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=P.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,d.d3.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.REFRESH_TOKEN),null;const n=this.validateAndParseJson(t);return n&&P.x4(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,d.d3.REFRESH_TOKEN),null)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=P.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,d.d3.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&P.ZL(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=P.Ox(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&P.Js(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&P.FK(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(v.Bs.WRAPPER_SKU,e),this.internalStorage.setItem(v.Bs.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(v.Bs.WRAPPER_SKU)||d.gT.EMPTY_STRING,this.internalStorage.getItem(v.Bs.WRAPPER_VER)||d.gT.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(d.Vi.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const o=this.generateCacheKey(d.Vi.ACTIVE_ACCOUNT),s=this.getItem(o);if(!s)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const c=this.getAccountInfoFilteredBy({localAccountId:s});return c?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(c),c):null}const n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(d.Vi.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(d.Vi.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,JSON.stringify({homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId})),this.browserStorage.setItem(n,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n))}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&P.VQ(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const s=this.getItemCookie(n);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),s}const o=this.temporaryCacheStorage.getItem(n);if(!o){if(this.cacheConfig.cacheLocation===v.Ix.LocalStorage){const s=this.browserStorage.getItem(n);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),s}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,t,n){const o=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}clear(){var e=this;return(0,l.Z)(function*(){yield e.removeAllAccounts(),e.removeAppMetadata(),e.temporaryCacheStorage.getKeys().forEach(t=>{(-1!==t.indexOf(d.gT.CACHE_PREFIX)||-1!==t.indexOf(e.clientId))&&e.removeTemporaryItem(t)}),e.browserStorage.getKeys().forEach(t=>{(-1!==t.indexOf(d.gT.CACHE_PREFIX)||-1!==t.indexOf(e.clientId))&&e.browserStorage.removeItem(t)}),e.internalStorage.clear()})()}clearTokensAndKeysWithClaims(e){var t=this;return(0,l.Z)(function*(){e.addQueueMeasurement(T.Ak.ClearTokensAndKeysWithClaims);const n=t.getTokenKeys(),o=[];n.accessToken.forEach(s=>{const c=t.getAccessTokenCredential(s);c?.requestedClaimsHash&&s.includes(c.requestedClaimsHash.toLowerCase())&&o.push(t.removeAccessToken(s))}),yield Promise.all(o),o.length>0&&t.logger.warning(`${o.length} access tokens with claims in the cache keys have been removed from the cache.`)})()}setItemCookie(e,t,n){let o=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;n&&(o+=`expires=${this.getCookieExpirationTime(n)};`),this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o}getItemCookie(e){const t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let o=0;o<n.length;o++){let s=n[o];for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(t))return decodeURIComponent(s.substring(t.length,s.length))}return d.gT.EMPTY_STRING}clearMsalCookies(){const e=`${d.gT.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(n=>{for(;" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(e)){const o=n.split("=")[0];this.clearItemCookie(o)}})}clearItemCookie(e){this.setItemCookie(e,d.gT.EMPTY_STRING,-1)}getCookieExpirationTime(e){return new Date((new Date).getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):j.x.startsWith(e,d.gT.CACHE_PREFIX)||j.x.startsWith(e,d.Vi.ADAL_ID_TOKEN)?e:`${d.gT.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=J.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${v.c4.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=J.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${v.c4.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=J.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${v.c4.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const o=this.generateAuthorityKey(n);return this.getTemporaryCache(o)}updateCacheEntries(e,t,n,o,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const c=this.generateStateKey(e);this.setTemporaryCache(c,e,!1);const i=this.generateNonceKey(e);this.setTemporaryCache(i,t,!1);const g=this.generateAuthorityKey(e);this.setTemporaryCache(g,n,!1),s?this.setTemporaryCache(v.c4.CCS_CREDENTIAL,JSON.stringify({credential:s.homeAccountId,type:"home_account_id"}),!0):o&&this.setTemporaryCache(v.c4.CCS_CREDENTIAL,JSON.stringify({credential:o,type:"UPN"}),!0)}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(v.c4.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(v.c4.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(v.c4.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(v.c4.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(v.c4.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(v.c4.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||d.gT.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(-1===t.indexOf(v.c4.REQUEST_STATE))return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const o=ce(this.cryptoImpl,n);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=(0,he.h$)(JSON.stringify(e));this.setTemporaryCache(v.c4.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(v.c4.REQUEST_PARAMS,!0);if(!t)throw(0,Y.Z_)(q.QO);let n;try{n=JSON.parse((0,ie.t)(t))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),(0,Y.Z_)(q.e$)}if(this.removeTemporaryItem(this.generateCacheKey(v.c4.REQUEST_PARAMS)),!n.authority){const o=this.generateAuthorityKey(e),s=this.getTemporaryCache(o);if(!s)throw(0,Y.Z_)(q.dT);n.authority=s}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(v.c4.NATIVE_REQUEST,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){return this.getTemporaryCache(`${d.gT.CACHE_PREFIX}.${v.c4.INTERACTION_STATUS_KEY}`,!1)}setInteractionInProgress(e){const t=`${d.gT.CACHE_PREFIX}.${v.c4.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw(0,Y.Z_)(q.Ck);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(d.Vi.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(d.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(d.Vi.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(d.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const o=ne.Z_(n,ie.t);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const n=P.Mk(t);if(e!==n){const o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(n,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}hydrateCache(e,t){var n=this;return(0,l.Z)(function*(){const o=P.Md(e.account?.homeAccountId,e.account?.environment,e.idToken,n.clientId,e.tenantId);let s;t.claims&&(s=yield n.cryptoImpl.hashString(t.claims));const c=P.Ds(e.account?.homeAccountId,e.account.environment,e.accessToken,n.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?.getTime()||0,e.extExpiresOn?.getTime()||0,ie.t,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),i=new re(void 0,o,c);return n.saveCacheRecord(i)})()}saveCacheRecord(e,t,n){var o=()=>super.saveCacheRecord,s=this;return(0,l.Z)(function*(){try{yield o().call(s,e,t,n)}catch(c){if(c instanceof ue.ju&&s.performanceClient&&n)try{const i=s.getTokenKeys();s.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},n)}catch{}throw c}})()}}var oe=m(6644),V=m(6521),Me=m(2573),Te=m(1641);class pe{static generateThrottlingStorageKey(e){return`${d.bb.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){const n=pe.generateThrottlingStorageKey(t),o=e.getThrottlingCache(n);if(o){if(o.throttleTime<Date.now())return void e.removeItem(n);throw new Te.n(o.errorCodes?.join(" ")||d.gT.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n){if(pe.checkResponseStatus(n)||pe.checkResponseForRetryAfter(n)){const o={throttleTime:pe.calculateThrottleTime(parseInt(n.headers[d.SZ.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(pe.generateThrottlingStorageKey(t),o)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(d.SZ.RETRY_AFTER)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||d.bb.DEFAULT_THROTTLE_TIME_SECONDS),n+d.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,n,o){const c=this.generateThrottlingStorageKey({clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:o,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid});e.removeItem(c)}}var He=m(1878);class Se{constructor(e,t){this.networkClient=e,this.cacheManager=t}sendPostRequest(e,t,n){var o=this;return(0,l.Z)(function*(){let s;pe.preProcess(o.cacheManager,e);try{s=yield o.networkClient.sendPostRequestAsync(t,n)}catch(c){throw c instanceof M.l4?c:(0,b.zP)(S.EF)}return pe.postProcess(o.cacheManager,e,s),s})()}}var ct=m(2526),lt=m(8144),ke=m(9947),Be=m(1267);function dt(y,e,t,n,o,s,c){return ut.apply(this,arguments)}function ut(){return(ut=(0,l.Z)(function*(y,e,t,n,o,s,c){c?.addQueueMeasurement(T.Ak.AuthorityFactoryCreateDiscoveredInstance,s);const i=k.transformCIAMAuthority(x(y)),g=new k(i,e,t,n,o,s,c);try{return yield h(g.resolveEndpointsAsync.bind(g),T.Ak.AuthorityResolveEndpointsAsync,o,c,s)(),g}catch{throw(0,b.zP)(S.HO)}})).apply(this,arguments)}class de{constructor(e,t){this.config=(0,He.j6)(e),this.logger=new ct.Y(this.config.loggerOptions,lt.u,lt.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Se(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[d.SZ.CONTENT_TYPE]=d.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case"home_account_id":try{const n=(0,ke.j)(e.credential);t[d.SZ.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case"UPN":t[d.SZ.CCS_HEADER]=`UPN: ${e.credential}`}return t}executePostToTokenEndpoint(e,t,n,o,s,c){var i=this;return(0,l.Z)(function*(){c&&i.performanceClient?.addQueueMeasurement(c,s);const g=yield i.networkManager.sendPostRequest(o,e,{body:t,headers:n});return i.performanceClient?.addFields({refreshTokenSize:g.body.refresh_token?.length||0,httpVerToken:g.headers?.[d.SZ.X_MS_HTTP_VERSION]||""},s),i.config.serverTelemetryManager&&g.status<500&&429!==g.status&&i.config.serverTelemetryManager.clearTelemetryCache(),g})()}updateAuthority(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.UpdateTokenEndpointAuthority,t);const o=`https://${e}/${n.authority.tenant}/`,s=yield dt(o,n.networkClient,n.cacheManager,n.authority.options,n.logger,t,n.performanceClient);n.authority=s})()}createTokenQueryParameters(e){const t=new Be.H;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}var me=m(9883),le=m(4226),fe=m(1530);class Ne{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}generateCnf(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.PopTokenGenerateCnf,e.correlationId);const o=yield h(n.generateKid.bind(n),T.Ak.PopTokenGenerateCnf,t,n.performanceClient,e.correlationId)(e),s=n.cryptoUtils.base64Encode(JSON.stringify(o));return{kid:o.kid,reqCnfString:s,reqCnfHash:yield n.cryptoUtils.hashString(s)}})()}generateKid(e){var t=this;return(0,l.Z)(function*(){return t.performanceClient?.addQueueMeasurement(T.Ak.PopTokenGenerateKid,e.correlationId),{kid:yield t.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}})()}signPopToken(e,t,n){var o=this;return(0,l.Z)(function*(){return o.signPayload(e,t,n)})()}signPayload(e,t,n,o){var s=this;return(0,l.Z)(function*(){const{resourceRequestMethod:c,resourceRequestUri:i,shrClaims:g,shrNonce:a,shrOptions:u}=n,E=(i?new I.G(i):void 0)?.getUrlComponents();return s.cryptoUtils.signJwt({at:e,ts:(0,fe.HY)(),m:c?.toUpperCase(),u:E?.HostNameAndPort,nonce:a||s.cryptoUtils.createNewGuid(),p:E?.AbsolutePath,q:E?.QueryString?[[],E.QueryString]:void 0,client_claims:g||void 0,...o},t,u,n.correlationId)})()}}class bt{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}var Ge=m(4918),Ve=m(2888);class be{constructor(e,t,n,o,s,c,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=s,this.persistencePlugin=c,this.performanceClient=i}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw(0,b.zP)(S.LV,e.state?"Cached State":"Server State");let n,o;try{n=decodeURIComponent(e.state)}catch{throw(0,b.zP)(S.r8,e.state)}try{o=decodeURIComponent(t)}catch{throw(0,b.zP)(S.r8,e.state)}if(n!==o)throw(0,b.zP)(S.Tu);if(e.error||e.error_description||e.suberror){const s=function Pt(y){const e="code=",t=y.error_uri?.lastIndexOf(e);return t&&t>=0?y.error_uri?.substring(t+e.length):void 0}(e);throw(0,F.Cf)(e.error,e.error_description,e.suberror)?new F.Yo(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",s):new Te.n(e.error||"",e.error_description,e.suberror,s)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const o=e.error_codes?.length?e.error_codes[0]:void 0,s=new Te.n(e.error,`${e.error_codes} - [${e.timestamp}]: ${e.error_description} - Correlation ID: ${e.correlation_id} - Trace ID: ${e.trace_id}`,e.suberror,o);if(t&&e.status&&e.status>=d.oj.SERVER_ERROR_RANGE_START&&e.status<=d.oj.SERVER_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${s}`);if(t&&e.status&&e.status>=d.oj.CLIENT_ERROR_RANGE_START&&e.status<=d.oj.CLIENT_ERROR_RANGE_END)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${s}`);throw(0,F.Cf)(e.error,e.error_description,e.suberror)?new F.Yo(e.error,e.error_description,e.suberror,e.timestamp||d.gT.EMPTY_STRING,e.trace_id||d.gT.EMPTY_STRING,e.correlation_id||d.gT.EMPTY_STRING,e.claims||d.gT.EMPTY_STRING,o):s}}handleServerTokenResponse(e,t,n,o,s,c,i,g,a){var u=this;return(0,l.Z)(function*(){let p,E;if(u.performanceClient?.addQueueMeasurement(T.Ak.HandleServerTokenResponse,e.correlation_id),e.id_token){if(p=(0,ne.Z_)(e.id_token||d.gT.EMPTY_STRING,u.cryptoObj.base64Decode),s&&s.nonce&&p.nonce!==s.nonce)throw(0,b.zP)(S.vR);if(o.maxAge||0===o.maxAge){const ee=p.auth_time;if(!ee)throw(0,b.zP)(S.w7);(0,ne.ky)(ee,o.maxAge)}}u.homeAccountIdentifier=w.r.generateHomeAccountId(e.client_info||d.gT.EMPTY_STRING,t.authorityType,u.logger,u.cryptoObj,p),s&&s.state&&(E=J.parseRequestState(u.cryptoObj,s.state)),e.key_id=e.key_id||o.sshKid||void 0;const L=u.generateCacheRecord(e,t,n,o,p,c,s);let $;try{if(u.persistencePlugin&&u.serializableCache&&(u.logger.verbose("Persistence enabled, calling beforeCacheAccess"),$=new bt(u.serializableCache,!0),yield u.persistencePlugin.beforeCacheAccess($)),i&&!g&&L.account){const ee=L.account.generateAccountKey();if(!u.cacheStorage.getAccount(ee,u.logger))return u.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield be.generateAuthenticationResult(u.cryptoObj,t,L,!1,o,p,E,void 0,a)}yield u.cacheStorage.saveCacheRecord(L,o.storeInCache,o.correlationId)}finally{u.persistencePlugin&&u.serializableCache&&$&&(u.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield u.persistencePlugin.afterCacheAccess($))}return be.generateAuthenticationResult(u.cryptoObj,t,L,!1,o,p,E,e,a)})()}generateCacheRecord(e,t,n,o,s,c,i){const g=t.getPreferredCache();if(!g)throw(0,b.zP)(S.Q9);const a=(0,Ge.M)(s);let u,p;e.id_token&&s&&(u=(0,P.Md)(this.homeAccountIdentifier,g,e.id_token,this.clientId,a||""),p=We(this.cacheStorage,t,this.homeAccountIdentifier,s,this.cryptoObj.base64Decode,e.client_info,g,a,i,void 0,this.logger));let E=null;if(e.access_token){const ee=e.scope?le.i.fromString(e.scope):new le.i(o.scopes||[]),ae=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,ge=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,Re=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,Ke=n+ae,st=Ke+ge,St=Re&&Re>0?n+Re:void 0;E=(0,P.Ds)(this.homeAccountIdentifier,g,e.access_token,this.clientId,a||t.tenant||"",ee.printScopes(),Ke,st,this.cryptoObj.base64Decode,St,e.token_type,c,e.key_id,o.claims,o.requestedClaimsHash)}let L=null;if(e.refresh_token){let ee;e.refresh_token_expires_in&&(ee=n+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),L=(0,P.OJ)(this.homeAccountIdentifier,g,e.refresh_token,this.clientId,e.foci,c,ee)}let $=null;return e.foci&&($={clientId:this.clientId,environment:g,familyId:e.foci}),new re(p,u,E,L,$)}static generateAuthenticationResult(e,t,n,o,s,c,i,g,a){return(0,l.Z)(function*(){let L,$,u=d.gT.EMPTY_STRING,p=[],E=null,ee=d.gT.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===d.hO.POP){const Ke=new Ne(e),{secret:st,keyId:St}=n.accessToken;if(!St)throw(0,b.zP)(S.Of);u=yield Ke.signPopToken(st,St,s)}else u=n.accessToken.secret;p=le.i.fromString(n.accessToken.target).asArray(),E=new Date(1e3*Number(n.accessToken.expiresOn)),L=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),n.accessToken.refreshOn&&($=new Date(1e3*Number(n.accessToken.refreshOn)))}n.appMetadata&&(ee=n.appMetadata.familyId===d.ch?d.ch:"");const ae=c?.oid||c?.sub||"",ge=c?.tid||"";g?.spa_accountid&&n.account&&(n.account.nativeAccountId=g?.spa_accountid);const Re=n.account?(0,Ve.$f)(n.account.getAccountInfo(),void 0,c,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:ae,tenantId:ge,scopes:p,account:Re,idToken:n?.idToken?.secret||"",idTokenClaims:c||{},accessToken:u,fromCache:o,expiresOn:E,extExpiresOn:L,refreshOn:$,correlationId:s.correlationId,requestId:a||d.gT.EMPTY_STRING,familyId:ee,tokenType:n.accessToken?.tokenType||d.gT.EMPTY_STRING,state:i?i.userRequestState:d.gT.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||d.gT.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||d.gT.EMPTY_STRING,code:g?.spa_code,fromNativeBroker:!1}})()}}function We(y,e,t,n,o,s,c,i,g,a,u){u?.verbose("setCachedAccount called");const E=y.getAccountKeys().find(ae=>ae.startsWith(t));let L=null;E&&(L=y.getAccount(E,u));const $=L||w.r.createAccount({homeAccountId:t,idTokenClaims:n,clientInfo:s,environment:c,cloudGraphHostName:g?.cloud_graph_host_name,msGraphHost:g?.msgraph_host,nativeAccountId:a},e,o),ee=$.tenantProfiles||[];if(i&&!ee.find(ae=>ae.tenantId===i)){const ae=(0,Ve.SI)(t,n);ee.push(ae)}return $.tenantProfiles=ee,$}var Ot=m(6680);function ht(y,e,t){return $e.apply(this,arguments)}function $e(){return($e=(0,l.Z)(function*(y,e,t){return"string"==typeof y?y:y({clientId:e,tokenEndpoint:t})})).apply(this,arguments)}class gt extends de{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.GetAuthCodeUrl,e.correlationId);const n=yield h(t.createAuthCodeUrlQueryString.bind(t),T.Ak.AuthClientCreateQueryString,t.logger,t.performanceClient,e.correlationId)(e);return I.G.appendQueryString(t.authority.authorizationEndpoint,n)})()}acquireToken(e,t){var n=this;return(0,l.Z)(function*(){if(n.performanceClient?.addQueueMeasurement(T.Ak.AuthClientAcquireToken,e.correlationId),!e.code)throw(0,b.zP)(S.FU);const o=(0,fe.HY)(),s=yield h(n.executeTokenRequest.bind(n),T.Ak.AuthClientExecuteTokenRequest,n.logger,n.performanceClient,e.correlationId)(n.authority,e),c=s.headers?.[d.SZ.X_MS_REQUEST_ID],i=new be(n.config.authOptions.clientId,n.cacheManager,n.cryptoUtils,n.logger,n.config.serializableCache,n.config.persistencePlugin,n.performanceClient);return i.validateTokenResponse(s.body),h(i.handleServerTokenResponse.bind(i),T.Ak.HandleServerTokenResponse,n.logger,n.performanceClient,e.correlationId)(s.body,n.authority,o,e,t,void 0,void 0,void 0,c)})()}handleFragmentResponse(e,t){if(new be(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw(0,b.zP)(S.Zv);return e}getLogoutUri(e){if(!e)throw(0,r.ei)(K.$h);const t=this.createLogoutUrlQueryString(e);return I.G.appendQueryString(this.authority.endSessionEndpoint,t)}executeTokenRequest(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.AuthClientExecuteTokenRequest,t.correlationId);const o=n.createTokenQueryParameters(t),s=I.G.appendQueryString(e.tokenEndpoint,o),c=yield h(n.createTokenRequestBody.bind(n),T.Ak.AuthClientCreateTokenRequestBody,n.logger,n.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const u=(0,ke.B)(t.clientInfo,n.cryptoUtils.base64Decode);i={credential:`${u.uid}${d.Bv.CLIENT_INFO_SEPARATOR}${u.utid}`,type:"home_account_id"}}catch(u){n.logger.verbose("Could not parse client info for CCS Header: "+u)}const g=n.createTokenRequestHeaders(i||t.ccsCredential),a={clientId:t.tokenBodyParameters?.clientId||n.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return h(n.executePostToTokenEndpoint.bind(n),T.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint,n.logger,n.performanceClient,t.correlationId)(s,c,g,a,t.correlationId,T.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint)})()}createTokenRequestBody(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.AuthClientCreateTokenRequestBody,e.correlationId);const n=new Be.H;if(n.addClientId(e.tokenBodyParameters?.[me.Cx]||t.config.authOptions.clientId),t.includeRedirectUri?n.addRedirectUri(e.redirectUri):Ot.D.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,t.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(t.config.libraryInfo),n.addApplicationTelemetry(t.config.telemetry.application),n.addThrottling(),t.serverTelemetryManager&&!(0,He.lh)(t.config)&&n.addServerTelemetry(t.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),t.config.clientCredentials.clientSecret&&n.addClientSecret(t.config.clientCredentials.clientSecret),t.config.clientCredentials.clientAssertion){const c=t.config.clientCredentials.clientAssertion;n.addClientAssertion(yield ht(c.assertion,t.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(c.assertionType)}if(n.addGrantType(d.qJ.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===d.hO.POP){const c=new Ne(t.cryptoUtils,t.performanceClient),i=yield h(c.generateCnf.bind(c),T.Ak.PopTokenGenerateCnf,t.logger,t.performanceClient,e.correlationId)(e,t.logger);n.addPopToken(i.reqCnfString)}else if(e.authenticationScheme===d.hO.SSH){if(!e.sshJwk)throw(0,r.ei)(K.dK);n.addSshJwk(e.sshJwk)}const o=e.correlationId||t.config.cryptoInterface.createNewGuid();let s;if(n.addCorrelationId(o),(!j.x.isEmptyObj(e.claims)||t.config.authOptions.clientCapabilities&&t.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,t.config.authOptions.clientCapabilities),e.clientInfo)try{const c=(0,ke.B)(e.clientInfo,t.cryptoUtils.base64Decode);s={credential:`${c.uid}${d.Bv.CLIENT_INFO_SEPARATOR}${c.utid}`,type:"home_account_id"}}catch(c){t.logger.verbose("Could not parse client info for CCS Header: "+c)}else s=e.ccsCredential;if(t.config.systemOptions.preventCorsPreflight&&s)switch(s.type){case"home_account_id":try{const c=(0,ke.j)(s.credential);n.addCcsOid(c)}catch(c){t.logger.verbose("Could not parse home account ID for CCS Header: "+c)}break;case"UPN":n.addCcsUpn(s.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[me.Zb])&&n.addExtraQueryParameters({[me.Zb]:"1"}),n.createQueryString()})()}createAuthCodeUrlQueryString(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.AuthClientCreateQueryString,e.correlationId);const n=new Be.H;n.addClientId(e.extraQueryParameters?.[me.Cx]||t.config.authOptions.clientId);const o=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(o,!0,t.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);const s=e.correlationId||t.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(s),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(t.config.libraryInfo),(0,He.lh)(t.config)||n.addApplicationTelemetry(t.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==d.NJ.SELECT_ACCOUNT)if(e.sid&&e.prompt===d.NJ.NONE)t.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const c=t.extractAccountSid(e.account);let i=t.extractLoginHint(e.account);if(i&&e.domainHint&&(t.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),i=null),i){t.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(i);try{const g=(0,ke.j)(e.account.homeAccountId);n.addCcsOid(g)}catch{t.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(c&&e.prompt===d.NJ.NONE){t.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(c);try{const g=(0,ke.j)(e.account.homeAccountId);n.addCcsOid(g)}catch{t.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){t.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const g=(0,ke.j)(e.account.homeAccountId);n.addCcsOid(g)}catch{t.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else t.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||t.config.authOptions.clientCapabilities&&t.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,t.config.authOptions.clientCapabilities),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===d.hO.POP)){const c=new Ne(t.cryptoUtils),i=yield h(c.generateCnf.bind(c),T.Ak.PopTokenGenerateCnf,t.logger,t.performanceClient,e.correlationId)(e,t.logger);n.addPopToken(i.reqCnfHash)}return n.createQueryString()})()}createLogoutUrlQueryString(e){const t=new Be.H;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}class Fe{constructor(e,t){this.cacheOutcome=d.To.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||d.gT.EMPTY_STRING,this.wrapperVer=e.wrapperVer||d.gT.EMPTY_STRING,this.telemetryCacheKey=d.HN.CACHE_KEY+d.Bv.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${d.HN.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer].join(d.HN.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(d.HN.VALUE_SEPARATOR);return[d.HN.SCHEMA_VERSION,o,t].join(d.HN.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Fe.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(d.HN.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(d.HN.VALUE_SEPARATOR),s=e.errors.length,i=[s,t<s?d.HN.OVERFLOW_TRUE:d.HN.OVERFLOW_FALSE].join(d.HN.VALUE_SEPARATOR);return[d.HN.SCHEMA_VERSION,e.cacheHits,n,o,i].join(d.HN.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=d.HN.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?t.errors.push(e instanceof M.l4?e.subError?e.subError:e.errorCode?e.errorCode:e.toString():e.toString()):t.errors.push(d.HN.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Fe.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const o={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let t,n=0,o=0;const s=e.errors.length;for(t=0;t<s;t++){const i=e.failedRequests[2*t+1]||d.gT.EMPTY_STRING,g=e.errors[t]||d.gT.EMPTY_STRING;if(o+=(e.failedRequests[2*t]||d.gT.EMPTY_STRING).toString().length+i.toString().length+g.length+3,!(o<d.HN.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||d.gT.EMPTY_STRING),e.push(this.regionSource||d.gT.EMPTY_STRING),e.push(this.regionOutcome||d.gT.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}}var pt=m(9509),Ae=m(717);class mt{constructor(e,t,n,o,s,c,i,g,a){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=s,this.navigationClient=c,this.nativeMessageHandler=g,this.correlationId=a||(0,Ae.nn)(),this.logger=o.clone(v.qx.MSAL_SKU,pt.i,this.correlationId),this.performanceClient=i}clearCacheOnLogout(e){var t=this;return(0,l.Z)(function*(){if(e){w.r.accountInfoIsEqual(e,t.browserStorage.getActiveAccount(),!1)&&(t.logger.verbose("Setting active account to null"),t.browserStorage.setActiveAccount(null));try{yield t.browserStorage.removeAccount(w.r.generateAccountCacheKey(e)),t.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{t.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{t.logger.verbose("No account provided in logout request, clearing all cache items.",t.correlationId),yield t.browserStorage.clear(),yield t.browserCrypto.clearKeystore()}catch{t.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})()}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri||(0,oe.Re)();return I.G.getAbsoluteUrl(t,(0,oe.Re)())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Fe(n,this.browserStorage)}getDiscoveredAuthority(e,t,n){var o=this;return(0,l.Z)(function*(){o.performanceClient.addQueueMeasurement(T.Ak.StandardInteractionClientGetDiscoveredAuthority,o.correlationId);const s={protocolMode:o.config.auth.protocolMode,OIDCOptions:o.config.auth.OIDCOptions,knownAuthorities:o.config.auth.knownAuthorities,cloudDiscoveryMetadata:o.config.auth.cloudDiscoveryMetadata,authorityMetadata:o.config.auth.authorityMetadata,skipAuthorityMetadataCache:o.config.auth.skipAuthorityMetadataCache},i=k.generateAuthority(e||o.config.auth.authority,t||o.config.auth.azureCloudOptions),g=yield h(dt,T.Ak.AuthorityFactoryCreateDiscoveredInstance,o.logger,o.performanceClient,o.correlationId)(i,o.config.system.networkClient,o.browserStorage,s,o.logger,o.correlationId,o.performanceClient);if(n&&!g.isAlias(n.environment))throw(0,r.ei)(K.Hv);return g})()}}const Mt=32;function Nt(y,e,t){return ze.apply(this,arguments)}function ze(){return(ze=(0,l.Z)(function*(y,e,t){y.addQueueMeasurement(T.Ak.GeneratePkceCodes,t);const n=W(Le,T.Ak.GenerateCodeVerifier,e,y,t)(y,e,t);return{verifier:n,challenge:yield h(ft,T.Ak.GenerateCodeChallengeFromVerifier,e,y,t)(n,y,e,t)}})).apply(this,arguments)}function Le(y,e,t){try{const n=new Uint8Array(Mt);return W(Ae.PP,T.Ak.GetRandomValues,e,y,t)(n),(0,he.Wy)(n)}catch{throw(0,Y.Z_)(q.vD)}}function ft(y,e,t,n){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,l.Z)(function*(y,e,t,n){e.addQueueMeasurement(T.Ak.GenerateCodeChallengeFromVerifier,n);try{const o=yield h(Ae.Fv,T.Ak.Sha256Digest,t,e,n)(y,e,n);return(0,he.Wy)(new Uint8Array(o))}catch{throw(0,Y.Z_)(q.vD)}})).apply(this,arguments)}function et(y,e,t,n){return tt.apply(this,arguments)}function tt(){return(tt=(0,l.Z)(function*(y,e,t,n){t.addQueueMeasurement(T.Ak.InitializeBaseRequest,y.correlationId);const o=y.authority||e.auth.authority,s=[...y&&y.scopes||[]],c={...y,correlationId:y.correlationId,authority:o,scopes:s};if(c.authenticationScheme){if(c.authenticationScheme===d.hO.SSH){if(!y.sshJwk)throw(0,r.ei)(K.dK);if(!y.sshKid)throw(0,r.ei)(K.hI)}n.verbose(`Authentication Scheme set to "${c.authenticationScheme}" as configured in Auth request`)}else c.authenticationScheme=d.hO.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return e.cache.claimsBasedCachingEnabled&&y.claims&&!j.x.isEmptyObj(y.claims)&&(c.requestedClaimsHash=yield(0,Ae.Wu)(y.claims)),c})).apply(this,arguments)}function Lt(y,e,t,n,o){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,l.Z)(function*(y,e,t,n,o){n.addQueueMeasurement(T.Ak.InitializeSilentRequest,y.correlationId);const s=yield h(et,T.Ak.InitializeBaseRequest,o,n,y.correlationId)(y,t,n,o);return{...y,...s,account:e,forceRefresh:y.forceRefresh||!1}})).apply(this,arguments)}class xe extends mt{initializeAuthorizationCodeRequest(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId);const n=yield h(Nt,T.Ak.GeneratePkceCodes,t.logger,t.performanceClient,t.correlationId)(t.performanceClient,t.logger,t.correlationId),o={...e,redirectUri:e.redirectUri,code:d.gT.EMPTY_STRING,codeVerifier:n.verifier};return e.codeChallenge=n.challenge,e.codeChallengeMethod=d.gT.S256_CODE_CHALLENGE_METHOD,o})()}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||(0,Ae.nn)(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=I.G.getAbsoluteUrl(e.postLogoutRedirectUri,(0,oe.Re)())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=I.G.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,(0,oe.Re)())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=I.G.getAbsoluteUrl((0,oe.Re)(),(0,oe.Re)())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e,t,n,o){var s=this;return(0,l.Z)(function*(){s.performanceClient.addQueueMeasurement(T.Ak.StandardInteractionClientCreateAuthCodeClient,s.correlationId);const c=yield h(s.getClientConfiguration.bind(s),T.Ak.StandardInteractionClientGetClientConfiguration,s.logger,s.performanceClient,s.correlationId)(e,t,n,o);return new gt(c,s.performanceClient)})()}getClientConfiguration(e,t,n,o){var s=this;return(0,l.Z)(function*(){s.performanceClient.addQueueMeasurement(T.Ak.StandardInteractionClientGetClientConfiguration,s.correlationId);const c=yield h(s.getDiscoveredAuthority.bind(s),T.Ak.StandardInteractionClientGetDiscoveredAuthority,s.logger,s.performanceClient,s.correlationId)(t,n,o),i=s.config.system.loggerOptions;return{authOptions:{clientId:s.config.auth.clientId,authority:c,clientCapabilities:s.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:s.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:i.loggerCallback,piiLoggingEnabled:i.piiLoggingEnabled,logLevel:i.logLevel,correlationId:s.correlationId},cacheOptions:{claimsBasedCachingEnabled:s.config.cache.claimsBasedCachingEnabled},cryptoInterface:s.browserCrypto,networkInterface:s.networkClient,storageInterface:s.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:v.qx.MSAL_SKU,version:pt.i,cpu:d.gT.EMPTY_STRING,os:d.gT.EMPTY_STRING},telemetry:s.config.telemetry}})()}initializeAuthorizationRequest(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient.addQueueMeasurement(T.Ak.StandardInteractionClientInitializeAuthorizationRequest,n.correlationId);const o=n.getRedirectUri(e.redirectUri),c=J.setRequestState(n.browserCrypto,e&&e.state||d.gT.EMPTY_STRING,{interactionType:t}),g={...yield h(et,T.Ak.InitializeBaseRequest,n.logger,n.performanceClient,n.correlationId)({...e,correlationId:n.correlationId},n.config,n.performanceClient,n.logger),redirectUri:o,state:c,nonce:e.nonce||(0,Ae.nn)(),responseMode:n.config.auth.OIDCOptions.serverResponseType},a=e.account||n.browserStorage.getActiveAccount();if(a&&(n.logger.verbose("Setting validated request account",n.correlationId),n.logger.verbosePii(`Setting validated request account: ${a.homeAccountId}`,n.correlationId),g.account=a),!g.loginHint&&!a){const u=n.browserStorage.getLegacyLoginHint();u&&(g.loginHint=u)}return g})()}}var At=m(6345);const xt="ContentError",Ct="user_switch",Ut="USER_INTERACTION_REQUIRED",Bt="USER_CANCEL",Dt="NO_NETWORK",Zt="PERSISTENT_ERROR",Kt="DISABLED",Ht="ACCOUNT_UNAVAILABLE",vt=-2147186943,Tt={[Ct]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Ie extends M.l4{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,Ie.prototype),this.name="NativeAuthError",this.ext=n}}function Pe(y){return!!(y.ext&&y.ext.status&&(y.ext.status===Zt||y.ext.status===Kt)||y.ext&&y.ext.error&&y.ext.error===vt)||y.errorCode===xt}function Qe(y,e,t){if(t&&t.status)switch(t.status){case Ht:return(0,F.ip)(D.QP);case Ut:return new F.Yo(y,e);case Bt:return(0,Y.Z_)(q.h7);case Dt:return(0,Y.Z_)(q.Mq)}return new Ie(y,Tt[y]||e,t)}class je extends de{constructor(e,t){super(e,t)}acquireToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.RefreshTokenClientAcquireToken,e.correlationId);const n=(0,fe.HY)(),o=yield h(t.executeTokenRequest.bind(t),T.Ak.RefreshTokenClientExecuteTokenRequest,t.logger,t.performanceClient,e.correlationId)(e,t.authority),s=o.headers?.[d.SZ.X_MS_REQUEST_ID],c=new be(t.config.authOptions.clientId,t.cacheManager,t.cryptoUtils,t.logger,t.config.serializableCache,t.config.persistencePlugin);return c.validateTokenResponse(o.body),h(c.handleServerTokenResponse.bind(c),T.Ak.HandleServerTokenResponse,t.logger,t.performanceClient,e.correlationId)(o.body,t.authority,n,e,void 0,void 0,!0,e.forceCache,s)})()}acquireTokenByRefreshToken(e){var t=this;return(0,l.Z)(function*(){if(!e)throw(0,r.ei)(K.dL);if(t.performanceClient?.addQueueMeasurement(T.Ak.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw(0,b.zP)(S.D7);if(t.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield h(t.acquireTokenWithCachedRefreshToken.bind(t),T.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.logger,t.performanceClient,e.correlationId)(e,!0)}catch(o){if(o instanceof F.Yo&&o.errorCode===D.I2||o instanceof Te.n&&o.errorCode===d.D1.INVALID_GRANT_ERROR&&o.subError===d.D1.CLIENT_MISMATCH_ERROR)return h(t.acquireTokenWithCachedRefreshToken.bind(t),T.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.logger,t.performanceClient,e.correlationId)(e,!1);throw o}return h(t.acquireTokenWithCachedRefreshToken.bind(t),T.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.logger,t.performanceClient,e.correlationId)(e,!1)})()}acquireTokenWithCachedRefreshToken(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const o=W(n.cacheManager.getRefreshToken.bind(n.cacheManager),T.Ak.CacheManagerGetRefreshToken,n.logger,n.performanceClient,e.correlationId)(e.account,t,void 0,n.performanceClient,e.correlationId);if(!o)throw(0,F.ip)(D.I2);if(o.expiresOn&&(0,fe.pw)(o.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw(0,F.ip)(D.Tw);const s={...e,refreshToken:o.secret,authenticationScheme:e.authenticationScheme||d.hO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:"home_account_id"}};try{return yield h(n.acquireToken.bind(n),T.Ak.RefreshTokenClientAcquireToken,n.logger,n.performanceClient,e.correlationId)(s)}catch(c){if(c instanceof F.Yo&&c.subError===D.nl){n.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const i=(0,P.Mk)(o);n.cacheManager.removeRefreshToken(i)}throw c}})()}executeTokenRequest(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient?.addQueueMeasurement(T.Ak.RefreshTokenClientExecuteTokenRequest,e.correlationId);const o=n.createTokenQueryParameters(e),s=I.G.appendQueryString(t.tokenEndpoint,o),c=yield h(n.createTokenRequestBody.bind(n),T.Ak.RefreshTokenClientCreateTokenRequestBody,n.logger,n.performanceClient,e.correlationId)(e),i=n.createTokenRequestHeaders(e.ccsCredential),g={clientId:e.tokenBodyParameters?.clientId||n.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return h(n.executePostToTokenEndpoint.bind(n),T.Ak.RefreshTokenClientExecutePostToTokenEndpoint,n.logger,n.performanceClient,e.correlationId)(s,c,i,g,e.correlationId,T.Ak.RefreshTokenClientExecutePostToTokenEndpoint)})()}createTokenRequestBody(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const n=e.correlationId,o=new Be.H;if(o.addClientId(e.tokenBodyParameters?.[me.Cx]||t.config.authOptions.clientId),e.redirectUri&&o.addRedirectUri(e.redirectUri),o.addScopes(e.scopes,!0,t.config.authOptions.authority.options.OIDCOptions?.defaultScopes),o.addGrantType(d.qJ.REFRESH_TOKEN_GRANT),o.addClientInfo(),o.addLibraryInfo(t.config.libraryInfo),o.addApplicationTelemetry(t.config.telemetry.application),o.addThrottling(),t.serverTelemetryManager&&!(0,He.lh)(t.config)&&o.addServerTelemetry(t.serverTelemetryManager),o.addCorrelationId(n),o.addRefreshToken(e.refreshToken),t.config.clientCredentials.clientSecret&&o.addClientSecret(t.config.clientCredentials.clientSecret),t.config.clientCredentials.clientAssertion){const s=t.config.clientCredentials.clientAssertion;o.addClientAssertion(yield ht(s.assertion,t.config.authOptions.clientId,e.resourceRequestUri)),o.addClientAssertionType(s.assertionType)}if(e.authenticationScheme===d.hO.POP){const s=new Ne(t.cryptoUtils,t.performanceClient),c=yield h(s.generateCnf.bind(s),T.Ak.PopTokenGenerateCnf,t.logger,t.performanceClient,e.correlationId)(e,t.logger);o.addPopToken(c.reqCnfString)}else if(e.authenticationScheme===d.hO.SSH){if(!e.sshJwk)throw(0,r.ei)(K.dK);o.addSshJwk(e.sshJwk)}if((!j.x.isEmptyObj(e.claims)||t.config.authOptions.clientCapabilities&&t.config.authOptions.clientCapabilities.length>0)&&o.addClaims(e.claims,t.config.authOptions.clientCapabilities),t.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case"home_account_id":try{const s=(0,ke.j)(e.ccsCredential.credential);o.addCcsOid(s)}catch(s){t.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case"UPN":o.addCcsUpn(e.ccsCredential.credential)}return e.tokenBodyParameters&&o.addExtraQueryParameters(e.tokenBodyParameters),o.createQueryString()})()}}class Ft extends de{constructor(e,t){super(e,t)}acquireToken(e){var t=this;return(0,l.Z)(function*(){try{const[n,o]=yield t.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...d.f_]});return o===d.To.PROACTIVELY_REFRESHED&&(t.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new je(t.config,t.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),n}catch(n){if(n instanceof b.er&&n.errorCode===S.s$)return new je(t.config,t.performanceClient).acquireTokenByRefreshToken(e);throw n}})()}acquireCachedToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient?.addQueueMeasurement(T.Ak.SilentFlowClientAcquireCachedToken,e.correlationId);let n=d.To.NOT_APPLICABLE;if(e.forceRefresh||!t.config.cacheOptions.claimsBasedCachingEnabled&&!j.x.isEmptyObj(e.claims))throw t.setCacheOutcome(d.To.FORCE_REFRESH_OR_CLAIMS,e.correlationId),(0,b.zP)(S.s$);if(!e.account)throw(0,b.zP)(S.D7);const o=e.account.tenantId||function O(y){const n=new I.G(y).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case d.Nb.COMMON:case d.Nb.ORGANIZATIONS:case d.Nb.CONSUMERS:return;default:return n}}(e.authority),s=t.cacheManager.getTokenKeys(),c=t.cacheManager.getAccessToken(e.account,e,s,o,t.performanceClient,e.correlationId);if(!c)throw t.setCacheOutcome(d.To.NO_CACHED_ACCESS_TOKEN,e.correlationId),(0,b.zP)(S.s$);if((0,fe.jx)(c.cachedAt)||(0,fe.pw)(c.expiresOn,t.config.systemOptions.tokenRenewalOffsetSeconds))throw t.setCacheOutcome(d.To.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),(0,b.zP)(S.s$);c.refreshOn&&(0,fe.pw)(c.refreshOn,0)&&(n=d.To.PROACTIVELY_REFRESHED);const i=e.authority||t.authority.getPreferredCache(),g={account:t.cacheManager.readAccountFromCache(e.account),accessToken:c,idToken:t.cacheManager.getIdToken(e.account,s,o,t.performanceClient,e.correlationId),refreshToken:null,appMetadata:t.cacheManager.readAppMetadataFromCache(i)};return t.setCacheOutcome(n,e.correlationId),t.config.serverTelemetryManager&&t.config.serverTelemetryManager.incrementCacheHits(),[yield h(t.generateResultFromCacheRecord.bind(t),T.Ak.SilentFlowClientGenerateResultFromCacheRecord,t.logger,t.performanceClient,e.correlationId)(g,e),n]})()}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==d.To.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,t){var n=this;return(0,l.Z)(function*(){let o;if(n.performanceClient?.addQueueMeasurement(T.Ak.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(o=(0,ne.Z_)(e.idToken.secret,n.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const s=o?.auth_time;if(!s)throw(0,b.zP)(S.w7);(0,ne.ky)(s,t.maxAge)}return be.generateAuthenticationResult(n.cryptoUtils,n.authority,e,!0,t,o)})()}}class It extends xe{acquireToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.SilentCacheClientAcquireToken,e.correlationId);const n=t.initializeServerTelemetryManager(v.WN.acquireTokenSilent_silentFlow),o=yield h(t.getClientConfiguration.bind(t),T.Ak.StandardInteractionClientGetClientConfiguration,t.logger,t.performanceClient,t.correlationId)(n,e.authority,e.azureCloudOptions,e.account),s=new Ft(o,t.performanceClient);t.logger.verbose("Silent auth client created");try{const i=(yield h(s.acquireCachedToken.bind(s),T.Ak.SilentFlowClientAcquireCachedToken,t.logger,t.performanceClient,e.correlationId)(e))[0];return t.performanceClient.addFields({fromCache:!0},e.correlationId),i}catch(c){throw c instanceof Y.Ut&&c.errorCode===q.XM&&t.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),c}})()}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}class Ue extends mt{constructor(e,t,n,o,s,c,i,g,a,u,p,E){super(e,t,n,o,s,c,g,a,E),this.apiId=i,this.accountId=u,this.nativeMessageHandler=a,this.nativeStorageManager=p,this.silentCacheClient=new It(e,this.nativeStorageManager,n,o,s,c,g,a,E)}acquireToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.NativeInteractionClientAcquireToken,e.correlationId),t.logger.trace("NativeInteractionClient - acquireToken called.");const n=t.performanceClient.startMeasurement(T.Ak.NativeInteractionClientAcquireToken,e.correlationId),o=fe.HY(),s=yield t.initializeNativeRequest(e);try{const a=yield t.acquireTokensFromCache(t.accountId,s);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),a}catch{t.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const c={method:v.Ky.GetToken,request:s},i=yield t.nativeMessageHandler.sendMessage(c),g=t.validateNativeResponse(i);return t.handleNativeResponse(g,s,o).then(a=>(n.end({success:!0,isNativeBroker:!0,requestId:a.requestId}),a)).catch(a=>{throw n.end({success:!1,errorCode:a.errorCode,subErrorCode:a.subError,isNativeBroker:!0}),a})})()}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:le.i.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}acquireTokensFromCache(e,t){var n=this;return(0,l.Z)(function*(){if(!e)throw n.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),(0,b.zP)(S.cX);const o=n.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!o)throw(0,b.zP)(S.cX);try{const s=n.createSilentCacheRequest(t,o),c=yield n.silentCacheClient.acquireToken(s),i={...o,idTokenClaims:c?.idTokenClaims,idToken:c?.idToken};return{...c,account:i}}catch(s){throw s}})()}acquireTokenRedirect(e){var t=this;return(0,l.Z)(function*(){t.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=yield t.initializeNativeRequest(e),o={method:v.Ky.GetToken,request:n};try{const i=yield t.nativeMessageHandler.sendMessage(o);t.validateNativeResponse(i)}catch(i){if(i instanceof Ie&&Pe(i))throw i}t.browserStorage.setTemporaryCache(v.c4.NATIVE_REQUEST,JSON.stringify(n),!0);const s={apiId:v.WN.acquireTokenRedirect,timeout:t.config.system.redirectNavigationTimeout,noHistory:!1},c=t.config.auth.navigateToLoginRequestUrl?window.location.href:t.getRedirectUri(e.redirectUri);yield t.navigationClient.navigateExternal(c,s)})()}handleRedirectPromise(e,t){var n=this;return(0,l.Z)(function*(){if(n.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!n.browserStorage.isInteractionInProgress(!0))return n.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const o=n.browserStorage.getCachedNativeRequest();if(!o)return n.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:s,...c}=o;s&&n.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),n.browserStorage.removeItem(n.browserStorage.generateCacheKey(v.c4.NATIVE_REQUEST));const i={method:v.Ky.GetToken,request:c},g=fe.HY();try{n.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const a=yield n.nativeMessageHandler.sendMessage(i);n.validateNativeResponse(a);const u=n.handleNativeResponse(a,c,g);return n.browserStorage.setInteractionInProgress(!1),yield u}catch(a){throw n.browserStorage.setInteractionInProgress(!1),a}})()}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,t,n){var o=this;return(0,l.Z)(function*(){o.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=ne.Z_(e.id_token,ie.t),c=o.createHomeAccountIdentifier(e,s),i=o.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(c!==i&&e.account.id!==t.accountId)throw Qe(Ct);const g=yield o.getDiscoveredAuthority(t.authority),a=We(o.browserStorage,g,c,s,ie.t,e.client_info,void 0,s.tid,void 0,e.account.id,o.logger),u=yield o.generateAuthenticationResult(e,t,s,a,g.canonicalAuthority,n);return o.cacheAccount(a),o.cacheNativeTokens(e,t,c,s,u.accessToken,u.tenantId,n),u})()}createHomeAccountIdentifier(e,t){return w.r.generateHomeAccountId(e.client_info||d.gT.EMPTY_STRING,U.a.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return le.i.fromString(e.scope?e.scope:t.scope)}generatePopAccessToken(e,t){var n=this;return(0,l.Z)(function*(){if(t.tokenType===d.hO.POP){if(e.shr)return n.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const o=new Ne(n.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw(0,b.zP)(S.Of);return o.signPopToken(e.access_token,t.keyId,s)}return e.access_token})()}generateAuthenticationResult(e,t,n,o,s,c){var i=this;return(0,l.Z)(function*(){const g=i.addTelemetryFromNativeResponse(e),a=le.i.fromString(e.scope?e.scope:t.scope),u=e.account.properties||{},p=u.UID||n.oid||n.sub||d.gT.EMPTY_STRING,E=u.TenantId||n.tid||d.gT.EMPTY_STRING,L=(0,Ve.$f)(o.getAccountInfo(),void 0,n,e.id_token);L.nativeAccountId!==e.account.id&&(L.nativeAccountId=e.account.id);const $=yield i.generatePopAccessToken(e,t),ee=t.tokenType===d.hO.POP?d.hO.POP:d.hO.BEARER;return{authority:s,uniqueId:p,tenantId:E,scopes:a.asArray(),account:L,idToken:e.id_token,idTokenClaims:n,accessToken:$,fromCache:!!g&&i.isResponseFromCache(g),expiresOn:new Date(1e3*Number(c+e.expires_in)),tokenType:ee,correlationId:i.correlationId,state:e.state,fromNativeBroker:!0}})()}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,n,o,s,c,i){const g=P.Md(n,t.authority,e.id_token||"",t.clientId,o.tid||""),u=i+(t.tokenType===d.hO.POP?d.gT.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),p=this.generateScopes(e,t),E=P.Ds(n,t.authority,s,t.clientId,o.tid||c,p.printScopes(),u,0,ie.t),L=new re(void 0,g,E);this.nativeStorageManager.saveCacheRecord(L,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw(0,M.MD)(At.g,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){var t=this;return(0,l.Z)(function*(){t.logger.trace("NativeInteractionClient - initializeNativeRequest called");const n=e.authority||t.config.auth.authority;e.account&&(yield t.getDiscoveredAuthority(n,e.azureCloudOptions,e.account));const o=new I.G(n);o.validateAsUri();const{scopes:s,...c}=e,i=new le.i(s||[]);i.appendScopes(d.f_);const a={...c,accountId:t.accountId,clientId:t.config.auth.clientId,authority:o.urlString,scope:i.printScopes(),redirectUri:t.getRedirectUri(e.redirectUri),prompt:(()=>{switch(t.apiId){case v.WN.ssoSilent:case v.WN.acquireTokenSilent_silentFlow:return t.logger.trace("initializeNativeRequest: silent request sets prompt to none"),d.NJ.NONE}if(e.prompt)switch(e.prompt){case d.NJ.NONE:case d.NJ.CONSENT:case d.NJ.LOGIN:return t.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw t.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),(0,Y.Z_)(q.o9)}else t.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:t.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1};if(t.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry=v.BD.MATS_TELEMETRY,e.authenticationScheme===d.hO.POP){const u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},p=new Ne(t.browserCrypto),E=yield h(p.generateCnf.bind(p),T.Ak.PopTokenGenerateCnf,t.logger,t.performanceClient,t.correlationId)(u,t.logger);a.reqCnf=E.reqCnfHash,a.keyId=E.kid}return a})()}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty("brk_client_id")&&e.extraParameters.hasOwnProperty("brk_redirect_uri")&&e.extraParameters.hasOwnProperty(me.Cx)){const o=e.extraParameters.brk_redirect_uri;e.extraParameters={child_client_id:e.extraParameters[me.Cx],child_redirect_uri:e.redirectUri},e.redirectUri=o}}}class Ce{constructor(e,t,n,o){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(T.Ak.NativeMessageHandlerHandshake)}sendMessage(e){var t=this;return(0,l.Z)(function*(){t.logger.trace("NativeMessageHandler - sendMessage called.");const n={channel:v.BD.CHANNEL_ID,extensionId:t.extensionId,responseId:(0,Ae.nn)(),body:e};return t.logger.trace("NativeMessageHandler - Sending request to browser extension"),t.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(n)}`),t.messageChannel.port1.postMessage(n),new Promise((o,s)=>{t.resolvers.set(n.responseId,{resolve:o,reject:s})})})()}static createProvider(e,t,n){return(0,l.Z)(function*(){e.trace("NativeMessageHandler - createProvider called.");try{const o=new Ce(e,t,n,v.BD.PREFERRED_EXTENSION_ID);return yield o.sendHandshakeRequest(),o}catch{const s=new Ce(e,t,n);return yield s.sendHandshakeRequest(),s}})()}sendHandshakeRequest(){var e=this;return(0,l.Z)(function*(){e.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",e.windowListener,!1);const t={channel:v.BD.CHANNEL_ID,extensionId:e.extensionId,responseId:(0,Ae.nn)(),body:{method:v.Ky.HandshakeRequest}};return e.handshakeEvent.add({extensionId:e.extensionId,extensionHandshakeTimeoutMs:e.handshakeTimeoutMs}),e.messageChannel.port1.onmessage=n=>{e.onChannelMessage(n)},window.postMessage(t,window.origin,[e.messageChannel.port2]),new Promise((n,o)=>{e.handshakeResolvers.set(t.responseId,{resolve:n,reject:o}),e.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",e.windowListener,!1),e.messageChannel.port1.close(),e.messageChannel.port2.close(),e.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),o((0,Y.Z_)(q.hR)),e.handshakeResolvers.delete(t.responseId)},e.handshakeTimeoutMs)})})()}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===v.BD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===v.Ky.HandshakeRequest){const n=this.handshakeResolvers.get(t.responseId);if(!n)return void this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject((0,Y.Z_)(q.Wb))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{const s=t.body.method;if(s===v.Ky.Response){if(!n)return;const c=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(c)}`),"Success"!==c.status)n.reject(Qe(c.code,c.description,c.ext));else{if(!c.result)throw(0,M.MD)(At.g,"Event does not contain result.");c.result.code&&c.result.description?n.reject(Qe(c.result.code,c.result.description,c.result.ext)):n.resolve(c.result)}this.resolvers.delete(t.responseId)}else if(s===v.Ky.HandshakeResponse){if(!o)return void this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${s}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(s):o&&o.reject(s)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case d.hO.BEARER:case d.hO.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class Je{constructor(e,t,n,o,s){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=o,this.performanceClient=s}handleCodeResponse(e,t){var n=this;return(0,l.Z)(function*(){let o;n.performanceClient.addQueueMeasurement(T.Ak.HandleCodeResponse,t.correlationId);try{o=n.authModule.handleFragmentResponse(e,t.state)}catch(s){throw s instanceof Te.n&&s.subError===q.h7?(0,Y.Z_)(q.h7):s}return h(n.handleCodeResponseFromServer.bind(n),T.Ak.HandleCodeResponseFromServer,n.logger,n.performanceClient,t.correlationId)(o,t)})()}handleCodeResponseFromServer(e,t,n=!0){var o=this;return(0,l.Z)(function*(){if(o.performanceClient.addQueueMeasurement(T.Ak.HandleCodeResponseFromServer,t.correlationId),o.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),o.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield h(o.authModule.updateAuthority.bind(o.authModule),T.Ak.UpdateTokenEndpointAuthority,o.logger,o.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId)),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)o.authCodeRequest.clientInfo=e.client_info;else{const c=o.createCcsCredentials(t);c&&(o.authCodeRequest.ccsCredential=c)}return yield h(o.authModule.acquireToken.bind(o.authModule),T.Ak.AuthClientAcquireToken,o.logger,o.performanceClient,t.correlationId)(o.authCodeRequest,e)})()}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:"home_account_id"}:e.loginHint?{credential:e.loginHint,type:"UPN"}:null}}var De=m(9218);function yt(y,e,t){const n=De.F(y);if(!n)throw De.q(y)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${y}`),(0,Y.Z_)(q.S_)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),(0,Y.Z_)(q.nF));return n}class Yt extends xe{constructor(e,t,n,o,s,c,i,g,a,u){super(e,t,n,o,s,c,i,a,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=g}acquireToken(e){try{const t=this.generatePopupName(e.scopes||d.f_,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,n);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const o=this.openSizedPopup("about:blank",t,n);return this.acquireTokenPopupAsync(e,t,n,o)}}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(t),o=e&&e.authority,s=e&&e.mainWindowRedirectUri,c=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,c,o,void 0,s);{this.logger.verbose("asyncPopup set to false, opening popup");const i=this.openSizedPopup("about:blank",n,c);return this.logoutPopupAsync(t,n,c,o,i,s)}}catch(t){return Promise.reject(t)}}acquireTokenPopupAsync(e,t,n,o){var s=this;return(0,l.Z)(function*(){s.logger.verbose("acquireTokenPopupAsync called");const c=s.initializeServerTelemetryManager(v.WN.acquireTokenPopup),i=yield h(s.initializeAuthorizationRequest.bind(s),T.Ak.StandardInteractionClientInitializeAuthorizationRequest,s.logger,s.performanceClient,s.correlationId)(e,v.s_.Popup);(0,oe.$P)(i.authority);try{const g=yield h(s.initializeAuthorizationCodeRequest.bind(s),T.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,s.logger,s.performanceClient,s.correlationId)(i),a=yield h(s.createAuthCodeClient.bind(s),T.Ak.StandardInteractionClientCreateAuthCodeClient,s.logger,s.performanceClient,s.correlationId)(c,i.authority,i.azureCloudOptions,i.account),u=Ce.isNativeAvailable(s.config,s.logger,s.nativeMessageHandler,e.authenticationScheme);let p;u&&(p=s.performanceClient.startMeasurement(T.Ak.FetchAccountIdWithNativeBroker,e.correlationId));const E=yield a.getAuthCodeUrl({...i,nativeBroker:u}),L=new Je(a,s.browserStorage,g,s.logger,s.performanceClient),ee=s.initiateAuthRequest(E,{popup:o,popupName:t,popupWindowAttributes:n});s.eventHandler.emitEvent(V.t.POPUP_OPENED,v.s_.Popup,{popupWindow:ee},null);const ae=yield s.monitorPopupForHash(ee),ge=W(yt,T.Ak.DeserializeResponse,s.logger,s.performanceClient,s.correlationId)(ae,s.config.auth.OIDCOptions.serverResponseType,s.logger);if(pe.removeThrottle(s.browserStorage,s.config.auth.clientId,g),ge.accountId){if(s.logger.verbose("Account id found in hash, calling WAM for token"),p&&p.end({success:!0,isNativeBroker:!0}),!s.nativeMessageHandler)throw(0,Y.Z_)(q.V7);const Ke=new Ue(s.config,s.browserStorage,s.browserCrypto,s.logger,s.eventHandler,s.navigationClient,v.WN.acquireTokenPopup,s.performanceClient,s.nativeMessageHandler,ge.accountId,s.nativeStorage,i.correlationId),{userRequestState:st}=J.parseRequestState(s.browserCrypto,i.state);return yield Ke.acquireToken({...i,state:st,prompt:void 0})}return yield L.handleCodeResponse(ge,i)}catch(g){throw o&&o.close(),g instanceof M.l4&&(g.setCorrelationId(s.correlationId),c.cacheFailedRequest(g)),g}})()}logoutPopupAsync(e,t,n,o,s,c){var i=this;return(0,l.Z)(function*(){i.logger.verbose("logoutPopupAsync called"),i.eventHandler.emitEvent(V.t.LOGOUT_START,v.s_.Popup,e);const g=i.initializeServerTelemetryManager(v.WN.logoutPopup);try{yield i.clearCacheOnLogout(e.account);const u=(yield h(i.createAuthCodeClient.bind(i),T.Ak.StandardInteractionClientCreateAuthCodeClient,i.logger,i.performanceClient,i.correlationId)(g,o,void 0,e.account||void 0)).getLogoutUri(e);i.eventHandler.emitEvent(V.t.LOGOUT_SUCCESS,v.s_.Popup,e);const p=i.openPopup(u,{popupName:t,popupWindowAttributes:n,popup:s});if(i.eventHandler.emitEvent(V.t.POPUP_OPENED,v.s_.Popup,{popupWindow:p},null),yield i.monitorPopupForHash(p).catch(()=>{}),c){const E={apiId:v.WN.logoutPopup,timeout:i.config.system.redirectNavigationTimeout,noHistory:!1},L=I.G.getAbsoluteUrl(c,(0,oe.Re)());i.logger.verbose("Redirecting main window to url specified in the request"),i.logger.verbosePii(`Redirecting main window to: ${L}`),yield i.navigationClient.navigateInternal(L,E)}else i.logger.verbose("No main window navigation requested")}catch(a){throw s&&s.close(),a instanceof M.l4&&(a.setCorrelationId(i.correlationId),g.cacheFailedRequest(a)),i.browserStorage.setInteractionInProgress(!1),i.eventHandler.emitEvent(V.t.LOGOUT_FAILURE,v.s_.Popup,null,a),i.eventHandler.emitEvent(V.t.LOGOUT_END,v.s_.Popup),a}i.eventHandler.emitEvent(V.t.LOGOUT_END,v.s_.Popup)})()}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),(0,Y.Z_)(q._c)}monitorPopupForHash(e){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const o=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(o),void n((0,Y.Z_)(q.h7));let s="";try{s=e.location.href}catch{}if(!s||"about:blank"===s)return;clearInterval(o);let c="";e&&(c=this.config.auth.OIDCOptions.serverResponseType===d.rg.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(c)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!n)throw(0,Y.Z_)(q.H);return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),(0,Y.Z_)(q.E)}}openSizedPopup(e,t,n){const o=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let g=n.popupSize?.width,a=n.popupSize?.height,u=n.popupPosition?.top,p=n.popupPosition?.left;return(!g||g<0||g>c)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),g=v.qx.POPUP_WIDTH),(!a||a<0||a>i)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),a=v.qx.POPUP_HEIGHT),(!u||u<0||u>i)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,i/2-v.qx.POPUP_HEIGHT/2+s)),(!p||p<0||p>c)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,c/2-v.qx.POPUP_WIDTH/2+o)),window.open(e,t,`width=${g}, height=${a}, top=${u}, left=${p}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(v.s_.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${v.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){return`${v.qx.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.account&&e.account.homeAccountId}.${this.correlationId}`}}class _t{constructor(e,t,n,o,s){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=o,this.performanceClient=s}initiateAuthRequest(e,t){var n=this;return(0,l.Z)(function*(){if(n.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(n.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),n.browserStorage.setTemporaryCache(v.c4.ORIGIN_URI,t.redirectStartPage,!0)),n.browserStorage.setTemporaryCache(v.c4.CORRELATION_ID,n.authCodeRequest.correlationId,!0),n.browserStorage.cacheCodeRequest(n.authCodeRequest),n.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const o={apiId:v.WN.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};return"function"==typeof t.onRedirectNavigate?(n.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)?(n.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void(yield t.navigationClient.navigateExternal(e,o))):void n.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(n.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void(yield t.navigationClient.navigateExternal(e,o)))}throw n.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),(0,Y.Z_)(q._c)})()}handleCodeResponse(e,t){var n=this;return(0,l.Z)(function*(){n.logger.verbose("RedirectHandler.handleCodeResponse called"),n.browserStorage.setInteractionInProgress(!1);const o=n.browserStorage.generateStateKey(t),s=n.browserStorage.getTemporaryCache(o);if(!s)throw(0,b.zP)(S.LV,"Cached State");let c;try{c=n.authModule.handleFragmentResponse(e,s)}catch(u){throw u instanceof Te.n&&u.subError===q.h7?(0,Y.Z_)(q.h7):u}const i=n.browserStorage.generateNonceKey(s),g=n.browserStorage.getTemporaryCache(i);if(n.authCodeRequest.code=c.code,c.cloud_instance_host_name&&(yield h(n.authModule.updateAuthority.bind(n.authModule),T.Ak.UpdateTokenEndpointAuthority,n.logger,n.performanceClient,n.authCodeRequest.correlationId)(c.cloud_instance_host_name,n.authCodeRequest.correlationId)),c.nonce=g||void 0,c.state=s,c.client_info)n.authCodeRequest.clientInfo=c.client_info;else{const u=n.checkCcsCredentials();u&&(n.authCodeRequest.ccsCredential=u)}const a=yield n.authModule.acquireToken(n.authCodeRequest,c);return n.browserStorage.cleanRequestByState(t),a})()}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(v.c4.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}class Qt extends xe{constructor(e,t,n,o,s,c,i,g,a,u){super(e,t,n,o,s,c,i,a,u),this.nativeStorage=g}acquireToken(e){var t=this;return(0,l.Z)(function*(){const n=yield h(t.initializeAuthorizationRequest.bind(t),T.Ak.StandardInteractionClientInitializeAuthorizationRequest,t.logger,t.performanceClient,t.correlationId)(e,v.s_.Redirect);t.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null);const o=t.initializeServerTelemetryManager(v.WN.acquireTokenRedirect),s=c=>{c.persisted&&(t.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),t.browserStorage.cleanRequestByState(n.state),t.eventHandler.emitEvent(V.t.RESTORE_FROM_BFCACHE,v.s_.Redirect))};try{const c=yield h(t.initializeAuthorizationCodeRequest.bind(t),T.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,t.logger,t.performanceClient,t.correlationId)(n),i=yield h(t.createAuthCodeClient.bind(t),T.Ak.StandardInteractionClientCreateAuthCodeClient,t.logger,t.performanceClient,t.correlationId)(o,n.authority,n.azureCloudOptions,n.account),g=new _t(i,t.browserStorage,c,t.logger,t.performanceClient),a=yield i.getAuthCodeUrl({...n,nativeBroker:Ce.isNativeAvailable(t.config,t.logger,t.nativeMessageHandler,e.authenticationScheme)}),u=t.getRedirectStartPage(e.redirectStartPage);return t.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",s),yield g.initiateAuthRequest(a,{navigationClient:t.navigationClient,redirectTimeout:t.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate})}catch(c){throw c instanceof M.l4&&(c.setCorrelationId(t.correlationId),o.cacheFailedRequest(c)),window.removeEventListener("pageshow",s),t.browserStorage.cleanRequestByState(n.state),c}})()}handleRedirectPromise(e="",t){var n=this;return(0,l.Z)(function*(){const o=n.initializeServerTelemetryManager(v.WN.handleRedirectPromise);try{if(!n.browserStorage.isInteractionInProgress(!0))return n.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,c]=n.getRedirectResponse(e||"");if(!s)return n.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),n.browserStorage.cleanRequestByInteractionType(v.s_.Redirect),t.event.errorCode="no_server_response",null;const i=n.browserStorage.getTemporaryCache(v.c4.ORIGIN_URI,!0)||d.gT.EMPTY_STRING;if(I.G.removeHashFromUrl(i)===I.G.removeHashFromUrl(window.location.href)&&n.config.auth.navigateToLoginRequestUrl)return n.logger.verbose("Current page is loginRequestUrl, handling response"),i.indexOf("#")>-1&&(0,oe.tT)(i),yield n.handleResponse(s,o);if(!n.config.auth.navigateToLoginRequestUrl)return n.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield n.handleResponse(s,o);if(!(0,oe.zd)()||n.config.system.allowRedirectInIframe){n.browserStorage.setTemporaryCache(v.c4.URL_HASH,c,!0);const u={apiId:v.WN.handleRedirectPromise,timeout:n.config.system.redirectNavigationTimeout,noHistory:!0};let p=!0;if(i&&"null"!==i)n.logger.verbose(`Navigating to loginRequestUrl: ${i}`),p=yield n.navigationClient.navigateInternal(i,u);else{const E=(0,oe.fl)();n.browserStorage.setTemporaryCache(v.c4.ORIGIN_URI,E,!0),n.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),p=yield n.navigationClient.navigateInternal(E,u)}if(!p)return yield n.handleResponse(s,o)}return null}catch(s){throw s instanceof M.l4&&(s.setCorrelationId(n.correlationId),o.cacheFailedRequest(s)),n.browserStorage.cleanRequestByInteractionType(v.s_.Redirect),s}})()}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===d.rg.QUERY?window.location.search:window.location.hash);let n=De.F(t);if(n){try{!function zt(y,e,t){if(!y.state)throw(0,Y.Z_)(q.Xk);const n=ce(e,y.state);if(!n)throw(0,Y.Z_)(q.$P);if(n.interactionType!==t)throw(0,Y.Z_)(q.yK)}(n,this.browserCrypto,v.s_.Redirect)}catch(s){return s instanceof M.l4&&this.logger.error(`Interaction type validation failed due to ${s.errorCode}: ${s.errorMessage}`),[null,""]}return(0,oe.hH)(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const o=this.browserStorage.getTemporaryCache(v.c4.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(v.c4.URL_HASH)),o&&(n=De.F(o),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,o]):[null,""]}handleResponse(e,t){var n=this;return(0,l.Z)(function*(){const o=e.state;if(!o)throw(0,Y.Z_)(q.Xk);const s=n.browserStorage.getCachedRequest(o);if(n.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(n.logger.verbose("Account id found in hash, calling WAM for token"),!n.nativeMessageHandler)throw(0,Y.Z_)(q.V7);const a=new Ue(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,v.WN.acquireTokenPopup,n.performanceClient,n.nativeMessageHandler,e.accountId,n.nativeStorage,s.correlationId),{userRequestState:u}=J.parseRequestState(n.browserCrypto,o);return a.acquireToken({...s,state:u,prompt:void 0}).finally(()=>{n.browserStorage.cleanRequestByState(o)})}const c=n.browserStorage.getCachedAuthority(o);if(!c)throw(0,Y.Z_)(q.dT);const i=yield h(n.createAuthCodeClient.bind(n),T.Ak.StandardInteractionClientCreateAuthCodeClient,n.logger,n.performanceClient,n.correlationId)(t,c);return pe.removeThrottle(n.browserStorage,n.config.auth.clientId,s),new _t(i,n.browserStorage,s,n.logger,n.performanceClient).handleCodeResponse(e,o)})()}logout(e){var t=this;return(0,l.Z)(function*(){t.logger.verbose("logoutRedirect called");const n=t.initializeLogoutRequest(e),o=t.initializeServerTelemetryManager(v.WN.logout);try{t.eventHandler.emitEvent(V.t.LOGOUT_START,v.s_.Redirect,e),yield t.clearCacheOnLogout(n.account);const s={apiId:v.WN.logout,timeout:t.config.system.redirectNavigationTimeout,noHistory:!1},i=(yield h(t.createAuthCodeClient.bind(t),T.Ak.StandardInteractionClientCreateAuthCodeClient,t.logger,t.performanceClient,t.correlationId)(o,e&&e.authority,void 0,e&&e.account||void 0)).getLogoutUri(n);if(t.eventHandler.emitEvent(V.t.LOGOUT_SUCCESS,v.s_.Redirect,n),!e||"function"!=typeof e.onRedirectNavigate)return t.browserStorage.getInteractionInProgress()||t.browserStorage.setInteractionInProgress(!0),void(yield t.navigationClient.navigateExternal(i,s));if(!1!==e.onRedirectNavigate(i))return t.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),t.browserStorage.getInteractionInProgress()||t.browserStorage.setInteractionInProgress(!0),void(yield t.navigationClient.navigateExternal(i,s));t.browserStorage.setInteractionInProgress(!1),t.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(s){throw s instanceof M.l4&&(s.setCorrelationId(t.correlationId),o.cacheFailedRequest(s)),t.eventHandler.emitEvent(V.t.LOGOUT_FAILURE,v.s_.Redirect,null,s),t.eventHandler.emitEvent(V.t.LOGOUT_END,v.s_.Redirect),s}t.eventHandler.emitEvent(V.t.LOGOUT_END,v.s_.Redirect)})()}getRedirectStartPage(e){const t=e||window.location.href;return I.G.getAbsoluteUrl(t,(0,oe.Re)())}}var Et=m(1216);function jt(y,e,t,n,o){return rt.apply(this,arguments)}function rt(){return(rt=(0,l.Z)(function*(y,e,t,n,o){if(e.addQueueMeasurement(T.Ak.SilentHandlerInitiateAuthRequest,n),!y)throw t.info("Navigate url is empty"),(0,Y.Z_)(q._c);return o?h(qt,T.Ak.SilentHandlerLoadFrame,t,e,n)(y,o,e,n):W(Vt,T.Ak.SilentHandlerLoadFrameSync,t,e,n)(y)})).apply(this,arguments)}function Jt(y,e,t,n,o,s,c){return ot.apply(this,arguments)}function ot(){return(ot=(0,l.Z)(function*(y,e,t,n,o,s,c){return n.addQueueMeasurement(T.Ak.SilentHandlerMonitorIframeForHash,s),new Promise((i,g)=>{e<Et.Is&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${Et.Is}ms). This may result in timeouts.`);const a=window.setTimeout(()=>{window.clearInterval(u),g((0,Y.Z_)(q.JA))},e),u=window.setInterval(()=>{let p="";const E=y.contentWindow;try{p=E?E.location.href:""}catch{}if(!p||"about:blank"===p)return;let L="";E&&(L=c===d.rg.QUERY?E.location.search:E.location.hash),window.clearTimeout(a),window.clearInterval(u),i(L)},t)}).finally(()=>{W(Wt,T.Ak.RemoveHiddenIframe,o,n,s)(y)})})).apply(this,arguments)}function qt(y,e,t,n){return t.addQueueMeasurement(T.Ak.SilentHandlerLoadFrame,n),new Promise((o,s)=>{const c=_e();window.setTimeout(()=>{c?(c.src=y,o(c)):s("Unable to load iframe")},e)})}function Vt(y){const e=_e();return e.src=y,e}function _e(){const y=document.createElement("iframe");return y.className="msalSilentIframe",y.style.visibility="hidden",y.style.position="absolute",y.style.width=y.style.height="0",y.style.border="0",y.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(y),y}function Wt(y){document.body===y.parentNode&&document.body.removeChild(y)}class Rt extends xe{constructor(e,t,n,o,s,c,i,g,a,u,p){super(e,t,n,o,s,c,g,u,p),this.apiId=i,this.nativeStorage=a}acquireToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&t.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const n={...e};n.prompt?n.prompt!==d.NJ.NONE&&n.prompt!==d.NJ.NO_SESSION&&(t.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${d.NJ.NONE}`),n.prompt=d.NJ.NONE):n.prompt=d.NJ.NONE;const o=yield h(t.initializeAuthorizationRequest.bind(t),T.Ak.StandardInteractionClientInitializeAuthorizationRequest,t.logger,t.performanceClient,e.correlationId)(n,v.s_.Silent);(0,oe.$P)(o.authority);const s=t.initializeServerTelemetryManager(t.apiId);try{const c=yield h(t.createAuthCodeClient.bind(t),T.Ak.StandardInteractionClientCreateAuthCodeClient,t.logger,t.performanceClient,e.correlationId)(s,o.authority,o.azureCloudOptions,o.account);return yield h(t.silentTokenHelper.bind(t),T.Ak.SilentIframeClientTokenHelper,t.logger,t.performanceClient,e.correlationId)(c,o)}catch(c){throw c instanceof M.l4&&(c.setCorrelationId(t.correlationId),s.cacheFailedRequest(c)),c}})()}logout(){return Promise.reject((0,Y.Z_)(q.I9))}silentTokenHelper(e,t){var n=this;return(0,l.Z)(function*(){const o=t.correlationId;n.performanceClient.addQueueMeasurement(T.Ak.SilentIframeClientTokenHelper,o);const s=yield h(n.initializeAuthorizationCodeRequest.bind(n),T.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,n.logger,n.performanceClient,o)(t),c=yield h(e.getAuthCodeUrl.bind(e),T.Ak.GetAuthCodeUrl,n.logger,n.performanceClient,o)({...t,nativeBroker:Ce.isNativeAvailable(n.config,n.logger,n.nativeMessageHandler,t.authenticationScheme)}),i=new Je(e,n.browserStorage,s,n.logger,n.performanceClient),g=yield h(jt,T.Ak.SilentHandlerInitiateAuthRequest,n.logger,n.performanceClient,o)(c,n.performanceClient,n.logger,o,n.config.system.navigateFrameWait),a=n.config.auth.OIDCOptions.serverResponseType,u=yield h(Jt,T.Ak.SilentHandlerMonitorIframeForHash,n.logger,n.performanceClient,o)(g,n.config.system.iframeHashTimeout,n.config.system.pollIntervalMilliseconds,n.performanceClient,n.logger,o,a),p=W(yt,T.Ak.DeserializeResponse,n.logger,n.performanceClient,n.correlationId)(u,a,n.logger);if(p.accountId){if(n.logger.verbose("Account id found in hash, calling WAM for token"),!n.nativeMessageHandler)throw(0,Y.Z_)(q.V7);const E=new Ue(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,n.apiId,n.performanceClient,n.nativeMessageHandler,p.accountId,n.browserStorage,o),{userRequestState:L}=J.parseRequestState(n.browserCrypto,t.state);return h(E.acquireToken.bind(E),T.Ak.NativeInteractionClientAcquireToken,n.logger,n.performanceClient,o)({...t,state:L,prompt:t.prompt||d.NJ.NONE})}return h(i.handleCodeResponse.bind(i),T.Ak.HandleCodeResponse,n.logger,n.performanceClient,o)(p,t)})()}}class it extends xe{acquireToken(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.SilentRefreshClientAcquireToken,e.correlationId);const n=yield h(et,T.Ak.InitializeBaseRequest,t.logger,t.performanceClient,e.correlationId)(e,t.config,t.performanceClient,t.logger),o={...e,...n};e.redirectUri&&(o.redirectUri=t.getRedirectUri(e.redirectUri));const s=t.initializeServerTelemetryManager(v.WN.acquireTokenSilent_silentFlow),c=yield t.createRefreshTokenClient(s,o.authority,o.azureCloudOptions,o.account);return h(c.acquireTokenByRefreshToken.bind(c),T.Ak.RefreshTokenClientAcquireTokenByRefreshToken,t.logger,t.performanceClient,e.correlationId)(o).catch(i=>{throw i.setCorrelationId(t.correlationId),s.cacheFailedRequest(i),i})})()}logout(){return Promise.reject((0,Y.Z_)(q.I9))}createRefreshTokenClient(e,t,n,o){var s=this;return(0,l.Z)(function*(){const c=yield h(s.getClientConfiguration.bind(s),T.Ak.StandardInteractionClientGetClientConfiguration,s.logger,s.performanceClient,s.correlationId)(e,t,n,o);return new je(c,s.performanceClient)})()}}class wt{constructor(e,t,n,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=o}loadExternalTokens(e,t,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw(0,Y.Z_)(q.Jd);const o=ne.Z_(t.id_token,ie.t);let s,c,i;if(e.account)i=w.r.createFromAccountInfo(e.account),s=new re(i,this.loadIdToken(t.id_token,i.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,i.homeAccountId,e.account.environment,e.account.tenantId,n),this.loadRefreshToken(e,t,i.homeAccountId,e.account.environment));else{if(!e.authority)throw(0,Y.Z_)(q.Jd);{const g=k.generateAuthority(e.authority,e.azureCloudOptions);if(c=new k(g,this.config.system.networkClient,this.storage,{protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},this.logger,e.correlationId||(0,Ae.nn)()),n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),i=this.loadAccount(o,c,n.clientInfo),s=new re(i,this.loadIdToken(t.id_token,i.homeAccountId,c.hostnameAndPort,c.tenant),this.loadAccessToken(e,t,i.homeAccountId,c.hostnameAndPort,c.tenant,n),this.loadRefreshToken(e,t,i.homeAccountId,c.hostnameAndPort));else{if(!t.client_info)throw(0,Y.Z_)(q.Jd);this.logger.trace("TokenCache - homeAccountId from response"),i=this.loadAccount(o,c,t.client_info),s=new re(i,this.loadIdToken(t.id_token,i.homeAccountId,c.hostnameAndPort,c.tenant),this.loadAccessToken(e,t,i.homeAccountId,c.hostnameAndPort,c.tenant,n),this.loadRefreshToken(e,t,i.homeAccountId,c.hostnameAndPort))}}}return this.generateAuthenticationResult(e,o,s,i,c)}loadAccount(e,t,n,o){if(this.isBrowserEnvironment){let s;if(this.logger.verbose("TokenCache - loading account"),o?s=o:void 0!==t.authorityType&&n&&(s=w.r.generateHomeAccountId(n,t.authorityType,this.logger,this.cryptoObj,e)),!s)throw(0,Y.Z_)(q.Jd);const i=We(this.storage,t,s,e,ie.t,n,t.hostnameAndPort,e.tid,void 0,void 0,this.logger);return this.storage.setAccount(i),i}throw(0,Y.Z_)(q.Jd)}loadIdToken(e,t,n,o){const s=P.Md(t,n,e,this.config.auth.clientId,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(s),s;throw(0,Y.Z_)(q.Jd)}loadAccessToken(e,t,n,o,s,c){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in||!c.extendedExpiresOn)throw(0,Y.Z_)(q.Jd);const i=new le.i(e.scopes).printScopes(),g=c.expiresOn||t.expires_in+(new Date).getTime()/1e3,u=P.Ds(n,o,t.access_token,this.config.auth.clientId,s,i,g,c.extendedExpiresOn,ie.t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw(0,Y.Z_)(q.Jd)}loadRefreshToken(e,t,n,o){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;const s=P.OJ(n,o,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(s),s;throw(0,Y.Z_)(q.Jd)}generateAuthenticationResult(e,t,n,o,s){let a,c=d.gT.EMPTY_STRING,i=[],g=null;return n?.accessToken&&(c=n.accessToken.secret,i=le.i.fromString(n.accessToken.target).asArray(),g=new Date(1e3*Number(n.accessToken.expiresOn)),a=new Date(1e3*Number(n.accessToken.extendedExpiresOn))),{authority:s?s.canonicalAuthority:d.gT.EMPTY_STRING,uniqueId:t.oid||t.sub||d.gT.EMPTY_STRING,tenantId:t.tid||d.gT.EMPTY_STRING,scopes:i,account:o.getAccountInfo(),idToken:n.idToken?.secret||"",idTokenClaims:t||{},accessToken:c,fromCache:!0,expiresOn:g,correlationId:e.correlationId||d.gT.EMPTY_STRING,requestId:d.gT.EMPTY_STRING,extExpiresOn:a,familyId:d.gT.EMPTY_STRING,tokenType:n?.accessToken?.tokenType||d.gT.EMPTY_STRING,state:d.gT.EMPTY_STRING,cloudGraphHostName:o.cloudGraphHostName||d.gT.EMPTY_STRING,msGraphHost:o.msGraphHost||d.gT.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}}class $t extends gt{constructor(e){super(e),this.includeRedirectUri=!1}}class at extends xe{constructor(e,t,n,o,s,c,i,g,a,u){super(e,t,n,o,s,c,g,a,u),this.apiId=i}acquireToken(e){var t=this;return(0,l.Z)(function*(){if(!e.code)throw(0,Y.Z_)(q.Aj);const n=yield h(t.initializeAuthorizationRequest.bind(t),T.Ak.StandardInteractionClientInitializeAuthorizationRequest,t.logger,t.performanceClient,e.correlationId)(e,v.s_.Silent),o=t.initializeServerTelemetryManager(t.apiId);try{const s={...n,code:e.code},c=yield h(t.getClientConfiguration.bind(t),T.Ak.StandardInteractionClientGetClientConfiguration,t.logger,t.performanceClient,e.correlationId)(o,n.authority,n.azureCloudOptions,n.account),i=new $t(c);t.logger.verbose("Auth code client created");const g=new Je(i,t.browserStorage,s,t.logger,t.performanceClient);return yield h(g.handleCodeResponseFromServer.bind(g),T.Ak.HandleCodeResponseFromServer,t.logger,t.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},n,!1)}catch(s){throw s instanceof M.l4&&(s.setCorrelationId(t.correlationId),o.cacheFailedRequest(s)),s}})()}logout(){return Promise.reject((0,Y.Z_)(q.I9))}}function Ee(y){const e=y?.idTokenClaims;return e?.tfp||e?.acr?"B2C":e?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===e?.tid?"MSA":"AAD":void 0}class Ze{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new A.Q(this.logger,this.performanceClient):R.d,this.eventHandler=new Me.b(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Oe(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function H(y){const e=y.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw(0,r.ei)(K.E)}return{canonicalAuthority:y.authority?x(y.authority):void 0,knownAuthorities:y.knownAuthorities,cloudDiscoveryMetadata:t}}(this.config.auth),this.performanceClient):((y,e)=>new Oe(this.config.auth.clientId,{cacheLocation:v.Ix.MemoryStorage,temporaryCacheLocation:v.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},R.d,this.logger))(),this.nativeInternalStorage=new Oe(this.config.auth.clientId,{cacheLocation:v.Ix.MemoryStorage,temporaryCacheLocation:v.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new wt(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e){return(0,l.Z)(function*(){const t=new Ze(e);return yield t.initialize(),t})()}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(){var e=this;return(0,l.Z)(function*(){if(e.logger.trace("initialize called"),e.initialized)return void e.logger.info("initialize has already been called, exiting early.");const t=e.config.system.allowNativeBroker,n=e.performanceClient.startMeasurement(T.Ak.InitializeClientApplication);if(e.eventHandler.emitEvent(V.t.INITIALIZE_START),t)try{e.nativeExtensionProvider=yield Ce.createProvider(e.logger,e.config.system.nativeBrokerHandshakeTimeout,e.performanceClient)}catch(o){e.logger.verbose(o)}e.config.cache.claimsBasedCachingEnabled||(e.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield h(e.browserStorage.clearTokensAndKeysWithClaims.bind(e.browserStorage),T.Ak.ClearTokensAndKeysWithClaims,e.logger,e.performanceClient)(e.performanceClient)),e.initialized=!0,e.eventHandler.emitEvent(V.t.INITIALIZE_END),n.end({allowNativeBroker:t,success:!0})})()}handleRedirectPromise(e){var t=this;return(0,l.Z)(function*(){if(t.logger.verbose("handleRedirectPromise called"),(0,oe.eQ)(t.initialized),t.isBrowserEnvironment){const n=e||"";let o=t.redirectResponse.get(n);return typeof o>"u"?(o=t.handleRedirectPromiseInternal(e),t.redirectResponse.set(n,o),t.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):t.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),o}return t.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})()}handleRedirectPromiseInternal(e){var t=this;return(0,l.Z)(function*(){const n=t.getAllAccounts(),o=t.browserStorage.getCachedNativeRequest(),s=o&&Ce.isNativeAvailable(t.config,t.logger,t.nativeExtensionProvider)&&t.nativeExtensionProvider&&!e,c=s?o?.correlationId:t.browserStorage.getTemporaryCache(v.c4.CORRELATION_ID,!0)||"",i=t.performanceClient.startMeasurement("acquireTokenRedirect",c);let g;if(t.eventHandler.emitEvent(V.t.HANDLE_REDIRECT_START,v.s_.Redirect),s&&t.nativeExtensionProvider){t.logger.trace("handleRedirectPromise - acquiring token from native platform");const a=new Ue(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,v.WN.handleRedirectPromise,t.performanceClient,t.nativeExtensionProvider,o.accountId,t.nativeInternalStorage,o.correlationId);g=h(a.handleRedirectPromise.bind(a),T.Ak.HandleNativeRedirectPromiseMeasurement,t.logger,t.performanceClient,i.event.correlationId)(t.performanceClient,i.event.correlationId)}else{t.logger.trace("handleRedirectPromise - acquiring token from web flow");const a=t.createRedirectClient(c);g=h(a.handleRedirectPromise.bind(a),T.Ak.HandleRedirectPromiseMeasurement,t.logger,t.performanceClient,i.event.correlationId)(e,i)}return g.then(a=>(a?(n.length<t.getAllAccounts().length?(t.eventHandler.emitEvent(V.t.LOGIN_SUCCESS,v.s_.Redirect,a),t.logger.verbose("handleRedirectResponse returned result, login success")):(t.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_SUCCESS,v.s_.Redirect,a),t.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0,accountType:Ee(a.account)})):i.event.errorCode?i.end({success:!1}):i.discard(),t.eventHandler.emitEvent(V.t.HANDLE_REDIRECT_END,v.s_.Redirect),a)).catch(a=>{const u=a;throw t.eventHandler.emitEvent(n.length>0?V.t.ACQUIRE_TOKEN_FAILURE:V.t.LOGIN_FAILURE,v.s_.Redirect,null,u),t.eventHandler.emitEvent(V.t.HANDLE_REDIRECT_END,v.s_.Redirect),i.end({success:!1},u),a})})()}acquireTokenRedirect(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);t.logger.verbose("acquireTokenRedirect called",n),(0,oe.ER)(t.initialized,t.config),t.browserStorage.setInteractionInProgress(!0);const o=t.getAllAccounts().length>0;let s;return t.eventHandler.emitEvent(o?V.t.ACQUIRE_TOKEN_START:V.t.LOGIN_START,v.s_.Redirect,e),s=t.nativeExtensionProvider&&t.canUseNative(e)?new Ue(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,v.WN.acquireTokenRedirect,t.performanceClient,t.nativeExtensionProvider,t.getNativeAccountId(e),t.nativeInternalStorage,n).acquireTokenRedirect(e).catch(i=>{if(i instanceof Ie&&Pe(i))return t.nativeExtensionProvider=void 0,t.createRedirectClient(n).acquireToken(e);if(i instanceof F.Yo)return t.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createRedirectClient(n).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),i}):t.createRedirectClient(n).acquireToken(e),s.catch(c=>{throw t.eventHandler.emitEvent(o?V.t.ACQUIRE_TOKEN_FAILURE:V.t.LOGIN_FAILURE,v.s_.Redirect,null,c),c})})()}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(T.Ak.AcquireTokenPopup,t);n.add({scenarioId:e.scenarioId,accountType:Ee(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),(0,oe.ZC)(this.initialized),this.browserStorage.setInteractionInProgress(!0)}catch(c){return Promise.reject(c)}const o=this.getAllAccounts();let s;return this.eventHandler.emitEvent(o.length>0?V.t.ACQUIRE_TOKEN_START:V.t.LOGIN_START,v.s_.Popup,e),s=this.canUseNative(e)?this.acquireTokenNative({...e,correlationId:t},v.WN.acquireTokenPopup).then(c=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:c.requestId,accountType:Ee(c.account)}),c)).catch(c=>{if(c instanceof Ie&&Pe(c))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(c instanceof F.Yo)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):this.createPopupClient(t).acquireToken(e),s.then(c=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(V.t.LOGIN_SUCCESS,v.s_.Popup,c):this.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_SUCCESS,v.s_.Popup,c),n.end({success:!0,requestId:c.requestId,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,accountType:Ee(c.account)}),c)).catch(c=>(this.eventHandler.emitEvent(o.length>0?V.t.ACQUIRE_TOKEN_FAILURE:V.t.LOGIN_FAILURE,v.s_.Popup,null,c),n.end({success:!1},c),Promise.reject(c)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e),o={...e,prompt:e.prompt,correlationId:n};let s;return(0,oe.ZC)(t.initialized),t.ssoSilentMeasurement=t.performanceClient.startMeasurement(T.Ak.SsoSilent,n),t.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),t.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Ee(e.account)}),document.addEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement),t.logger.verbose("ssoSilent called",n),t.eventHandler.emitEvent(V.t.SSO_SILENT_START,v.s_.Silent,o),s=t.canUseNative(o)?t.acquireTokenNative(o,v.WN.ssoSilent).catch(c=>{if(c instanceof Ie&&Pe(c))return t.nativeExtensionProvider=void 0,t.createSilentIframeClient(o.correlationId).acquireToken(o);throw c}):t.createSilentIframeClient(o.correlationId).acquireToken(o),s.then(c=>(t.eventHandler.emitEvent(V.t.SSO_SILENT_SUCCESS,v.s_.Silent,c),t.ssoSilentMeasurement?.end({success:!0,isNativeBroker:c.fromNativeBroker,requestId:c.requestId,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,accountType:Ee(c.account)}),c)).catch(c=>{throw t.eventHandler.emitEvent(V.t.SSO_SILENT_FAILURE,v.s_.Silent,null,c),t.ssoSilentMeasurement?.end({success:!1},c),c}).finally(()=>{document.removeEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement)})})()}acquireTokenByCode(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);t.logger.trace("acquireTokenByCode called",n),(0,oe.ZC)(t.initialized),t.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_BY_CODE_START,v.s_.Silent,e);const o=t.performanceClient.startMeasurement(T.Ak.AcquireTokenByCode,n);o.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw(0,Y.Z_)(q.LL);if(e.code){const s=e.code;let c=t.hybridAuthCodeResponses.get(s);return c?(t.logger.verbose("Existing acquireTokenByCode request found",n),o.discard()):(t.logger.verbose("Initiating new acquireTokenByCode request",n),c=t.acquireTokenByCodeAsync({...e,correlationId:n}).then(i=>(t.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_BY_CODE_SUCCESS,v.s_.Silent,i),t.hybridAuthCodeResponses.delete(s),o.end({success:!0,isNativeBroker:i.fromNativeBroker,requestId:i.requestId,accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length,accountType:Ee(i.account)}),i)).catch(i=>{throw t.hybridAuthCodeResponses.delete(s),t.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,v.s_.Silent,null,i),o.end({success:!1},i),i}),t.hybridAuthCodeResponses.set(s,c)),yield c}if(e.nativeAccountId){if(t.canUseNative(e,e.nativeAccountId)){const s=yield t.acquireTokenNative({...e,correlationId:n},v.WN.acquireTokenByCode,e.nativeAccountId).catch(c=>{throw c instanceof Ie&&Pe(c)&&(t.nativeExtensionProvider=void 0),c});return o.end({accountType:Ee(s.account),success:!0}),s}throw(0,Y.Z_)(q.KA)}throw(0,Y.Z_)(q.Dy)}catch(s){throw t.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,v.s_.Silent,null,s),o.end({success:!1},s),s}})()}acquireTokenByCodeAsync(e){var t=this;return(0,l.Z)(function*(){return t.logger.trace("acquireTokenByCodeAsync called",e.correlationId),t.acquireTokenByCodeAsyncMeasurement=t.performanceClient.startMeasurement(T.Ak.AcquireTokenByCodeAsync,e.correlationId),t.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement),yield t.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(s=>(t.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker,requestId:s.requestId}),s)).catch(s=>{throw t.acquireTokenByCodeAsyncMeasurement?.end({success:!1},s),s}).finally(()=>{document.removeEventListener("visibilitychange",t.trackPageVisibilityWithMeasurement)})})()}acquireTokenFromCache(e,t){var n=this;return(0,l.Z)(function*(){switch(n.performanceClient.addQueueMeasurement(T.Ak.AcquireTokenFromCache,e.correlationId),t){case v.lu.Default:case v.lu.AccessToken:case v.lu.AccessTokenAndRefreshToken:const o=n.createSilentCacheClient(e.correlationId);return h(o.acquireToken.bind(o),T.Ak.SilentCacheClientAcquireToken,n.logger,n.performanceClient,e.correlationId)(e);default:throw(0,b.zP)(S.s$)}})()}acquireTokenByRefreshToken(e,t){var n=this;return(0,l.Z)(function*(){switch(n.performanceClient.addQueueMeasurement(T.Ak.AcquireTokenByRefreshToken,e.correlationId),t){case v.lu.Default:case v.lu.AccessTokenAndRefreshToken:case v.lu.RefreshToken:case v.lu.RefreshTokenAndNetwork:const o=n.createSilentRefreshClient(e.correlationId);return h(o.acquireToken.bind(o),T.Ak.SilentRefreshClientAcquireToken,n.logger,n.performanceClient,e.correlationId)(e);default:throw(0,b.zP)(S.s$)}})()}acquireTokenBySilentIframe(e){var t=this;return(0,l.Z)(function*(){t.performanceClient.addQueueMeasurement(T.Ak.AcquireTokenBySilentIframe,e.correlationId);const n=t.createSilentIframeClient(e.correlationId);return h(n.acquireToken.bind(n),T.Ak.SilentIframeClientAcquireToken,t.logger,t.performanceClient,e.correlationId)(e)})()}logout(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);return t.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),t.logoutRedirect({correlationId:n,...e})})()}logoutRedirect(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);return(0,oe.ER)(t.initialized,t.config),t.browserStorage.setInteractionInProgress(!0),t.createRedirectClient(n).logout(e)})()}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return(0,oe.ZC)(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}clearCache(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);return t.createSilentCacheClient(n).logout(e)})()}getAllAccounts(e){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts(e):[]}getAccount(e){if(this.logger.trace("getAccount called"),0===Object.keys(e).length)return this.logger.warning("getAccount: No accountFilter provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy(e);return t?(this.logger.verbose("getAccount: Account matching provided filter found, returning"),t):(this.logger.verbose("getAccount: No matching account found, returning null"),null)}getAccountByUsername(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)}getAccountByHomeId(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)}getAccountByLocalId(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)}setActiveAccount(e){this.browserStorage.setActiveAccount(e)}getActiveAccount(){return this.browserStorage.getActiveAccount()}hydrateCache(e,t){var n=this;return(0,l.Z)(function*(){n.logger.verbose("hydrateCache called");const o=w.r.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return n.browserStorage.setAccount(o),e.fromNativeBroker?(n.logger.verbose("Response was from native broker, storing in-memory"),n.nativeInternalStorage.hydrateCache(e,t)):n.browserStorage.hydrateCache(e,t)})()}acquireTokenNative(e,t,n){var o=this;return(0,l.Z)(function*(){if(o.logger.trace("acquireTokenNative called"),!o.nativeExtensionProvider)throw(0,Y.Z_)(q.V7);return new Ue(o.config,o.browserStorage,o.browserCrypto,o.logger,o.eventHandler,o.navigationClient,t,o.performanceClient,o.nativeExtensionProvider,n||o.getNativeAccountId(e),o.nativeInternalStorage,e.correlationId).acquireToken(e)})()}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Ce.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case d.NJ.NONE:case d.NJ.CONSENT:case d.NJ.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Yt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Qt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Rt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,v.WN.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new it(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new at(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,v.WN.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?(0,Ae.nn)():d.gT.EMPTY_STRING}loginRedirect(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e);return t.logger.verbose("loginRedirect called",n),t.acquireTokenRedirect({correlationId:n,...e||v.yo})})()}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||v.yo})}acquireTokenSilent(e){var t=this;return(0,l.Z)(function*(){const n=t.getRequestCorrelationId(e),o=t.performanceClient.startMeasurement(T.Ak.AcquireTokenSilent,n);o.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),(0,oe.ZC)(t.initialized),t.logger.verbose("acquireTokenSilent called",n);const s=e.account||t.getActiveAccount();if(!s)throw(0,Y.Z_)(q.wH);o.add({accountType:Ee(s)});const i=JSON.stringify({clientId:t.config.auth.clientId,authority:e.authority||d.gT.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions}),g=t.activeSilentTokenRequests.get(i);if(typeof g>"u"){t.logger.verbose("acquireTokenSilent called for the first time, storing active request",n);const a=h(t.acquireTokenSilentAsync.bind(t),T.Ak.AcquireTokenSilentAsync,t.logger,t.performanceClient,n)({...e,correlationId:n},s).then(u=>(t.activeSilentTokenRequests.delete(i),o.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:u.requestId,accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),u)).catch(u=>{throw t.activeSilentTokenRequests.delete(i),o.end({success:!1},u),u});return t.activeSilentTokenRequests.set(i,a),{...yield a,state:e.state}}return t.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),o.discard(),{...yield g,state:e.state}})()}acquireTokenSilentAsync(e,t){var n=this;return(0,l.Z)(function*(){n.performanceClient.addQueueMeasurement(T.Ak.AcquireTokenSilentAsync,e.correlationId),n.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_START,v.s_.Silent,e),e.correlationId&&n.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",()=>n.trackPageVisibility(e.correlationId));const o=yield h(Lt,T.Ak.InitializeSilentRequest,n.logger,n.performanceClient,e.correlationId)(e,t,n.config,n.performanceClient,n.logger),s=e.cacheLookupPolicy||v.lu.Default;return n.acquireTokenSilentNoIframe(o,s).catch(function(){var i=(0,l.Z)(function*(g){if(function Xt(y,e){const o=!(y instanceof F.Yo&&y.subError!==D.nl)&&(y.errorCode===v.qx.INVALID_GRANT_ERROR||y.errorCode===S.s$)||y.errorCode===D.I2||y.errorCode===D.Tw,s=v.se.includes(e);return o&&s}(g,s)){if(n.activeIframeRequest){if(s!==v.lu.Skip){const[u,p]=n.activeIframeRequest;n.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${p}`,o.correlationId);const E=n.performanceClient.startMeasurement(T.Ak.AwaitConcurrentIframe,o.correlationId);E.add({awaitIframeCorrelationId:p});const L=yield u;if(E.end({success:L}),L)return n.logger.verbose(`Parallel iframe request with correlationId: ${p} succeeded. Retrying cache and/or RT redemption`,o.correlationId),n.acquireTokenSilentNoIframe(o,s);throw n.logger.info(`Iframe request with correlationId: ${p} failed. Interaction is required.`),g}return n.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),h(n.acquireTokenBySilentIframe.bind(n),T.Ak.AcquireTokenBySilentIframe,n.logger,n.performanceClient,o.correlationId)(o)}{let u;return n.activeIframeRequest=[new Promise(p=>{u=p}),o.correlationId],n.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),h(n.acquireTokenBySilentIframe.bind(n),T.Ak.AcquireTokenBySilentIframe,n.logger,n.performanceClient,o.correlationId)(o).then(p=>(u(!0),p)).catch(p=>{throw u(!1),p}).finally(()=>{n.activeIframeRequest=void 0})}}throw g});return function(g){return i.apply(this,arguments)}}()).then(i=>(n.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_SUCCESS,v.s_.Silent,i),e.correlationId&&n.performanceClient.addFields({fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker,requestId:i.requestId},e.correlationId),i)).catch(i=>{throw n.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_FAILURE,v.s_.Silent,null,i),i}).finally(()=>{document.removeEventListener("visibilitychange",()=>n.trackPageVisibility(e.correlationId))})})()}acquireTokenSilentNoIframe(e,t){var n=this;return(0,l.Z)(function*(){return Ce.isNativeAvailable(n.config,n.logger,n.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(n.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),n.acquireTokenNative(e,v.WN.acquireTokenSilent_silentFlow).catch(function(){var o=(0,l.Z)(function*(s){throw s instanceof Ie&&Pe(s)?(n.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),n.nativeExtensionProvider=void 0,(0,b.zP)(S.s$)):s});return function(s){return o.apply(this,arguments)}}())):(n.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),h(n.acquireTokenFromCache.bind(n),T.Ak.AcquireTokenFromCache,n.logger,n.performanceClient,e.correlationId)(e,t).catch(o=>{if(t===v.lu.AccessToken)throw o;return n.eventHandler.emitEvent(V.t.ACQUIRE_TOKEN_NETWORK_START,v.s_.Silent,e),h(n.acquireTokenByRefreshToken.bind(n),T.Ak.AcquireTokenByRefreshToken,n.logger,n.performanceClient,e.correlationId)(e,t)}))})()}}},717:(X,z,m)=>{m.d(z,{$5:()=>O,Au:()=>P,Fv:()=>T,Mg:()=>K,PP:()=>h,Wu:()=>w,Xx:()=>H,nn:()=>M,qz:()=>G});var l=m(5861),A=m(9141),R=m(905),U=m(8468),N=m(3675),I=m(9238);const d="SHA-256",r=new Uint8Array([1,0,1]),_="0123456789abcdef",B=new Uint32Array(1),Q={name:"RSASSA-PKCS1-v1_5",hash:d,modulusLength:2048,publicExponent:r};function G(Z){if(!("crypto"in window))throw Z.error("BrowserCrypto: crypto interface is unavailable"),(0,A.Z_)(I.TR);Z.verbose("BrowserCrypto: modern crypto interface available")}function T(Z,j,J){return W.apply(this,arguments)}function W(){return(W=(0,l.Z)(function*(Z,j,J){j?.addQueueMeasurement(R.Ak.Sha256Digest,J);const ne=(new TextEncoder).encode(Z);return window.crypto.subtle.digest(d,ne)})).apply(this,arguments)}function h(Z){return window.crypto.getRandomValues(Z)}function f(){return window.crypto.getRandomValues(B),B[0]}function M(){const Z=Date.now(),j=1024*f()+(1023&f()),J=new Uint8Array(16),te=Math.trunc(j/2**30),ne=j&2**30-1,re=f();J[0]=Z/2**40,J[1]=Z/2**32,J[2]=Z/2**24,J[3]=Z/65536,J[4]=Z/256,J[5]=Z,J[6]=112|te>>>8,J[7]=te,J[8]=128|ne>>>24,J[9]=ne>>>16,J[10]=ne>>>8,J[11]=ne,J[12]=re>>>24,J[13]=re>>>16,J[14]=re>>>8,J[15]=re;let ue="";for(let Y=0;Y<J.length;Y++)ue+=_.charAt(J[Y]>>>4),ue+=_.charAt(15&J[Y]),(3===Y||5===Y||7===Y||9===Y)&&(ue+="-");return ue}function P(Z,j){return S.apply(this,arguments)}function S(){return(S=(0,l.Z)(function*(Z,j){return window.crypto.subtle.generateKey(Q,Z,j)})).apply(this,arguments)}function K(Z){return k.apply(this,arguments)}function k(){return(k=(0,l.Z)(function*(Z){return window.crypto.subtle.exportKey(U.Mm,Z)})).apply(this,arguments)}function O(Z,j,J){return x.apply(this,arguments)}function x(){return(x=(0,l.Z)(function*(Z,j,J){return window.crypto.subtle.importKey(U.Mm,Z,Q,j,J)})).apply(this,arguments)}function H(Z,j){return F.apply(this,arguments)}function F(){return(F=(0,l.Z)(function*(Z,j){return window.crypto.subtle.sign(Q,Z,j)})).apply(this,arguments)}function w(Z){return D.apply(this,arguments)}function D(){return(D=(0,l.Z)(function*(Z){const j=yield T(Z),J=new Uint8Array(j);return(0,N.Wy)(J)})).apply(this,arguments)}},3540:(X,z,m)=>{m.d(z,{Q:()=>P});var l=m(5861),A=m(905),R=m(4191);const U="missing_kid_error",N="missing_alg_error",I={[U]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[N]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class b extends R.l4{constructor(k,O){super(k,O),this.name="JoseHeaderError",Object.setPrototypeOf(this,b.prototype)}}function d(K){return new b(K,I[K])}var C=m(9128);class r{constructor(k){this.typ=k.typ,this.alg=k.alg,this.kid=k.kid}static getShrHeaderString(k){if(!k.kid)throw d(U);if(!k.alg)throw d(N);const O=new r({typ:k.typ||C.xd.Pop,kid:k.kid,alg:k.alg});return JSON.stringify(O)}}var _=m(3675),B=m(3830),Q=m(717),G=m(9141),T=m(8468),W=m(9238);class h{constructor(){this.dbName=T.H4,this.version=T.kd,this.tableName=T.Gv,this.dbOpen=!1}open(){var k=this;return(0,l.Z)(function*(){return new Promise((O,x)=>{const H=window.indexedDB.open(k.dbName,k.version);H.addEventListener("upgradeneeded",F=>{F.target.result.createObjectStore(k.tableName)}),H.addEventListener("success",F=>{k.db=F.target.result,k.dbOpen=!0,O()}),H.addEventListener("error",()=>x((0,G.Z_)(W.Pi)))})})()}closeConnection(){const k=this.db;k&&this.dbOpen&&(k.close(),this.dbOpen=!1)}validateDbIsOpen(){var k=this;return(0,l.Z)(function*(){if(!k.dbOpen)return k.open()})()}getItem(k){var O=this;return(0,l.Z)(function*(){return yield O.validateDbIsOpen(),new Promise((x,H)=>{if(!O.db)return H((0,G.Z_)(W.IL));const D=O.db.transaction([O.tableName],"readonly").objectStore(O.tableName).get(k);D.addEventListener("success",Z=>{const j=Z;O.closeConnection(),x(j.target.result)}),D.addEventListener("error",Z=>{O.closeConnection(),H(Z)})})})()}setItem(k,O){var x=this;return(0,l.Z)(function*(){return yield x.validateDbIsOpen(),new Promise((H,F)=>{if(!x.db)return F((0,G.Z_)(W.IL));const Z=x.db.transaction([x.tableName],"readwrite").objectStore(x.tableName).put(O,k);Z.addEventListener("success",()=>{x.closeConnection(),H()}),Z.addEventListener("error",j=>{x.closeConnection(),F(j)})})})()}removeItem(k){var O=this;return(0,l.Z)(function*(){return yield O.validateDbIsOpen(),new Promise((x,H)=>{if(!O.db)return H((0,G.Z_)(W.IL));const D=O.db.transaction([O.tableName],"readwrite").objectStore(O.tableName).delete(k);D.addEventListener("success",()=>{O.closeConnection(),x()}),D.addEventListener("error",Z=>{O.closeConnection(),H(Z)})})})()}getKeys(){var k=this;return(0,l.Z)(function*(){return yield k.validateDbIsOpen(),new Promise((O,x)=>{if(!k.db)return x((0,G.Z_)(W.IL));const w=k.db.transaction([k.tableName],"readonly").objectStore(k.tableName).getAllKeys();w.addEventListener("success",D=>{const Z=D;k.closeConnection(),O(Z.target.result)}),w.addEventListener("error",D=>{k.closeConnection(),x(D)})})})()}containsKey(k){var O=this;return(0,l.Z)(function*(){return yield O.validateDbIsOpen(),new Promise((x,H)=>{if(!O.db)return H((0,G.Z_)(W.IL));const D=O.db.transaction([O.tableName],"readonly").objectStore(O.tableName).count(k);D.addEventListener("success",Z=>{const j=Z;O.closeConnection(),x(1===j.target.result)}),D.addEventListener("error",Z=>{O.closeConnection(),H(Z)})})})()}deleteDatabase(){var k=this;return(0,l.Z)(function*(){return k.db&&k.dbOpen&&k.closeConnection(),new Promise((O,x)=>{const H=window.indexedDB.deleteDatabase(T.H4),F=setTimeout(()=>x(!1),200);H.addEventListener("success",()=>(clearTimeout(F),O(!0))),H.addEventListener("blocked",()=>(clearTimeout(F),O(!0))),H.addEventListener("error",()=>(clearTimeout(F),x(!1)))})})()}}var f=m(6555);class M{constructor(k){this.inMemoryCache=new f.k,this.indexedDBCache=new h,this.logger=k}handleDatabaseAccessError(k){if(!(k instanceof G.Ut&&k.errorCode===W.Pi))throw k;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}getItem(k){var O=this;return(0,l.Z)(function*(){const x=O.inMemoryCache.getItem(k);if(!x)try{return O.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield O.indexedDBCache.getItem(k)}catch(H){O.handleDatabaseAccessError(H)}return x})()}setItem(k,O){var x=this;return(0,l.Z)(function*(){x.inMemoryCache.setItem(k,O);try{yield x.indexedDBCache.setItem(k,O)}catch(H){x.handleDatabaseAccessError(H)}})()}removeItem(k){var O=this;return(0,l.Z)(function*(){O.inMemoryCache.removeItem(k);try{yield O.indexedDBCache.removeItem(k)}catch(x){O.handleDatabaseAccessError(x)}})()}getKeys(){var k=this;return(0,l.Z)(function*(){const O=k.inMemoryCache.getKeys();if(0===O.length)try{return k.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield k.indexedDBCache.getKeys()}catch(x){k.handleDatabaseAccessError(x)}return O})()}containsKey(k){var O=this;return(0,l.Z)(function*(){const x=O.inMemoryCache.containsKey(k);if(!x)try{return O.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield O.indexedDBCache.containsKey(k)}catch(H){O.handleDatabaseAccessError(H)}return x})()}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){var k=this;return(0,l.Z)(function*(){try{k.logger.verbose("Deleting persistent keystore");const O=yield k.indexedDBCache.deleteDatabase();return O&&k.logger.verbose("Persistent keystore deleted"),O}catch(O){return k.handleDatabaseAccessError(O),!1}})()}}let P=(()=>{class K{constructor(O,x){this.logger=O,(0,Q.qz)(O),this.cache=new M(this.logger),this.performanceClient=x}createNewGuid(){return(0,Q.nn)()}base64Encode(O){return(0,_.h$)(O)}base64Decode(O){return(0,B.t)(O)}getPublicKeyThumbprint(O){var x=this;return(0,l.Z)(function*(){const H=x.performanceClient?.startMeasurement(A.Ak.CryptoOptsGetPublicKeyThumbprint,O.correlationId),F=yield(0,Q.Au)(K.EXTRACTABLE,K.POP_KEY_USAGES),w=yield(0,Q.Mg)(F.publicKey),Z=S({e:w.e,kty:w.kty,n:w.n}),j=yield x.hashString(Z),J=yield(0,Q.Mg)(F.privateKey),te=yield(0,Q.$5)(J,!1,["sign"]);return yield x.cache.setItem(j,{privateKey:te,publicKey:F.publicKey,requestMethod:O.resourceRequestMethod,requestUri:O.resourceRequestUri}),H&&H.end({success:!0}),j})()}removeTokenBindingKey(O){var x=this;return(0,l.Z)(function*(){return yield x.cache.removeItem(O),!(yield x.cache.containsKey(O))})()}clearKeystore(){var O=this;return(0,l.Z)(function*(){O.cache.clearInMemory();try{return yield O.cache.clearPersistent(),!0}catch(x){return x instanceof Error?O.logger.error(`Clearing keystore failed with error: ${x.message}`):O.logger.error("Clearing keystore failed with unknown error"),!1}})()}signJwt(O,x,H,F){var w=this;return(0,l.Z)(function*(){const D=w.performanceClient?.startMeasurement(A.Ak.CryptoOptsSignJwt,F),Z=yield w.cache.getItem(x);if(!Z)throw(0,G.Z_)(W.XM);const j=yield(0,Q.Mg)(Z.publicKey),J=S(j),te=(0,_._j)(JSON.stringify({kid:x})),ne=r.getShrHeaderString({...H?.header,alg:j.alg,kid:te}),re=(0,_._j)(ne);O.cnf={jwk:JSON.parse(J)};const Y=`${re}.${(0,_._j)(JSON.stringify(O))}`,se=(new TextEncoder).encode(Y),we=yield(0,Q.Xx)(Z.privateKey,se),ye=`${Y}.${(0,_.Wy)(new Uint8Array(we))}`;return D&&D.end({success:!0}),ye})()}hashString(O){return(0,l.Z)(function*(){return(0,Q.Wu)(O)})()}}return K.POP_KEY_USAGES=["sign","verify"],K.EXTRACTABLE=!0,K})();function S(K){return JSON.stringify(K,Object.keys(K).sort())}},3830:(X,z,m)=>{m.d(z,{t:()=>R});var l=m(9141),A=m(9238);function R(N){return(new TextDecoder).decode(function U(N){let I=N.replace(/-/g,"+").replace(/_/g,"/");switch(I.length%4){case 0:break;case 2:I+="==";break;case 3:I+="=";break;default:throw(0,l.Z_)(A.lZ)}const b=atob(I);return Uint8Array.from(b,d=>d.codePointAt(0)||0)}(N))}},3675:(X,z,m)=>{function l(N){return encodeURIComponent(R(N).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function A(N){return U(N).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function R(N){return U((new TextEncoder).encode(N))}function U(N){const I=Array.from(N,b=>String.fromCodePoint(b)).join("");return btoa(I)}m.d(z,{Wy:()=>A,_j:()=>l,h$:()=>R})},2573:(X,z,m)=>{m.d(z,{b:()=>I});var l=m(9128),A=m(7712),R=m(5764),U=m(6521),N=m(717);class I{constructor(d,C){this.eventCallbacks=new Map,this.logger=d,this.browserCrypto=C,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(d){if(typeof window<"u"){const C=(0,N.nn)();return this.eventCallbacks.set(C,d),this.logger.verbose(`Event callback registered with id: ${C}`),C}return null}removeEventCallback(d){this.eventCallbacks.delete(d),this.logger.verbose(`Event callback ${d} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(d,C,r,_){if(typeof window<"u"){const B={eventType:d,interactionType:C||null,payload:r||null,error:_||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${d}`),this.eventCallbacks.forEach((Q,G)=>{this.logger.verbose(`Emitting event to callback ${G}: ${d}`),Q.apply(null,[B])})}}handleAccountCacheChange(d){try{d.key?.includes(l.Vi.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(U.t.ACTIVE_ACCOUNT_CHANGED);const C=d.newValue||d.oldValue;if(!C)return;const r=JSON.parse(C);if("object"!=typeof r||!A.r.isAccountEntity(r))return;const B=R.L.toObject(new A.r,r).getAccountInfo();!d.oldValue&&d.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(U.t.ACCOUNT_ADDED,void 0,B)):!d.newValue&&d.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(U.t.ACCOUNT_REMOVED,void 0,B))}catch{return}}}},6521:(X,z,m)=>{m.d(z,{t:()=>l});const l={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"}},9509:(X,z,m)=>{m.d(z,{i:()=>A,u:()=>l});const l="@azure/msal-browser",A="3.14.0"},2888:(X,z,m)=>{function l(U,N){return!!U&&!!N&&U===N.split(".")[1]}function A(U,N){const{oid:I,sub:b,tid:d,name:C,tfp:r,acr:_}=N,B=d||r||_||"";return{tenantId:B,localAccountId:I||b||"",name:C,isHomeTenant:l(B,U)}}function R(U,N,I,b){let d=U;if(N){const{isHomeTenant:C,...r}=N;d={...U,...r}}if(I){const{isHomeTenant:C,...r}=A(U.homeAccountId,I);return d={...d,...r,idTokenClaims:I,idToken:b},d}return d}m.d(z,{$f:()=>R,Hc:()=>l,SI:()=>A})},2103:(X,z,m)=>{m.d(z,{Z_:()=>R,ky:()=>N});var l=m(464),A=m(2224);function R(I,b){const d=function U(I){if(!I)throw(0,l.zP)(A.PM);const d=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(I);if(!d||d.length<4)throw(0,l.zP)(A.GH);return d[2]}(I);try{const C=b(d);return JSON.parse(C)}catch{throw(0,l.zP)(A.GH)}}function N(I,b){if(0===b||Date.now()-3e5>I+b)throw(0,l.zP)(A.Ao)}},9947:(X,z,m)=>{m.d(z,{B:()=>U,j:()=>N});var l=m(464),A=m(9128),R=m(2224);function U(I,b){if(!I)throw(0,l.zP)(R.S7);try{const d=b(I);return JSON.parse(d)}catch{throw(0,l.zP)(R.ZE)}}function N(I){if(!I)throw(0,l.zP)(R.ZE);const b=I.split(A.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:b[0],utid:b.length<2?A.gT.EMPTY_STRING:b[1]}}},4918:(X,z,m)=>{function l(A){return A&&(A.tid||A.tfp||A.acr)||null}m.d(z,{M:()=>l})},7247:(X,z,m)=>{m.d(z,{Qh:()=>U,_u:()=>b,eM:()=>r,ix:()=>C,wn:()=>I});var l=m(3886),A=m(9128);const U={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},N={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},I=new Set;function b(_,B){let Q;const G=_.canonicalAuthority;if(G){const T=new l.G(G).getUrlComponents().HostNameAndPort;Q=d(T,_.cloudDiscoveryMetadata?.metadata,A.pQ.CONFIG,B)||d(T,N.metadata,A.pQ.HARDCODED_VALUES,B)||_.knownAuthorities}return Q||[]}function d(_,B,Q,G){if(G?.trace(`getAliasesFromMetadata called with source: ${Q}`),_&&B){const T=r(B,_);if(T)return G?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${Q}, returning aliases`),T.aliases;G?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${Q}`)}return null}function C(_){return r(N.metadata,_)}function r(_,B){for(let Q=0;Q<_.length;Q++){const G=_[Q];if(G.aliases.includes(B))return G}return null}N.metadata.forEach(_=>{_.aliases.forEach(B=>{I.add(B)})})},6145:(X,z,m)=>{m.d(z,{z:()=>l});const l={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"}},842:(X,z,m)=>{m.d(z,{a:()=>l});const l={Default:0,Adfs:1,Dsts:2,Ciam:3}},1763:(X,z,m)=>{m.d(z,{A:()=>l});const l={AAD:"AAD",OIDC:"OIDC"}},5764:(X,z,m)=>{m.d(z,{L:()=>G,w:()=>T});var l=m(5861),A=m(9128),R=m(1783),U=m(4226),N=m(7712),I=m(464),b=m(2888),d=m(2103),C=m(8144),r=m(7247),_=m(5183),B=m(2224),Q=m(7798);class G{constructor(h,f,M,P){this.clientId=h,this.cryptoImpl=f,this.commonLogger=M.clone(C.u,C.i),this.staticAuthorityOptions=P}getAllAccounts(h){return this.buildTenantProfiles(this.getAccountsFilteredBy(h||{}),h)}getAccountInfoFilteredBy(h){const f=this.getAllAccounts(h);return f.length>1?f.sort(P=>P.idTokenClaims?-1:1)[0]:1===f.length?f[0]:null}getBaseAccountInfo(h){const f=this.getAccountsFilteredBy(h);return f.length>0?f[0].getAccountInfo():null}buildTenantProfiles(h,f){return h.flatMap(M=>this.getAccountInfoForTenantProfiles(M,f))}getAccountInfoForTenantProfiles(h,f){return this.getTenantProfilesFromAccountEntity(h,f?.tenantId,f)}getTenantedAccountInfoByFilter(h,f,M,P){let K,S=null;if(P&&!this.tenantProfileMatchesFilter(M,P))return null;const k=this.getIdToken(h,f,M.tenantId);return k&&(K=(0,d.Z_)(k.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(K,P))?null:(S=(0,b.$f)(h,M,K,k?.secret),S)}getTenantProfilesFromAccountEntity(h,f,M){const P=h.getAccountInfo();let S=P.tenantProfiles||new Map;const K=this.getTokenKeys();if(f){const O=S.get(f);if(!O)return[];S=new Map([[f,O]])}const k=[];return S.forEach(O=>{const x=this.getTenantedAccountInfoByFilter(P,K,O,M);x&&k.push(x)}),k}tenantProfileMatchesFilter(h,f){return!(f.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(h,f.localAccountId)||f.name&&h.name!==f.name||void 0!==f.isHomeTenant&&h.isHomeTenant!==f.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(h,f){return!(f&&(f.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(h,f.localAccountId)||f.loginHint&&!this.matchLoginHintFromTokenClaims(h,f.loginHint)||f.username&&!this.matchUsername(h.preferred_username,f.username)||f.name&&!this.matchName(h,f.name)||f.sid&&!this.matchSid(h,f.sid)))}saveCacheRecord(h,f,M){var P=this;return(0,l.Z)(function*(){if(!h)throw(0,I.zP)(B.mj);try{h.account&&P.setAccount(h.account),h.idToken&&!1!==f?.idToken&&P.setIdTokenCredential(h.idToken),h.accessToken&&!1!==f?.accessToken&&(yield P.saveAccessToken(h.accessToken)),h.refreshToken&&!1!==f?.refreshToken&&P.setRefreshTokenCredential(h.refreshToken),h.appMetadata&&P.setAppMetadata(h.appMetadata)}catch(S){throw P.commonLogger?.error("CacheManager.saveCacheRecord: failed"),S instanceof Error?(P.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${S.message}`,M),"QuotaExceededError"===S.name||"NS_ERROR_DOM_QUOTA_REACHED"===S.name||S.message.includes("exceeded the quota")?(P.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",M),new _.ju(Q.b)):new _.ju(S.name,S.message)):(P.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${S}`,M),new _.ju(Q.K))}})()}saveAccessToken(h){var f=this;return(0,l.Z)(function*(){const M={clientId:h.clientId,credentialType:h.credentialType,environment:h.environment,homeAccountId:h.homeAccountId,realm:h.realm,tokenType:h.tokenType,requestedClaimsHash:h.requestedClaimsHash},P=f.getTokenKeys(),S=U.i.fromString(h.target),K=[];P.accessToken.forEach(k=>{if(!f.accessTokenKeyMatchesFilter(k,M,!1))return;const O=f.getAccessTokenCredential(k);O&&f.credentialMatchesFilter(O,M)&&U.i.fromString(O.target).intersectingScopeSets(S)&&K.push(f.removeAccessToken(k))}),yield Promise.all(K),f.setAccessTokenCredential(h)})()}getAccountsFilteredBy(h){const f=this.getAccountKeys(),M=[];return f.forEach(P=>{if(!this.isAccountKey(P,h.homeAccountId))return;const S=this.getAccount(P,this.commonLogger);if(!S||h.homeAccountId&&!this.matchHomeAccountId(S,h.homeAccountId)||h.username&&!this.matchUsername(S.username,h.username)||h.environment&&!this.matchEnvironment(S,h.environment)||h.realm&&!this.matchRealm(S,h.realm)||h.nativeAccountId&&!this.matchNativeAccountId(S,h.nativeAccountId)||h.authorityType&&!this.matchAuthorityType(S,h.authorityType))return;const K={localAccountId:h?.localAccountId,name:h?.name},k=S.tenantProfiles?.filter(O=>this.tenantProfileMatchesFilter(O,K));k&&0===k.length||M.push(S)}),M}isAccountKey(h,f,M){return!(h.split(A.Bv.CACHE_KEY_SEPARATOR).length<3||f&&!h.toLowerCase().includes(f.toLowerCase())||M&&!h.toLowerCase().includes(M.toLowerCase()))}isCredentialKey(h){if(h.split(A.Bv.CACHE_KEY_SEPARATOR).length<6)return!1;const f=h.toLowerCase();if(-1===f.indexOf(A.d3.ID_TOKEN.toLowerCase())&&-1===f.indexOf(A.d3.ACCESS_TOKEN.toLowerCase())&&-1===f.indexOf(A.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===f.indexOf(A.d3.REFRESH_TOKEN.toLowerCase()))return!1;if(f.indexOf(A.d3.REFRESH_TOKEN.toLowerCase())>-1){const P=`${A.d3.REFRESH_TOKEN}${A.Bv.CACHE_KEY_SEPARATOR}${A.ch}${A.Bv.CACHE_KEY_SEPARATOR}`;if(-1===f.indexOf(`${A.d3.REFRESH_TOKEN}${A.Bv.CACHE_KEY_SEPARATOR}${this.clientId}${A.Bv.CACHE_KEY_SEPARATOR}`.toLowerCase())&&-1===f.indexOf(P.toLowerCase()))return!1}else if(-1===f.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(h,f){return!(f.clientId&&!this.matchClientId(h,f.clientId)||f.userAssertionHash&&!this.matchUserAssertionHash(h,f.userAssertionHash)||"string"==typeof f.homeAccountId&&!this.matchHomeAccountId(h,f.homeAccountId)||f.environment&&!this.matchEnvironment(h,f.environment)||f.realm&&!this.matchRealm(h,f.realm)||f.credentialType&&!this.matchCredentialType(h,f.credentialType)||f.familyId&&!this.matchFamilyId(h,f.familyId)||f.target&&!this.matchTarget(h,f.target)||(f.requestedClaimsHash||h.requestedClaimsHash)&&h.requestedClaimsHash!==f.requestedClaimsHash||h.credentialType===A.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(f.tokenType&&!this.matchTokenType(h,f.tokenType)||f.tokenType===A.hO.SSH&&f.keyId&&!this.matchKeyId(h,f.keyId)))}getAppMetadataFilteredBy(h){const f=this.getKeys(),M={};return f.forEach(P=>{if(!this.isAppMetadata(P))return;const S=this.getAppMetadata(P);S&&(h.environment&&!this.matchEnvironment(S,h.environment)||h.clientId&&!this.matchClientId(S,h.clientId)||(M[P]=S))}),M}getAuthorityMetadataByAlias(h){const f=this.getAuthorityMetadataKeys();let M=null;return f.forEach(P=>{if(!this.isAuthorityMetadata(P)||-1===P.indexOf(this.clientId))return;const S=this.getAuthorityMetadata(P);S&&-1!==S.aliases.indexOf(h)&&(M=S)}),M}removeAllAccounts(){var h=this;return(0,l.Z)(function*(){const f=h.getAccountKeys(),M=[];f.forEach(P=>{M.push(h.removeAccount(P))}),yield Promise.all(M)})()}removeAccount(h){var f=this;return(0,l.Z)(function*(){const M=f.getAccount(h,f.commonLogger);M&&(yield f.removeAccountContext(M),f.removeItem(h))})()}removeAccountContext(h){var f=this;return(0,l.Z)(function*(){const M=f.getTokenKeys(),P=h.generateAccountId(),S=[];M.idToken.forEach(K=>{0===K.indexOf(P)&&f.removeIdToken(K)}),M.accessToken.forEach(K=>{0===K.indexOf(P)&&S.push(f.removeAccessToken(K))}),M.refreshToken.forEach(K=>{0===K.indexOf(P)&&f.removeRefreshToken(K)}),yield Promise.all(S)})()}updateOutdatedCachedAccount(h,f,M){if(f&&f.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const P=this.getAccountKeys().filter(x=>x.startsWith(f.homeAccountId)),S=[];P.forEach(x=>{const H=this.getCachedAccountEntity(x);H&&S.push(H)});const K=S.find(x=>(0,b.Hc)(x.realm,x.homeAccountId))||S[0];K.tenantProfiles=S.map(x=>({tenantId:x.realm,localAccountId:x.localAccountId,name:x.name,isHomeTenant:(0,b.Hc)(x.realm,x.homeAccountId)}));const k=G.toObject(new N.r,{...K}),O=k.generateAccountKey();return P.forEach(x=>{x!==O&&this.removeOutdatedAccount(h)}),this.setAccount(k),M?.verbose("Updated an outdated account entity in the cache"),k}return f}removeAccessToken(h){var f=this;return(0,l.Z)(function*(){const M=f.getAccessTokenCredential(h);if(M){if(M.credentialType.toLowerCase()===A.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&M.tokenType===A.hO.POP){const S=M.keyId;if(S)try{yield f.cryptoImpl.removeTokenBindingKey(S)}catch{throw(0,I.zP)(B.ol)}}return f.removeItem(h)}})()}removeAppMetadata(){return this.getKeys().forEach(f=>{this.isAppMetadata(f)&&this.removeItem(f)}),!0}readAccountFromCache(h){const f=N.r.generateAccountCacheKey(h);return this.getAccount(f,this.commonLogger)}getIdToken(h,f,M,P,S){this.commonLogger.trace("CacheManager - getIdToken called");const k=this.getIdTokensByFilter({homeAccountId:h.homeAccountId,environment:h.environment,credentialType:A.d3.ID_TOKEN,clientId:this.clientId,realm:M},f),O=k.size;if(O<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(O>1){let x=k;if(!M){const H=new Map;k.forEach((w,D)=>{w.realm===h.tenantId&&H.set(D,w)});const F=H.size;if(F<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),k.values().next().value;if(1===F)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),H.values().next().value;x=H}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),x.forEach((H,F)=>{this.removeIdToken(F)}),P&&S&&P.addFields({multiMatchedID:k.size},S),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),k.values().next().value}getIdTokensByFilter(h,f){const M=f&&f.idToken||this.getTokenKeys().idToken,P=new Map;return M.forEach(S=>{if(!this.idTokenKeyMatchesFilter(S,{clientId:this.clientId,...h}))return;const K=this.getIdTokenCredential(S);K&&this.credentialMatchesFilter(K,h)&&P.set(S,K)}),P}idTokenKeyMatchesFilter(h,f){const M=h.toLowerCase();return!(f.clientId&&-1===M.indexOf(f.clientId.toLowerCase())||f.homeAccountId&&-1===M.indexOf(f.homeAccountId.toLowerCase()))}removeIdToken(h){this.removeItem(h)}removeRefreshToken(h){this.removeItem(h)}getAccessToken(h,f,M,P,S,K){this.commonLogger.trace("CacheManager - getAccessToken called");const k=U.i.createSearchScopes(f.scopes),O=f.authenticationScheme||A.hO.BEARER,x=O&&O.toLowerCase()!==A.hO.BEARER.toLowerCase()?A.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:A.d3.ACCESS_TOKEN,H={homeAccountId:h.homeAccountId,environment:h.environment,credentialType:x,clientId:this.clientId,realm:P||h.tenantId,target:k,tokenType:O,keyId:f.sshKid,requestedClaimsHash:f.requestedClaimsHash},F=M&&M.accessToken||this.getTokenKeys().accessToken,w=[];F.forEach(Z=>{if(this.accessTokenKeyMatchesFilter(Z,H,!0)){const j=this.getAccessTokenCredential(Z);j&&this.credentialMatchesFilter(j,H)&&w.push(j)}});const D=w.length;return D<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):D>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),w.forEach(Z=>{this.removeAccessToken((0,R.Mk)(Z))}),S&&K&&S.addFields({multiMatchedAT:w.length},K),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),w[0])}accessTokenKeyMatchesFilter(h,f,M){const P=h.toLowerCase();if(f.clientId&&-1===P.indexOf(f.clientId.toLowerCase())||f.homeAccountId&&-1===P.indexOf(f.homeAccountId.toLowerCase())||f.realm&&-1===P.indexOf(f.realm.toLowerCase())||f.requestedClaimsHash&&-1===P.indexOf(f.requestedClaimsHash.toLowerCase()))return!1;if(f.target){const S=f.target.asArray();for(let K=0;K<S.length;K++){if(M&&!P.includes(S[K].toLowerCase()))return!1;if(!M&&P.includes(S[K].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(h){const f=this.getTokenKeys(),M=[];return f.accessToken.forEach(P=>{if(!this.accessTokenKeyMatchesFilter(P,h,!0))return;const S=this.getAccessTokenCredential(P);S&&this.credentialMatchesFilter(S,h)&&M.push(S)}),M}getRefreshToken(h,f,M,P,S){this.commonLogger.trace("CacheManager - getRefreshToken called");const k={homeAccountId:h.homeAccountId,environment:h.environment,credentialType:A.d3.REFRESH_TOKEN,clientId:this.clientId,familyId:f?A.ch:void 0},O=M&&M.refreshToken||this.getTokenKeys().refreshToken,x=[];O.forEach(F=>{if(this.refreshTokenKeyMatchesFilter(F,k)){const w=this.getRefreshTokenCredential(F);w&&this.credentialMatchesFilter(w,k)&&x.push(w)}});const H=x.length;return H<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(H>1&&P&&S&&P.addFields({multiMatchedRT:H},S),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),x[0])}refreshTokenKeyMatchesFilter(h,f){const M=h.toLowerCase();return!(f.familyId&&-1===M.indexOf(f.familyId.toLowerCase())||!f.familyId&&f.clientId&&-1===M.indexOf(f.clientId.toLowerCase())||f.homeAccountId&&-1===M.indexOf(f.homeAccountId.toLowerCase()))}readAppMetadataFromCache(h){const M=this.getAppMetadataFilteredBy({environment:h,clientId:this.clientId}),P=Object.keys(M).map(K=>M[K]),S=P.length;if(S<1)return null;if(S>1)throw(0,I.zP)(B.EC);return P[0]}isAppMetadataFOCI(h){const f=this.readAppMetadataFromCache(h);return!(!f||f.familyId!==A.ch)}matchHomeAccountId(h,f){return"string"==typeof h.homeAccountId&&f===h.homeAccountId}matchLocalAccountIdFromTokenClaims(h,f){return f===(h.oid||h.sub)}matchLocalAccountIdFromTenantProfile(h,f){return h.localAccountId===f}matchName(h,f){return f.toLowerCase()===h.name?.toLowerCase()}matchUsername(h,f){return!(!h||"string"!=typeof h||f?.toLowerCase()!==h.toLowerCase())}matchUserAssertionHash(h,f){return!(!h.userAssertionHash||f!==h.userAssertionHash)}matchEnvironment(h,f){if(this.staticAuthorityOptions){const P=(0,r._u)(this.staticAuthorityOptions,this.commonLogger);if(P.includes(f)&&P.includes(h.environment))return!0}const M=this.getAuthorityMetadataByAlias(f);return!!(M&&M.aliases.indexOf(h.environment)>-1)}matchCredentialType(h,f){return h.credentialType&&f.toLowerCase()===h.credentialType.toLowerCase()}matchClientId(h,f){return!(!h.clientId||f!==h.clientId)}matchFamilyId(h,f){return!(!h.familyId||f!==h.familyId)}matchRealm(h,f){return h.realm?.toLowerCase()===f.toLowerCase()}matchNativeAccountId(h,f){return!(!h.nativeAccountId||f!==h.nativeAccountId)}matchLoginHintFromTokenClaims(h,f){return h.login_hint===f||h.preferred_username===f||h.upn===f}matchSid(h,f){return h.sid===f}matchAuthorityType(h,f){return!(!h.authorityType||f.toLowerCase()!==h.authorityType.toLowerCase())}matchTarget(h,f){return!(h.credentialType!==A.d3.ACCESS_TOKEN&&h.credentialType!==A.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!h.target)&&U.i.fromString(h.target).containsScopeSet(f)}matchTokenType(h,f){return!(!h.tokenType||h.tokenType!==f)}matchKeyId(h,f){return!(!h.keyId||h.keyId!==f)}isAppMetadata(h){return-1!==h.indexOf(A.dg)}isAuthorityMetadata(h){return-1!==h.indexOf(A.QU.CACHE_KEY)}generateAuthorityMetadataCacheKey(h){return`${A.QU.CACHE_KEY}-${this.clientId}-${h}`}static toObject(h,f){for(const M in f)h[M]=f[M];return h}}class T extends G{setAccount(){throw(0,I.zP)(B.M2)}getAccount(){throw(0,I.zP)(B.M2)}getCachedAccountEntity(){throw(0,I.zP)(B.M2)}setIdTokenCredential(){throw(0,I.zP)(B.M2)}getIdTokenCredential(){throw(0,I.zP)(B.M2)}setAccessTokenCredential(){throw(0,I.zP)(B.M2)}getAccessTokenCredential(){throw(0,I.zP)(B.M2)}setRefreshTokenCredential(){throw(0,I.zP)(B.M2)}getRefreshTokenCredential(){throw(0,I.zP)(B.M2)}setAppMetadata(){throw(0,I.zP)(B.M2)}getAppMetadata(){throw(0,I.zP)(B.M2)}setServerTelemetry(){throw(0,I.zP)(B.M2)}getServerTelemetry(){throw(0,I.zP)(B.M2)}setAuthorityMetadata(){throw(0,I.zP)(B.M2)}getAuthorityMetadata(){throw(0,I.zP)(B.M2)}getAuthorityMetadataKeys(){throw(0,I.zP)(B.M2)}setThrottlingCache(){throw(0,I.zP)(B.M2)}getThrottlingCache(){throw(0,I.zP)(B.M2)}removeItem(){throw(0,I.zP)(B.M2)}getKeys(){throw(0,I.zP)(B.M2)}getAccountKeys(){throw(0,I.zP)(B.M2)}getTokenKeys(){throw(0,I.zP)(B.M2)}clear(){return(0,l.Z)(function*(){throw(0,I.zP)(B.M2)})()}updateCredentialCacheKey(){throw(0,I.zP)(B.M2)}removeOutdatedAccount(){throw(0,I.zP)(B.M2)}}},7712:(X,z,m)=>{m.d(z,{r:()=>C});var l=m(9128),A=m(9947),R=m(2888),U=m(464),N=m(842),I=m(4918),b=m(1763),d=m(2224);class C{generateAccountId(){return[this.homeAccountId,this.environment].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return C.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(_=>[_.tenantId,_]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(_){const B=_.homeAccountId.split(".")[1];return[_.homeAccountId,_.environment||"",B||_.tenantId||""].join(l.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(_,B,Q){const G=new C;let T;G.authorityType=B.authorityType===N.a.Adfs?l.iR.ADFS_ACCOUNT_TYPE:B.protocolMode===b.A.AAD?l.iR.MSSTS_ACCOUNT_TYPE:l.iR.GENERIC_ACCOUNT_TYPE,_.clientInfo&&Q&&(T=(0,A.B)(_.clientInfo,Q)),G.clientInfo=_.clientInfo,G.homeAccountId=_.homeAccountId,G.nativeAccountId=_.nativeAccountId;const W=_.environment||B&&B.getPreferredCache();if(!W)throw(0,U.zP)(d.Q9);if(G.environment=W,G.realm=T?.utid||(0,I.M)(_.idTokenClaims)||"",G.localAccountId=T?.uid||_.idTokenClaims.oid||_.idTokenClaims.sub||"",G.username=_.idTokenClaims.preferred_username||_.idTokenClaims.upn||(_.idTokenClaims.emails?_.idTokenClaims.emails[0]:null)||"",G.name=_.idTokenClaims.name,G.cloudGraphHostName=_.cloudGraphHostName,G.msGraphHost=_.msGraphHost,_.tenantProfiles)G.tenantProfiles=_.tenantProfiles;else{const M=[];if(_.idTokenClaims){const P=(0,R.SI)(_.homeAccountId,_.idTokenClaims);M.push(P)}G.tenantProfiles=M}return G}static createFromAccountInfo(_,B,Q){const G=new C;return G.authorityType=_.authorityType||l.iR.GENERIC_ACCOUNT_TYPE,G.homeAccountId=_.homeAccountId,G.localAccountId=_.localAccountId,G.nativeAccountId=_.nativeAccountId,G.realm=_.tenantId,G.environment=_.environment,G.username=_.username,G.name=_.name,G.cloudGraphHostName=B,G.msGraphHost=Q,G.tenantProfiles=Array.from(_.tenantProfiles?.values()||[]),G}static generateHomeAccountId(_,B,Q,G,T){if(B!==N.a.Adfs&&B!==N.a.Dsts){if(_)try{const W=(0,A.B)(_,G.base64Decode);if(W.uid&&W.utid)return`${W.uid}.${W.utid}`}catch{}Q.warning("No client info in response")}return T?.sub||""}static isAccountEntity(_){return!!_&&_.hasOwnProperty("homeAccountId")&&_.hasOwnProperty("environment")&&_.hasOwnProperty("realm")&&_.hasOwnProperty("localAccountId")&&_.hasOwnProperty("username")&&_.hasOwnProperty("authorityType")}static accountInfoIsEqual(_,B,Q){if(!_||!B)return!1;let G=!0;if(Q){const T=_.idTokenClaims||{},W=B.idTokenClaims||{};G=T.iat===W.iat&&T.nonce===W.nonce}return _.homeAccountId===B.homeAccountId&&_.localAccountId===B.localAccountId&&_.username===B.username&&_.tenantId===B.tenantId&&_.environment===B.environment&&_.nativeAccountId===B.nativeAccountId&&G}}},1783:(X,z,m)=>{m.d(z,{Bq:()=>B,Cd:()=>H,Ds:()=>d,FK:()=>k,Js:()=>M,Md:()=>b,Mk:()=>I,OJ:()=>C,Om:()=>_,Ox:()=>S,Rw:()=>O,VQ:()=>P,ZL:()=>K,k5:()=>F,x4:()=>Q,xc:()=>x});var l=m(2103),A=m(464),R=m(9128),U=m(1530),N=m(2224);function I(w){return[G(w),T(w),W(w),h(w),f(w)].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function b(w,D,Z,j,J){return{credentialType:R.d3.ID_TOKEN,homeAccountId:w,environment:D,clientId:j,secret:Z,realm:J}}function d(w,D,Z,j,J,te,ne,re,ue,Y,v,se,we,ve,ye){const ce={homeAccountId:w,credentialType:R.d3.ACCESS_TOKEN,secret:Z,cachedAt:(0,U.HY)().toString(),expiresOn:ne.toString(),extendedExpiresOn:re.toString(),environment:D,clientId:j,realm:J,target:te,tokenType:v||R.hO.BEARER};if(se&&(ce.userAssertionHash=se),Y&&(ce.refreshOn=Y.toString()),ve&&(ce.requestedClaims=ve,ce.requestedClaimsHash=ye),ce.tokenType?.toLowerCase()!==R.hO.BEARER.toLowerCase())switch(ce.credentialType=R.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,ce.tokenType){case R.hO.POP:const ie=(0,l.Z_)(Z,ue);if(!ie?.cnf?.kid)throw(0,A.zP)(N.P_);ce.keyId=ie.cnf.kid;break;case R.hO.SSH:ce.keyId=we}return ce}function C(w,D,Z,j,J,te,ne){const re={credentialType:R.d3.REFRESH_TOKEN,homeAccountId:w,environment:D,clientId:j,secret:Z};return te&&(re.userAssertionHash=te),J&&(re.familyId=J),ne&&(re.expiresOn=ne.toString()),re}function r(w){return w.hasOwnProperty("homeAccountId")&&w.hasOwnProperty("environment")&&w.hasOwnProperty("credentialType")&&w.hasOwnProperty("clientId")&&w.hasOwnProperty("secret")}function _(w){return!!w&&r(w)&&w.hasOwnProperty("realm")&&w.hasOwnProperty("target")&&(w.credentialType===R.d3.ACCESS_TOKEN||w.credentialType===R.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function B(w){return!!w&&r(w)&&w.hasOwnProperty("realm")&&w.credentialType===R.d3.ID_TOKEN}function Q(w){return!!w&&r(w)&&w.credentialType===R.d3.REFRESH_TOKEN}function G(w){return[w.homeAccountId,w.environment].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function T(w){return[w.credentialType,w.credentialType===R.d3.REFRESH_TOKEN&&w.familyId||w.clientId,w.realm||""].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function W(w){return(w.target||"").toLowerCase()}function h(w){return(w.requestedClaimsHash||"").toLowerCase()}function f(w){return w.tokenType&&w.tokenType.toLowerCase()!==R.hO.BEARER.toLowerCase()?w.tokenType.toLowerCase():""}function M(w,D){const Z=0===w.indexOf(R.HN.CACHE_KEY);let j=!0;return D&&(j=D.hasOwnProperty("failedRequests")&&D.hasOwnProperty("errors")&&D.hasOwnProperty("cacheHits")),Z&&j}function P(w,D){let Z=!1;w&&(Z=0===w.indexOf(R.bb.THROTTLING_PREFIX));let j=!0;return D&&(j=D.hasOwnProperty("throttleTime")),Z&&j}function S({environment:w,clientId:D}){return[R.dg,w,D].join(R.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function K(w,D){return!!D&&0===w.indexOf(R.dg)&&D.hasOwnProperty("clientId")&&D.hasOwnProperty("environment")}function k(w,D){return!!D&&0===w.indexOf(R.QU.CACHE_KEY)&&D.hasOwnProperty("aliases")&&D.hasOwnProperty("preferred_cache")&&D.hasOwnProperty("preferred_network")&&D.hasOwnProperty("canonical_authority")&&D.hasOwnProperty("authorization_endpoint")&&D.hasOwnProperty("token_endpoint")&&D.hasOwnProperty("issuer")&&D.hasOwnProperty("aliasesFromNetwork")&&D.hasOwnProperty("endpointsFromNetwork")&&D.hasOwnProperty("expiresAt")&&D.hasOwnProperty("jwks_uri")}function O(){return(0,U.HY)()+R.QU.REFRESH_TIME_SECONDS}function x(w,D,Z){w.authorization_endpoint=D.authorization_endpoint,w.token_endpoint=D.token_endpoint,w.end_session_endpoint=D.end_session_endpoint,w.issuer=D.issuer,w.endpointsFromNetwork=Z,w.jwks_uri=D.jwks_uri}function H(w,D,Z){w.aliases=D.aliases,w.preferred_cache=D.preferred_cache,w.preferred_network=D.preferred_network,w.aliasesFromNetwork=Z}function F(w){return w.expiresAt<=(0,U.HY)()}},1878:(X,z,m)=>{m.d(z,{j6:()=>M,lh:()=>S,z:()=>_});var l=m(5861),A=m(368),R=m(2526),U=m(9128),N=m(8144),I=m(6145),b=m(5764),d=m(1763),C=m(464),r=m(2224);const _={tokenRenewalOffsetSeconds:U.$A,preventCorsPreflight:!1},B={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:R.i.Info,correlationId:U.gT.EMPTY_STRING},Q={claimsBasedCachingEnabled:!1},G={sendGetRequestAsync:()=>(0,l.Z)(function*(){throw(0,C.zP)(r.M2)})(),sendPostRequestAsync:()=>(0,l.Z)(function*(){throw(0,C.zP)(r.M2)})()},T={sku:U.gT.SKU,version:N.i,cpu:U.gT.EMPTY_STRING,os:U.gT.EMPTY_STRING},W={clientSecret:U.gT.EMPTY_STRING,clientAssertion:void 0},h={azureCloudInstance:I.z.None,tenant:`${U.gT.DEFAULT_COMMON_TENANT}`},f={application:{appName:"",appVersion:""}};function M({authOptions:K,systemOptions:k,loggerOptions:O,cacheOptions:x,storageInterface:H,networkInterface:F,cryptoInterface:w,clientCredentials:D,libraryInfo:Z,telemetry:j,serverTelemetryManager:J,persistencePlugin:te,serializableCache:ne}){const re={...B,...O};return{authOptions:P(K),systemOptions:{..._,...k},loggerOptions:re,cacheOptions:{...Q,...x},storageInterface:H||new b.w(K.clientId,A.d,new R.Y(re)),networkInterface:F||G,cryptoInterface:w||A.d,clientCredentials:D||W,libraryInfo:{...T,...Z},telemetry:{...f,...j},serverTelemetryManager:J||null,persistencePlugin:te||null,serializableCache:ne||null}}function P(K){return{clientCapabilities:[],azureCloudOptions:h,skipAuthorityMetadataCache:!1,...K}}function S(K){return K.authOptions.authority.options.protocolMode===d.A.OIDC}},9883:(X,z,m)=>{m.d(z,{C2:()=>S,Cx:()=>l,DN:()=>Y,DW:()=>K,GQ:()=>ne,He:()=>A,IC:()=>b,Im:()=>W,KR:()=>we,Lm:()=>U,O4:()=>qe,PU:()=>oe,PY:()=>ve,Pe:()=>F,RJ:()=>se,RO:()=>Te,Rl:()=>w,US:()=>Me,Zb:()=>Oe,bJ:()=>H,bP:()=>D,by:()=>h,cO:()=>P,ct:()=>I,ed:()=>T,fC:()=>x,hR:()=>Z,hf:()=>ye,ib:()=>re,j5:()=>j,ki:()=>te,ko:()=>N,nZ:()=>O,q0:()=>ue,s4:()=>k,sI:()=>v,x5:()=>V,yO:()=>R,z6:()=>B,zl:()=>ce,zm:()=>J});const l="client_id",A="redirect_uri",R="response_type",U="response_mode",N="grant_type",I="claims",b="scope",B="refresh_token",T="state",W="nonce",h="prompt",P="code",S="code_challenge",K="code_challenge_method",k="code_verifier",O="client-request-id",x="x-client-SKU",H="x-client-VER",F="x-client-OS",w="x-client-CPU",D="x-client-current-telemetry",Z="x-client-last-telemetry",j="x-ms-lib-capability",J="x-app-name",te="x-app-ver",ne="post_logout_redirect_uri",re="id_token_hint",ue="device_code",Y="client_secret",v="client_assertion",se="client_assertion_type",we="token_type",ve="req_cnf",ye="assertion",ce="requested_token_use",Oe="return_spa_code",qe="nativebroker",oe="logout_hint",V="sid",Me="login_hint",Te="domain_hint"},368:(X,z,m)=>{m.d(z,{d:()=>U});var l=m(5861),A=m(464),R=m(2224);const U={createNewGuid:()=>{throw(0,A.zP)(R.M2)},base64Decode:()=>{throw(0,A.zP)(R.M2)},base64Encode:()=>{throw(0,A.zP)(R.M2)},getPublicKeyThumbprint:()=>(0,l.Z)(function*(){throw(0,A.zP)(R.M2)})(),removeTokenBindingKey:()=>(0,l.Z)(function*(){throw(0,A.zP)(R.M2)})(),clearKeystore:()=>(0,l.Z)(function*(){throw(0,A.zP)(R.M2)})(),signJwt:()=>(0,l.Z)(function*(){throw(0,A.zP)(R.M2)})(),hashString:()=>(0,l.Z)(function*(){throw(0,A.zP)(R.M2)})()}},5183:(X,z,m)=>{m.d(z,{ju:()=>R});var l=m(7798);const A={[l.b]:"Exceeded cache storage capacity.",[l.K]:"Unexpected error occurred when using cache storage."};class R extends Error{constructor(N,I){const b=I||(A[N]?A[N]:A[l.K]);super(`${N}: ${b}`),Object.setPrototypeOf(this,R.prototype),this.name="CacheError",this.errorCode=N,this.errorMessage=b}}},7798:(X,z,m)=>{m.d(z,{K:()=>A,b:()=>l});const l="cache_quota_exceeded",A="cache_error_unknown"},1635:(X,z,m)=>{m.d(z,{Cf:()=>C,Yo:()=>d,ip:()=>r});var l=m(9128),A=m(4191),R=m(1071);const U=[R.tZ,R.Mo,R.kk,R.nl],N=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],I={[R.I2]:"No refresh token found in the cache. Please sign-in.",[R.QP]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[R.Tw]:"Refresh token has expired.",[R.nl]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class d extends A.l4{constructor(B,Q,G,T,W,h,f,M){super(B,Q,G),Object.setPrototypeOf(this,d.prototype),this.timestamp=T||l.gT.EMPTY_STRING,this.traceId=W||l.gT.EMPTY_STRING,this.correlationId=h||l.gT.EMPTY_STRING,this.claims=f||l.gT.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=M}}function C(_,B,Q){const G=!!_&&U.indexOf(_)>-1,T=!!Q&&N.indexOf(Q)>-1,W=!!B&&U.some(h=>B.indexOf(h)>-1);return G||W||T}function r(_){return new d(_,I[_])}},1071:(X,z,m)=>{m.d(z,{I2:()=>l,Mo:()=>N,QP:()=>A,Tw:()=>R,kk:()=>I,nl:()=>b,tZ:()=>U});const l="no_tokens_found",A="native_account_unavailable",R="refresh_token_expired",U="interaction_required",N="consent_required",I="login_required",b="bad_token"},1641:(X,z,m)=>{m.d(z,{n:()=>A});var l=m(4191);class A extends l.l4{constructor(U,N,I,b){super(U,N,I),this.name="ServerError",this.errorNo=b,Object.setPrototypeOf(this,A.prototype)}}},2526:(X,z,m)=>{m.d(z,{Y:()=>R,i:()=>A});var l=m(9128),A=(()=>{return(U=A||(A={}))[U.Error=0]="Error",U[U.Warning=1]="Warning",U[U.Info=2]="Info",U[U.Verbose=3]="Verbose",U[U.Trace=4]="Trace",A;var U})();class R{constructor(N,I,b){this.level=A.Info;const C=N||R.createDefaultLoggerOptions();this.localCallback=C.loggerCallback||(()=>{}),this.piiLoggingEnabled=C.piiLoggingEnabled||!1,this.level="number"==typeof C.logLevel?C.logLevel:A.Info,this.correlationId=C.correlationId||l.gT.EMPTY_STRING,this.packageName=I||l.gT.EMPTY_STRING,this.packageVersion=b||l.gT.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:A.Info}}clone(N,I,b){return new R({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:b||this.correlationId},N,I)}logMessage(N,I){if(I.logLevel>this.level||!this.piiLoggingEnabled&&I.containsPii)return;const C=`[${(new Date).toUTCString()}] : [${I.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${A[I.logLevel]} - ${N}`;this.executeCallback(I.logLevel,C,I.containsPii||!1)}executeCallback(N,I,b){this.localCallback&&this.localCallback(N,I,b)}error(N,I){this.logMessage(N,{logLevel:A.Error,containsPii:!1,correlationId:I||l.gT.EMPTY_STRING})}errorPii(N,I){this.logMessage(N,{logLevel:A.Error,containsPii:!0,correlationId:I||l.gT.EMPTY_STRING})}warning(N,I){this.logMessage(N,{logLevel:A.Warning,containsPii:!1,correlationId:I||l.gT.EMPTY_STRING})}warningPii(N,I){this.logMessage(N,{logLevel:A.Warning,containsPii:!0,correlationId:I||l.gT.EMPTY_STRING})}info(N,I){this.logMessage(N,{logLevel:A.Info,containsPii:!1,correlationId:I||l.gT.EMPTY_STRING})}infoPii(N,I){this.logMessage(N,{logLevel:A.Info,containsPii:!0,correlationId:I||l.gT.EMPTY_STRING})}verbose(N,I){this.logMessage(N,{logLevel:A.Verbose,containsPii:!1,correlationId:I||l.gT.EMPTY_STRING})}verbosePii(N,I){this.logMessage(N,{logLevel:A.Verbose,containsPii:!0,correlationId:I||l.gT.EMPTY_STRING})}trace(N,I){this.logMessage(N,{logLevel:A.Trace,containsPii:!1,correlationId:I||l.gT.EMPTY_STRING})}tracePii(N,I){this.logMessage(N,{logLevel:A.Trace,containsPii:!0,correlationId:I||l.gT.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},8144:(X,z,m)=>{m.d(z,{i:()=>A,u:()=>l});const l="@azure/msal-common",A="14.10.0"},1267:(X,z,m)=>{m.d(z,{H:()=>b});var l=m(9128),A=m(9883),R=m(4226),U=m(8061),N=m(6680),I=m(1288);class b{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(A.yO,encodeURIComponent(l.gT.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(A.yO,encodeURIComponent(`${l.gT.TOKEN_RESPONSE_TYPE} ${l.gT.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(C){this.parameters.set(A.Lm,encodeURIComponent(C||l.vw.QUERY))}addNativeBroker(){this.parameters.set(A.O4,encodeURIComponent("1"))}addScopes(C,r=!0,_=l.f_){r&&!_.includes("openid")&&!C.includes("openid")&&_.push("openid");const B=r?[...C||[],..._]:C||[],Q=new R.i(B);this.parameters.set(A.IC,encodeURIComponent(Q.printScopes()))}addClientId(C){this.parameters.set(A.Cx,encodeURIComponent(C))}addRedirectUri(C){N.D.validateRedirectUri(C),this.parameters.set(A.He,encodeURIComponent(C))}addPostLogoutRedirectUri(C){N.D.validateRedirectUri(C),this.parameters.set(A.GQ,encodeURIComponent(C))}addIdTokenHint(C){this.parameters.set(A.ib,encodeURIComponent(C))}addDomainHint(C){this.parameters.set(A.RO,encodeURIComponent(C))}addLoginHint(C){this.parameters.set(A.US,encodeURIComponent(C))}addCcsUpn(C){this.parameters.set(l.SZ.CCS_HEADER,encodeURIComponent(`UPN:${C}`))}addCcsOid(C){this.parameters.set(l.SZ.CCS_HEADER,encodeURIComponent(`Oid:${C.uid}@${C.utid}`))}addSid(C){this.parameters.set(A.x5,encodeURIComponent(C))}addClaims(C,r){const _=this.addClientCapabilitiesToClaims(C,r);N.D.validateClaims(_),this.parameters.set(A.ct,encodeURIComponent(_))}addCorrelationId(C){this.parameters.set(A.nZ,encodeURIComponent(C))}addLibraryInfo(C){this.parameters.set(A.fC,C.sku),this.parameters.set(A.bJ,C.version),C.os&&this.parameters.set(A.Pe,C.os),C.cpu&&this.parameters.set(A.Rl,C.cpu)}addApplicationTelemetry(C){C?.appName&&this.parameters.set(A.zm,C.appName),C?.appVersion&&this.parameters.set(A.ki,C.appVersion)}addPrompt(C){N.D.validatePrompt(C),this.parameters.set(`${A.by}`,encodeURIComponent(C))}addState(C){C&&this.parameters.set(A.ed,encodeURIComponent(C))}addNonce(C){this.parameters.set(A.Im,encodeURIComponent(C))}addCodeChallengeParams(C,r){if(N.D.validateCodeChallengeParams(C,r),!C||!r)throw(0,U.ei)(I.TU);this.parameters.set(A.C2,encodeURIComponent(C)),this.parameters.set(A.DW,encodeURIComponent(r))}addAuthorizationCode(C){this.parameters.set(A.cO,encodeURIComponent(C))}addDeviceCode(C){this.parameters.set(A.q0,encodeURIComponent(C))}addRefreshToken(C){this.parameters.set(A.z6,encodeURIComponent(C))}addCodeVerifier(C){this.parameters.set(A.s4,encodeURIComponent(C))}addClientSecret(C){this.parameters.set(A.DN,encodeURIComponent(C))}addClientAssertion(C){C&&this.parameters.set(A.sI,encodeURIComponent(C))}addClientAssertionType(C){C&&this.parameters.set(A.RJ,encodeURIComponent(C))}addOboAssertion(C){this.parameters.set(A.hf,encodeURIComponent(C))}addRequestTokenUse(C){this.parameters.set(A.zl,encodeURIComponent(C))}addGrantType(C){this.parameters.set(A.ko,encodeURIComponent(C))}addClientInfo(){this.parameters.set(l.sR,"1")}addExtraQueryParameters(C){const r=N.D.sanitizeEQParams(C,this.parameters);Object.keys(r).forEach(_=>{this.parameters.set(_,C[_])})}addClientCapabilitiesToClaims(C,r){let _;if(C)try{_=JSON.parse(C)}catch{throw(0,U.ei)(I.nm)}else _={};return r&&r.length>0&&(_.hasOwnProperty(l.As.ACCESS_TOKEN)||(_[l.As.ACCESS_TOKEN]={}),_[l.As.ACCESS_TOKEN][l.As.XMS_CC]={values:r}),JSON.stringify(_)}addUsername(C){this.parameters.set(l.Ge.username,encodeURIComponent(C))}addPassword(C){this.parameters.set(l.Ge.password,encodeURIComponent(C))}addPopToken(C){C&&(this.parameters.set(A.KR,l.hO.POP),this.parameters.set(A.PY,encodeURIComponent(C)))}addSshJwk(C){C&&(this.parameters.set(A.KR,l.hO.SSH),this.parameters.set(A.PY,encodeURIComponent(C)))}addServerTelemetry(C){this.parameters.set(A.bP,C.generateCurrentRequestHeaderValue()),this.parameters.set(A.hR,C.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(A.j5,l.bb.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(C){this.parameters.set(A.PU,encodeURIComponent(C))}createQueryString(){const C=new Array;return this.parameters.forEach((r,_)=>{C.push(`${_}=${r}`)}),C.join("&")}}},6680:(X,z,m)=>{m.d(z,{D:()=>U});var l=m(8061),A=m(9128),R=m(1288);class U{static validateRedirectUri(I){if(!I)throw(0,l.ei)(R.RV)}static validatePrompt(I){const b=[];for(const d in A.NJ)b.push(A.NJ[d]);if(b.indexOf(I)<0)throw(0,l.ei)(R.z_)}static validateClaims(I){try{JSON.parse(I)}catch{throw(0,l.ei)(R.nm)}}static validateCodeChallengeParams(I,b){if(!I||!b)throw(0,l.ei)(R.TU);this.validateCodeChallengeMethod(b)}static validateCodeChallengeMethod(I){if([A.VX.PLAIN,A.VX.S256].indexOf(I)<0)throw(0,l.ei)(R.d6)}static sanitizeEQParams(I,b){return I?(b.forEach((d,C)=>{I[C]&&delete I[C]}),Object.fromEntries(Object.entries(I).filter(d=>""!==d[1]))):{}}}},4226:(X,z,m)=>{m.d(z,{i:()=>b});var l=m(8061),A=m(2007),R=m(464),U=m(9128),N=m(1288),I=m(2224);class b{constructor(C){const r=C?A.x.trimArrayEntries([...C]):[],_=r?A.x.removeEmptyStringsFromArray(r):[];this.validateInputScopes(_),this.scopes=new Set,_.forEach(B=>this.scopes.add(B))}static fromString(C){const _=(C||U.gT.EMPTY_STRING).split(" ");return new b(_)}static createSearchScopes(C){const r=new b(C);return r.containsOnlyOIDCScopes()?r.removeScope(U.gT.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}validateInputScopes(C){if(!C||C.length<1)throw(0,l.ei)(N.vE)}containsScope(C){const r=this.printScopesLowerCase().split(" "),_=new b(r);return!!C&&_.scopes.has(C.toLowerCase())}containsScopeSet(C){return!(!C||C.scopes.size<=0)&&this.scopes.size>=C.scopes.size&&C.asArray().every(r=>this.containsScope(r))}containsOnlyOIDCScopes(){let C=0;return U.$f.forEach(r=>{this.containsScope(r)&&(C+=1)}),this.scopes.size===C}appendScope(C){C&&this.scopes.add(C.trim())}appendScopes(C){try{C.forEach(r=>this.appendScope(r))}catch{throw(0,R.zP)(I.f4)}}removeScope(C){if(!C)throw(0,R.zP)(I.v1);this.scopes.delete(C.trim())}removeOIDCScopes(){U.$f.forEach(C=>{this.scopes.delete(C)})}unionScopeSets(C){if(!C)throw(0,R.zP)(I.S);const r=new Set;return C.scopes.forEach(_=>r.add(_.toLowerCase())),this.scopes.forEach(_=>r.add(_.toLowerCase())),r}intersectingScopeSets(C){if(!C)throw(0,R.zP)(I.S);C.containsOnlyOIDCScopes()||C.removeOIDCScopes();const r=this.unionScopeSets(C),_=C.getScopeCount(),B=this.getScopeCount();return r.size<B+_}getScopeCount(){return this.scopes.size}asArray(){const C=[];return this.scopes.forEach(r=>C.push(r)),C}printScopes(){return this.scopes?this.asArray().join(" "):U.gT.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}},905:(X,z,m)=>{m.d(z,{$L:()=>R,Ak:()=>l});const l={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},R={NotStarted:0,InProgress:1,Completed:2}},1530:(X,z,m)=>{function l(){return Math.round((new Date).getTime()/1e3)}function A(N,I){const b=Number(N)||0;return l()+I>b}function R(N){return Number(N)>l()}m.d(z,{HY:()=>l,jx:()=>R,pw:()=>A})}}]);