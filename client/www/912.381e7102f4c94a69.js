"use strict";(self.webpackChunktermmy=self.webpackChunktermmy||[]).push([[912],{7304:(q,C,o)=>{o.d(C,{Q:()=>U});var e=o(4650),t=o(7436),_=o(2340),u=o(4006),T=o(8262),P=o(3681),y=o(5048),g=o(4398),f=o(4329),x=o(6895),b=o(2248),Z=o(3955),p=o(8804);function v(a,h){if(1&a&&(e.TgZ(0,"h4",3),e._uU(1),e.qZA()),2&a){const n=e.oxw();e.xp6(1),e.Oqu(n.title)}}function l(a,h){if(1&a&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&a){const n=e.oxw();e.xp6(1),e.hij(" ",n.text," ")}}let d=(()=>{class a{constructor(){this.dismissible=!1}static#e=this.\u0275fac=function(c){return new(c||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-alert"]],inputs:{type:"type",dismissible:"dismissible",title:"title",text:"text"},decls:3,vars:4,consts:[[3,"type","dismissible"],["class","alert-heading",4,"ngIf"],["class","alert-body",4,"ngIf"],[1,"alert-heading"],[1,"alert-body"]],template:function(c,i){1&c&&(e.TgZ(0,"ngb-alert",0),e.YNc(1,v,2,1,"h4",1),e.YNc(2,l,2,1,"div",2),e.qZA()),2&c&&(e.Q6J("type",i.type)("dismissible",i.dismissible),e.xp6(1),e.Q6J("ngIf",i.title),e.xp6(1),e.Q6J("ngIf",i.text))},dependencies:[x.O5,p.xm]})}return a})();function M(a,h){1&a&&(e.TgZ(0,"div"),e._UZ(1,"app-loader"),e.qZA())}function A(a,h){if(1&a&&(e.TgZ(0,"div",24),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()),2&a){const n=e.oxw(2);e.xp6(1),e.hij(" ",e.lcZ(2,3,"paymentProcessing.useTermmyCoinsInsteadPayment")," "),e.xp6(3),e.AsE(" ",n.calculateHowManyCoinsNeedToSpent()," ",e.lcZ(5,5,"paymentProcessing.coins"),"")}}function S(a,h){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"div",25)(2,"h4"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ngx-stripe-elements",26),e._UZ(6,"ngx-stripe-payment",27),e.qZA()(),e.TgZ(7,"div",28)(8,"p",29),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",30)(12,"input",31),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw(2);return e.KtG(r.voucherCode=i)}),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",32),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.checkVoucherCode())}),e._UZ(15,"span",33),e._uU(16),e.ALo(17,"translate"),e.qZA()()()()}if(2&a){const n=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,9,"paymentProcessing.cardInformation")),e.xp6(2),e.Q6J("stripe",n.stripe)("elementsOptions",n.elementsOptions),e.xp6(1),e.Q6J("appearance",n.appearance),e.xp6(3),e.Oqu(e.lcZ(10,11,"paymentProcessing.voucherTitle")),e.xp6(3),e.Q6J("placeholder",e.lcZ(13,13,"paymentProcessing.voucherPlaceholder"))("ngModel",n.voucherCode),e.xp6(2),e.Q6J("disabled",n.appliedCodeMessage.disabled),e.xp6(2),e.hij(" ",e.lcZ(17,15,"paymentProcessing.voucherApplyButton"),"")}}function O(a,h){if(1&a&&(e.TgZ(0,"div",12),e._UZ(1,"app-alert",34),e.qZA()),2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("type",n.appliedCodeMessage.valid?"success":"danger")("text",n.appliedCodeMessage.message)}}function I(a,h){1&a&&(e.TgZ(0,"div",35),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"paymentProcessing.needAcceptTermsAndPrivacyPolicy")," "))}function L(a,h){1&a&&e._UZ(0,"app-loader-small")}function E(a,h){if(1&a){const n=e.EpF();e.TgZ(0,"div",2)(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"label",5),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",6)(10,"div",7)(11,"div")(12,"div")(13,"h3",8),e._uU(14),e._UZ(15,"img",9),e.ALo(16,"translate"),e._UZ(17,"br"),e.qZA()(),e.TgZ(18,"span"),e._uU(19),e.ALo(20,"translate"),e.qZA()(),e.TgZ(21,"div",10),e._uU(22," = "),e.qZA(),e.TgZ(23,"div")(24,"div")(25,"h3",8),e._uU(26),e._UZ(27,"br"),e.qZA()(),e.TgZ(28,"span"),e._uU(29),e.ALo(30,"translate"),e.qZA()()(),e.YNc(31,A,6,7,"div",11),e.TgZ(32,"div",12)(33,"button",13),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.useTermmyCoins())}),e._uU(34),e.ALo(35,"translate"),e.qZA()()()()(),e.YNc(36,S,18,17,"div",0),e.YNc(37,O,2,2,"div",14),e.TgZ(38,"div",15)(39,"input",16),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.accept=i)}),e.qZA(),e.TgZ(40,"label",17),e._uU(41),e.ALo(42,"translate"),e.TgZ(43,"a",18),e._uU(44),e.ALo(45,"translate"),e.qZA(),e._uU(46),e.ALo(47,"translate"),e.TgZ(48,"a",19),e._uU(49),e.ALo(50,"translate"),e.qZA(),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.YNc(53,I,3,3,"div",20),e.qZA(),e.TgZ(54,"div",21)(55,"button",22),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.amount?i.pay():i.payWithCode())}),e.YNc(56,L,1,0,"app-loader-small",0),e._UZ(57,"span",23),e._uU(58),e.ALo(59,"translate"),e.qZA()()()}if(2&a){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,22,"paymentProcessing.title")),e.xp6(5),e.Oqu(e.lcZ(8,24,"paymentProcessing.termmyCoins")),e.xp6(7),e.hij("",n.termmyCoinCount.toFixed(0)," "),e.xp6(1),e.s9C("title",e.lcZ(16,26,"recommended.termmyCoin")),e.xp6(4),e.Oqu(e.lcZ(20,28,"paymentProcessing.totalTermmyCoin")),e.xp6(7),e.hij("",n.convertCoinsToEuro().toFixed(2)," \u20ac "),e.xp6(3),e.Oqu(e.lcZ(30,30,"paymentProcessing.discountPrice")),e.xp6(2),e.Q6J("ngIf",n.convertCoinsToEuro()>=n.amount&&n.calculateHowManyCoinsNeedToSpent()),e.xp6(2),e.Q6J("disabled",!(n.termmyCoinCount>0)),e.xp6(1),e.Oqu(e.lcZ(35,32,"paymentProcessing.usingTermmyCoin")),e.xp6(2),e.Q6J("ngIf",!n.usedTermmyCoin||n.convertCoinsToEuro()<n.amount),e.xp6(1),e.Q6J("ngIf",n.appliedCodeMessage),e.xp6(2),e.Q6J("ngModel",n.accept),e.xp6(2),e.hij(" ",e.lcZ(42,34,"paymentProcessing.acceptTermsAndPrivacyPolicyOne")," "),e.xp6(3),e.Oqu(e.lcZ(45,36,"paymentProcessing.acceptTermsAndPrivacyPolicyTerms")),e.xp6(2),e.hij(" ",e.lcZ(47,38,"paymentProcessing.acceptTermsAndPrivacyPolicyTermsAnd")," "),e.xp6(3),e.Oqu(e.lcZ(50,40,"paymentProcessing.acceptTermsAndPrivacyPolicyPrivacyPolicy")),e.xp6(2),e.hij(" ",e.lcZ(52,42,"paymentProcessing.acceptTermsAndPrivacyPolicyTwo")," "),e.xp6(2),e.Q6J("ngIf",n.submitted&&!n.accept),e.xp6(2),e.Q6J("disabled",!(n.accept&&!n.paying)),e.xp6(1),e.Q6J("ngIf",n.paying),e.xp6(2),e.hij("\xa0 ",n.buttonText?n.buttonText:n._helpService.replaceText(e.lcZ(59,44,"paymentProcessing.buttonText"),"#amount",n.amount),"")}}let U=(()=>{class a{constructor(n,c,i,r,s){this._service=n,this._helpService=c,this._storageService=i,this._translate=r,this._toastr=s,this.executeMethodEmitter=new e.vpe,this.elementsOptions={locale:"en"},this.stripe=this.stripeAccount?(0,t.kv)(_.N.STRIPE_KEY,{stripeAccount:this.stripeAccount}):(0,t.kv)(_.N.STRIPE_KEY),this.appearance={theme:"stripe",labels:"floating",variables:{colorPrimary:"#673ab7"}},this.paying=!1,this.accept=!1,this.clientData=new u.cw({firstname:new u.NI("",u.kI.required),lastname:new u.NI("",u.kI.required),email:new u.NI("",[u.kI.required,u.kI.email]),telephone:new u.NI("",[u.kI.required])}),this.appliedCodeMessage={disabled:!1},this.loader=!1,this.termmyCoinCount=0,this.discount=0,this.convertedTemmyCoinCopy=0,this.usedTermmyCoin=!1}ngOnInit(){this.setPaymentProcessingLanguage(),this.getTermmyCoin()}ngOnChanges(n){this.getProfileInfo(),setTimeout(()=>{this.createPaymentIntent()},100),this.originalAmount=this.amount}ngOnDestroy(){this._service.callPostMethod("api/payment/stripe/cancelPaymentIntent",{paymentId:this.paymentId}).subscribe(n=>{})}setPaymentProcessingLanguage(){this.elementsOptions.locale="sr-Latn"===this._storageService.getSelectedLanguage(!0)?"hr":this._storageService.getSelectedLanguage(!0),this._translate.onLangChange.subscribe(n=>{this.elementsOptions.locale="sr-Latn"===n.lang?"hr":this._storageService.getSelectedLanguage(!0)})}getProfileInfo(){this._service.callGetMethod("/api/getProfileInfo","").subscribe(n=>{if(n.length){const c=n[0];this.clientData.setValue({firstname:c.firstname,lastname:c.lastname,email:c.email,telephone:null})}})}getTermmyCoin(){this._service.callGetMethod("/api/getTermmyCoin").subscribe(n=>{this.termmyCoinCount=n,this.discount=n*_.N.TERMMY_COIN_PER_EURO,this.convertedTemmyCoinCopy=n*_.N.TERMMY_COIN_PER_EURO})}createPaymentIntent(){this.loader=!0,this._service.callPostMethod("api/payment/stripe/createPaymentIntent",{amount:Number(this.amount),stripeAccount:this.stripeAccount}).subscribe(n=>{this.elementsOptions.clientSecret=n.client_secret,this.paymentId=n.id,this.loader=!1})}updatePaymentIntent(){this._service.callPostMethod("api/payment/stripe/updatePaymentIntent",{paymentId:this.paymentId,amount:Number(this.amount),stripeAccount:this.stripeAccount}).subscribe(n=>{this.elementsOptions.clientSecret=n})}pay(){this.paying=!0,this.stripe.confirmPayment({elements:this.paymentElement.elements,confirmParams:{payment_method_data:{billing_details:{name:this.clientData.value.firstname+" "+this.clientData.value.lastname,email:this.clientData.value.email,phone:this.clientData.value.telephone}}},redirect:"if_required"}).subscribe({next:n=>{console.log(n),n.error||!this.accept?(this._toastr.showErrorCustom(this._translate.instant("paymentProcessing.errorPayment")),this.paying=!1):"succeeded"===n.paymentIntent.status&&(this.paying=!1,this.usingVoucherCode(),this.resetTermmyCoins(),this.executeMethodEmitter.emit(),this.voucherCode=null,this.amount=this.originalAmount,this.appliedCodeMessage.disabled=!1)},error:n=>{this.paying=!1}})}payWithCode(){this.usingVoucherCode(),this.resetTermmyCoins(),this.executeMethodEmitter.emit(),this.voucherCode=null,this.amount=this.originalAmount,this.appliedCodeMessage.disabled=!1,this.createPaymentIntent()}usingVoucherCode(){this.voucher&&this._service.callPostMethod("/api/setVoucherUsed",{id_voucher:this.voucher.id,id_partner:this.voucher.id_user,amount:this.amount}).subscribe(c=>{})}checkVoucherCode(){this.voucherCode&&this._service.callGetMethod("/api/checkVoucherCode",this.voucherCode).subscribe(n=>{n?(this.voucher=n,this.amount=Number((this.amount*(100-n.discount)/100).toFixed(2)),this.appliedCodeMessage={valid:!0,disabled:!0,message:this._translate.instant("paymentProcessing.voucherAppliedCode").replace("#discount",n.discount).replace("#discountAmount",this.amount)},this.updatePaymentIntent()):this.appliedCodeMessage={valid:!1,disabled:!1,message:this._translate.instant("paymentProcessing.voucherNotValid")}})}useTermmyCoins(){this.convertCoinsToEuro()>=this.amount?(this.discount=Number(this.amount),this.termmyCoinCount-=Number(this.amount)/_.N.TERMMY_COIN_PER_EURO,this.amount=0):(this.discount=this.convertCoinsToEuro(),this.amount=Number(this.amount-=this.discount).toFixed(2),this.termmyCoinCount=0),this.appliedCodeMessage={valid:!0,disabled:!1,message:this._translate.instant("paymentProcessing.usingTermmyCoinMessage").replace("#discount",this.discount.toFixed(2)).replace("#discountAmount",this.amount)},this.usedTermmyCoin=!0,this.amount&&this.updatePaymentIntent()}resetTermmyCoins(){this.usedTermmyCoin&&this._service.callPostMethod("api/resetTermmyCoin",{coins:this.termmyCoinCount}).subscribe(n=>{this.usedTermmyCoin=!1})}convertCoinsToEuro(){return this.termmyCoinCount*_.N.TERMMY_COIN_PER_EURO}calculateHowManyCoinsNeedToSpent(){return Number(this.amount)?(Number(this.amount)/_.N.TERMMY_COIN_PER_EURO).toFixed(0):0}static#e=this.\u0275fac=function(c){return new(c||a)(e.Y36(T.f),e.Y36(P.s),e.Y36(y.V),e.Y36(g.sK),e.Y36(f.l))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-payment-processing"]],viewQuery:function(c,i){if(1&c&&e.Gf(t._$,5),2&c){let r;e.iGM(r=e.CRH())&&(i.paymentElement=r.first)}},inputs:{amount:"amount",buttonText:"buttonText",stripeAccount:"stripeAccount"},outputs:{executeMethodEmitter:"executeMethodEmitter"},features:[e.TTD],decls:2,vars:2,consts:[[4,"ngIf"],["style","margin-bottom: 10px",4,"ngIf"],[2,"margin-bottom","10px"],[1,"termmy-coin","mb-4"],[1,"container-coin"],[1,"font-weight-bolder"],[1,"coin-counts"],[1,"info"],[1,"mb-0","font-weight-bolder"],["src","./assets/images/icons/termmy-coin.png",3,"title"],[1,"ml-2","mr-2"],["class","enought-coins",4,"ngIf"],[1,"mt-2"],[1,"btn-sm","btn-outline-primary",3,"disabled","click"],["class","mt-2",4,"ngIf"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","accept",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","accept",1,"custom-control-label"],["href","https://termmy.com/terms","target","_blank"],["href","https://termmy.com/privacy-policy","target","_blank"],["class","error",4,"ngIf"],[1,"pt-2","text-center"],[1,"btn","btn-primary","payment",3,"disabled","click"],[1,"fa","fa-shopping-cart"],[1,"enought-coins"],[1,"mb-2"],[3,"stripe","elementsOptions"],[3,"appearance"],[1,"mb-1"],[1,"voucher-title"],[1,"d-flex"],["name","voucher_code",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"btn","btn-outline-primary","ml-1","d-flex",3,"disabled","click"],[1,"fa","fa-check"],[3,"type","text"],[1,"error"]],template:function(c,i){1&c&&(e.YNc(0,M,2,0,"div",0),e.YNc(1,E,60,46,"div",1)),2&c&&(e.Q6J("ngIf",!i.elementsOptions.clientSecret&&i.loader),e.xp6(1),e.Q6J("ngIf",i.elementsOptions.clientSecret&&!i.loader))},dependencies:[x.O5,t._$,t.Ec,u.Fj,u.Wl,u.JJ,u.On,b.R,Z.T,d,g.X$],styles:[".voucher-title[_ngcontent-%COMP%]{margin:0;color:#000}.termmy-coin[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.termmy-coin[_ngcontent-%COMP%]   .container-coin[_ngcontent-%COMP%]{border:1px solid lightgray;border-radius:6px;max-width:400px;padding:5px}.coin-counts[_ngcontent-%COMP%]{padding:14px;text-align:center}.container-coin[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.container-coin[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:bolder}.termmy-coin[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px;padding-left:3px}.enought-coins[_ngcontent-%COMP%]{font-size:12px;margin-top:15px;background:rgba(40,199,111,.12)!important;color:#28c76f!important;padding:5px}.enought-coins[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:700}"]})}return a})()},912:(q,C,o)=>{o.d(C,{C:()=>h});var e=o(8072),t=o(4650),_=o(8262),u=o(3681),T=o(5048),P=o(4329),y=o(4398),g=o(8723),f=o(6895),x=o(7304),b=o(3233),Z=o(9604);const p=["dialogConfirm"];function v(n,c){1&n&&(t.TgZ(0,"span")(1,"b"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij("(",t.lcZ(3,1,"licenseStatus.expired"),")"))}function l(n,c){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.YNc(3,v,4,3,"span",0),t.qZA()),2&n){const i=t.oxw(3);t.xp6(1),t.Oqu(t.xi3(2,2,i.license.expiry_date,"dd.MM.YYYY HH:mm")),t.xp6(2),t.Q6J("ngIf",0===i.diffDays)}}function d(n,c){1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"licenseStatus.forever")))}function M(n,c){1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"licenseStatus.notifyBeforeExpired")))}const A=function(n){return{width:n}};function S(n,c){if(1&n&&(t.TgZ(0,"div",20),t._UZ(1,"div",21),t.qZA()),2&n){const i=t.oxw(4);t.xp6(1),t.MT6("progress-bar ",i.diffDays<=10?"progress-bar-error":""," ",i.diffDays>10&&i.diffDays<=30?"progress-bar-warning":"",""),t.Q6J("ngStyle",t.VKq(5,A,i.expiryPercentage))}}function O(n,c){if(1&n&&(t.TgZ(0,"div",15)(1,"div",16)(2,"h5",17),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"h5",17),t._uU(6),t.qZA()(),t.YNc(7,S,2,7,"div",18),t.TgZ(8,"p",19),t._uU(9),t.ALo(10,"translate"),t.qZA()()),2&n){const i=t.oxw(3);t.xp6(3),t.Oqu(t.lcZ(4,5,"licenseStatus.days")),t.xp6(3),t.Oqu(i.diffDays),t.xp6(1),t.Q6J("ngIf",i.expiryPercentage),t.xp6(2),t.AsE("",i.diffDays," ",t.lcZ(10,7,"licenseStatus.daysReminder"),"")}}function I(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(i),t.oxw(3);const s=t.MAs(2);return t.KtG(s.showQuestionModal())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"licenseStatus.cancelSubscription")))}function L(n,c){if(1&n&&(t.TgZ(0,"div",5)(1,"div",6)(2,"h4",7),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",8)(6,"div",5)(7,"div",9)(8,"div",10)(9,"h5"),t._uU(10),t.ALo(11,"translate"),t.TgZ(12,"strong"),t._uU(13),t.qZA()(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"div",10)(18,"h5"),t._uU(19),t.ALo(20,"translate"),t.YNc(21,l,4,5,"span",0),t.YNc(22,d,3,3,"span",0),t.qZA(),t.YNc(23,M,3,3,"span",0),t.qZA(),t.TgZ(24,"div",11)(25,"h5"),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"span"),t._uU(29),t.ALo(30,"translate"),t.qZA()()(),t.TgZ(31,"div",9),t.YNc(32,O,11,9,"div",12),t._UZ(33,"app-sms-counter"),t.qZA(),t.TgZ(34,"div",6)(35,"a",13),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.YNc(38,I,3,3,"button",14),t.qZA()()()()),2&n){const i=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,14,"licenseStatus.currentPlan")),t.xp6(7),t.hij("",t.lcZ(11,16,"licenseStatus.yourCurrentPlan")," "),t.xp6(3),t.Oqu(i.license.name),t.xp6(2),t.Oqu(t.lcZ(16,18,"licenseStatus.simpleStartForEveryone")),t.xp6(4),t.hij("",t.lcZ(20,20,"licenseStatus.activeUntil")," "),t.xp6(2),t.Q6J("ngIf",i.license.expiry_date),t.xp6(1),t.Q6J("ngIf",!i.license.expiry_date),t.xp6(1),t.Q6J("ngIf",i.license.expiry_date),t.xp6(3),t.AsE("",i.license.monthly_price," ",t.lcZ(27,22,"licenseStatus.perMonth")," "),t.xp6(3),t.Oqu(t.lcZ(30,24,"licenseStatus.planDescription")),t.xp6(3),t.Q6J("ngIf",i.license.expiry_date),t.xp6(4),t.hij(" ",t.lcZ(37,26,"licenseStatus.updatePlan")," "),t.xp6(2),t.Q6J("ngIf",i.license.license_id!==i.getBasicLicenseType())}}function E(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"app-payment-processing",40),t.NdJ("executeMethodEmitter",function(s){t.CHM(i);const m=t.oxw(3);return t.KtG(m.executeMethod(s))}),t.qZA()}if(2&n){const i=t.oxw(3);t.Q6J("amount",i.licenseSubscription.price)}}function U(n,c){if(1&n){const i=t.EpF();t.TgZ(0,"div",23)(1,"div",24)(2,"h4",25),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",8)(6,"div",26)(7,"div",27)(8,"input",28),t.NdJ("ngModelChange",function(s){t.CHM(i);const m=t.oxw(2);return t.KtG(m.annualSubscription=s)})("click",function(){t.CHM(i);const s=t.oxw(2);return s.annualSubscription="monthly",t.KtG(s.selectPackage(s.license.monthly_price,1))}),t.qZA(),t.TgZ(9,"label",29),t._uU(10),t.ALo(11,"translate"),t.TgZ(12,"span",30),t._uU(13),t.qZA()()(),t.TgZ(14,"div",31)(15,"input",32),t.NdJ("ngModelChange",function(s){t.CHM(i);const m=t.oxw(2);return t.KtG(m.annualSubscription=s)})("click",function(){t.CHM(i);const s=t.oxw(2);return s.annualSubscription="monthly",t.KtG(s.selectPackage(s.licensePriceFor3Months,3))}),t.qZA(),t.TgZ(16,"label",33),t._uU(17),t.ALo(18,"translate"),t.TgZ(19,"span",30),t._uU(20),t.qZA()()(),t.TgZ(21,"div",31)(22,"input",34),t.NdJ("ngModelChange",function(s){t.CHM(i);const m=t.oxw(2);return t.KtG(m.annualSubscription=s)})("click",function(){t.CHM(i);const s=t.oxw(2);return s.annualSubscription="monthly",t.KtG(s.selectPackage(s.licensePriceFor6Months,6))}),t.qZA(),t.TgZ(23,"label",35),t._uU(24),t.ALo(25,"translate"),t.TgZ(26,"span",30),t._uU(27),t.qZA()(),t._uU(28," \xa0 "),t.TgZ(29,"span",36),t._uU(30),t.ALo(31,"translate"),t.qZA()(),t.TgZ(32,"div",31)(33,"input",37),t.NdJ("ngModelChange",function(s){t.CHM(i);const m=t.oxw(2);return t.KtG(m.annualSubscription=s)})("click",function(){t.CHM(i);const s=t.oxw(2);return s.annualSubscription="annual",t.KtG(s.selectPackage(s.licensePriceFor12Months,12))}),t.qZA(),t.TgZ(34,"label",38),t._uU(35),t.ALo(36,"translate"),t.TgZ(37,"span",30),t._uU(38),t.qZA(),t._uU(39," \xa0 "),t.TgZ(40,"span",36),t._uU(41),t.ALo(42,"translate"),t.qZA()()()(),t.YNc(43,E,1,1,"app-payment-processing",39),t.qZA()()}if(2&n){const i=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,20,"licenseStatus.extendCurrentPlan")),t.xp6(5),t.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),t.xp6(2),t.hij(" ",t.lcZ(11,22,"licenseStatus.monthlySubscription")," "),t.xp6(3),t.hij(" (\u20ac",i.license.monthly_price,")"),t.xp6(2),t.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),t.xp6(2),t.hij(" ",t.lcZ(18,24,"licenseStatus.threeMonthSubscription")," "),t.xp6(3),t.hij(" (\u20ac",i.licensePriceFor3Months," )"),t.xp6(2),t.Q6J("checked",!i.annualSubscription)("ngModel",i.annualSubscription),t.xp6(2),t.hij(" ",t.lcZ(25,26,"licenseStatus.sixMonthSubscription")," "),t.xp6(3),t.hij(" (\u20ac",i.licensePriceFor6Months," )"),t.xp6(3),t.Oqu(t.lcZ(31,28,"licenseStatus.discount5")),t.xp6(3),t.Q6J("checked",!!i.annualSubscription)("ngModel",i.annualSubscription),t.xp6(2),t.hij(" ",t.lcZ(36,30,"licenseStatus.annualSubscription")," "),t.xp6(3),t.hij(" (\u20ac",i.licensePriceFor12Months,") "),t.xp6(3),t.Oqu(t.lcZ(42,32,"licenseStatus.discount10")),t.xp6(2),t.Q6J("ngIf",i.licenseSubscription.price)}}function a(n,c){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,L,39,28,"div",3),t.YNc(2,U,44,34,"div",4),t.qZA()),2&n){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.currentStatus),t.xp6(1),t.Q6J("ngIf",i.license.monthly_price)}}let h=(()=>{class n{constructor(i,r,s,m,D,N){this._service=i,this._helpService=r,this._storageService=s,this._toastr=m,this._translate=D,this._router=N,this.currentStatus=!0,this.licenseSubscription={price:null,duration:null},this.annualSubscription="annual"}ngOnInit(){this.data?(this.license=this.data,this.additionalCalculate(),this.setInitializePrice()):this._service.callGetMethod("/api/getMyLicense","").subscribe(i=>{this.license=i[0],this.additionalCalculate(),this.setInitializePrice()})}ngOnChanges(i){i.data&&(this.license=i.data.currentValue),this.setInitializePrice()}setInitializePrice(){this.licenseSubscription.duration=12,this.licensePriceFor3Months=(3*this.license.monthly_price).toFixed(2),this.licensePriceFor6Months=(6*this.license.monthly_price*.95).toFixed(2),this.licensePriceFor12Months=(12*this.license.monthly_price*.9).toFixed(2),this.licenseSubscription.price=this.licensePriceFor12Months}additionalCalculate(){this.calculateDiffDays(),this.getSubscriptionPeriod(),this.calculatePercentage()}calculateDiffDays(){this.diffDays=this._helpService.calculateDiffInDays(this.license.expiry_date)}getSubscriptionPeriod(){this.subscriptionPeriod=this.license.annual_subscription?this._helpService.daysInYear((new Date).getFullYear()):this._helpService.daysInMonth((new Date).getMonth(),(new Date).getFullYear())}calculatePercentage(){this.expiryPercentage=this.diffDays+"%"}selectPackage(i,r){this.licenseSubscription.price=null,this.licenseSubscription.duration=r,setTimeout(()=>{this.licenseSubscription.price=i.toString()},20)}cancelSubscription(){this._service.callPostMethod("api/cancelSubscription",{license_id:e.y.Basic}).subscribe(i=>{this._toastr.showSuccessCustom(this._translate.instant("licenseStatus.successfullyPaidLicense")),this.ngOnInit()})}confirmCancelSubscription(){}getBasicLicenseType(){return e.y.Basic}executeMethod(i){this.license.expiry_date=this._helpService.addMonthsToCurrentDate(this.license.expiry_date,this.licenseSubscription.duration),this._service.callPostMethod("/api/updateLicense",{value:this._storageService.encrypt({id:this.license.id,license_id:this.license.license_id,expiry_date:this.license.expiry_date})}).subscribe(s=>{s&&(this.calculateDiffDays(),this._toastr.showSuccessCustom(this._translate.instant("licenseStatus.successfullyPaidLicense")),setTimeout(()=>{window.open("dashboard/admin/settings/license","_self")},1500))})}static#e=this.\u0275fac=function(r){return new(r||n)(t.Y36(_.f),t.Y36(u.s),t.Y36(T.V),t.Y36(P.l),t.Y36(y.sK),t.Y36(g.F0))};static#t=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-license-status"]],viewQuery:function(r,s){if(1&r&&t.Gf(p,5),2&r){let m;t.iGM(m=t.CRH())&&(s.dialogConfirm=m.first)}},inputs:{data:"data",currentStatus:"currentStatus"},features:[t.TTD],decls:4,vars:4,consts:[[4,"ngIf"],[3,"content","confirm"],["dialogConfirm",""],["class","row",4,"ngIf"],["class","card",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"ml-75","card-title","full-width","border-bottom"],[1,"card-body"],[1,"col-md-6"],[1,"mb-2","pb-50"],[1,"mb-2","mb-md-1"],["class","plan-statistics pt-1",4,"ngIf"],["routerLink","/dashboard/admin/payment/license-packages",1,"btn","btn-primary","me-1","mt-1","mr-1","waves-effect","waves-float","waves-light"],["class","btn btn-outline-danger cancel-subscription mt-1 waves-effect",3,"click",4,"ngIf"],[1,"plan-statistics","pt-1"],[1,"d-flex","justify-content-between"],[1,"fw-bolder"],["class","progress",4,"ngIf"],[1,"mt-50"],[1,"progress"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",3,"ngStyle"],[1,"btn","btn-outline-danger","cancel-subscription","mt-1","waves-effect",3,"click"],[1,"card"],[1,"card-header"],[1,"card-title","full-width","border-bottom"],[1,"pb-3","mb-1","border-bottom"],[1,"custom-control","custom-radio"],["type","radio","name","subscription","id","monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","monthly",1,"custom-control-label"],[1,"price"],[1,"custom-control","custom-radio","mt-1"],["type","radio","name","subscription","id","3monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","3monthly",1,"custom-control-label"],["type","radio","name","subscription","id","6monthly","value","monthly",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","6monthly",1,"custom-control-label"],[1,"badge","badge-light-primary"],["type","radio","name","subscription","id","annual","value","annual",1,"custom-control-input",3,"checked","ngModel","ngModelChange","click"],["for","annual",1,"custom-control-label"],[3,"amount","executeMethodEmitter",4,"ngIf"],[3,"amount","executeMethodEmitter"]],template:function(r,s){1&r&&(t.YNc(0,a,3,2,"div",0),t.TgZ(1,"app-dialog-confirm",1,2),t.NdJ("confirm",function(){return s.cancelSubscription()}),t.ALo(3,"translate"),t.qZA()),2&r&&(t.Q6J("ngIf",s.license),t.xp6(1),t.Q6J("content",t.lcZ(3,2,"licenseStatus.cancelSubscriptionQuestion")))},dependencies:[f.O5,f.PC,x.Q,b.p,g.rH,Z.q,f.uU,y.X$],styles:[".price[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);font-size:16px}.progress-bar-error[_ngcontent-%COMP%]{background:#ef0000!important}.progress-bar-warning[_ngcontent-%COMP%]{background:#d3be04!important}"]})}return n})()},9604:(q,C,o)=>{o.d(C,{q:()=>Z});var e=o(4650),t=o(3681),_=o(8262),u=o(6895),T=o(8723),P=o(4398);const y=function(p){return{width:p}};function g(p,v){if(1&p&&(e.TgZ(0,"div",12),e._UZ(1,"div",13),e.qZA()),2&p){const l=e.oxw(3);e.xp6(1),e.MT6("progress-bar ",l.smsCount.count<=40?"progress-bar-error":""," ",l.smsCount.count>40&&l.smsCount.count<=70?"progress-bar-warning":"",""),e.Q6J("ngStyle",e.VKq(5,y,l.generateProgressBar()))}}function f(p,v){1&p&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"smsReminder.pleaseBuySmsOnTime")))}function x(p,v){if(1&p&&(e.TgZ(0,"div",6)(1,"div",7)(2,"h5",8),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"h5",8),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e.YNc(8,g,2,7,"div",9),e.TgZ(9,"p",10),e._uU(10),e.ALo(11,"translate"),e.YNc(12,f,3,3,"span",11),e.qZA()()),2&p){const l=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,6,"smsReminder.leftMessage")),e.xp6(3),e.AsE("",l.smsCount.count," ",e.lcZ(7,8,"smsReminder.sms"),""),e.xp6(2),e.Q6J("ngIf",l.smsCount),e.xp6(2),e.hij("",l._helpService.replaceText(e.lcZ(11,10,"smsReminder.leftMessageText"),"{numberOfLeftMessage}",l.smsCount.count)," "),e.xp6(2),e.Q6J("ngIf",l.smsCount.count<=40)}}function b(p,v){if(1&p&&(e.TgZ(0,"div",1)(1,"div"),e.YNc(2,x,13,12,"div",2),e.qZA(),e.TgZ(3,"div",3)(4,"a",4),e._UZ(5,"span",5),e._uU(6),e.ALo(7,"translate"),e.qZA()()()),2&p){const l=e.oxw();e.xp6(2),e.Q6J("ngIf",l.smsCount),e.xp6(4),e.hij(" \xa0 ",e.lcZ(7,2,"smsReminder.buyMoreSMS"),"")}}let Z=(()=>{class p{constructor(l,d){this._helpService=l,this._service=d,this.smsCount={count:0},this.loader=!0}ngOnInit(){this.getNumberOfSms()}getNumberOfSms(){this.loader=!0,this._service.callGetMethod("/api/getNumberOfSms","").subscribe(l=>{l.length&&(this.smsCount=l[0],this.loader=!1)})}generateProgressBar(){return this.smsCount.count+"%"}static#e=this.\u0275fac=function(d){return new(d||p)(e.Y36(t.s),e.Y36(_.f))};static#t=this.\u0275cmp=e.Xpm({type:p,selectors:[["app-sms-counter"]],decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],["class","plan-statistics pt-1",4,"ngIf"],[1,"text-right"],["routerLink","/dashboard/admin/payment/buy-more-sms",1,"btn","btn-primary"],[1,"fa","fa-shopping-cart"],[1,"plan-statistics","pt-1"],[1,"d-flex","justify-content-between"],[1,"fw-bolder"],["class","progress",4,"ngIf"],[1,"mt-50"],["class","text-danger",4,"ngIf"],[1,"progress"],["role","progressbar","aria-valuenow","12","aria-valuemin","0","aria-valuemax","100",3,"ngStyle"],[1,"text-danger"]],template:function(d,M){1&d&&e.YNc(0,b,8,4,"div",0),2&d&&e.Q6J("ngIf",!M.loader)},dependencies:[u.O5,u.PC,T.rH,P.X$],styles:[".progress-bar-error[_ngcontent-%COMP%]{background:#ef0000!important}.progress-bar-warning[_ngcontent-%COMP%]{background:#d3be04!important}.recommended[_ngcontent-%COMP%]{font-size:10px}"]})}return p})()}}]);