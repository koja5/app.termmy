"use strict";(self.webpackChunktermmy=self.webpackChunktermmy||[]).push([[331],{5331:(Y,p,n)=>{n.r(p),n.d(p,{AccountSettingsModule:()=>E});var h=n(8723),d=n(8516),f=n(6895),u=n(1494),r=n(4329),t=n(4650),g=n(8262),C=n(2684),w=n(5048),c=n(5819),y=n(979);const P=["form"];function S(o,F){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"app-avatar-uploader",3),t.NdJ("uploadEmitter",function(a){t.CHM(e);const i=t.oxw();return t.KtG(i.uploadEmitter(a))}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("data",e.data)("defaultImage","no-user-profile.png")}}let _=(()=>{class o{constructor(e,s,a,i){this._service=e,this._toastr=s,this._messageService=a,this._storageService=i,this.path="pages/account-settings",this.file="general.json",this.avatarImage="../../../../../assets/images/portrait/small/avatar-s-11.jpg"}ngOnInit(){this._service.callGetMethod("/api/getProfileInfo","").subscribe(e=>{e&&e.length&&(this.data=e[0])})}unsavedChanges(){return this.form.unsavedChanges()}submit(e){"submit"!=e.type&&this._service.callPostMethod("api/saveProfileInfo",e).subscribe(s=>{s?(this._toastr.showSuccess(),this.sendInfoForSetupApp(),this._messageService.sendCurrentUser(e)):this._toastr.showError()})}uploadEmitter(e){this._service.callPostMethod("api/uploadUserProfile",e).subscribe(s=>{s?(this._messageService.sendAvatarProfile(s.avatar),this._storageService.setToken(s.token),this._toastr.showSuccess()):this._toastr.showError()})}sendInfoForSetupApp(){if(this._storageService.getSessionStorage("setup")){let e=this._storageService.getSessionStorage("setup");e.account_data=!0,this._messageService.sendSetupApp(e)}}static#t=this.\u0275fac=function(s){return new(s||o)(t.Y36(g.f),t.Y36(r.l),t.Y36(C.e),t.Y36(w.V))};static#s=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-general"]],viewQuery:function(s,a){if(1&s&&t.Gf(P,5),2&s){let i;t.iGM(i=t.CRH())&&(a.form=i.first)}},decls:3,vars:3,consts:[[4,"ngIf"],[3,"path","file","submit"],["form",""],[3,"data","defaultImage","uploadEmitter"]],template:function(s,a){1&s&&(t.YNc(0,S,2,2,"div",0),t.TgZ(1,"app-dynamic-forms",1,2),t.NdJ("submit",function(l){return a.submit(l)}),t.qZA()),2&s&&(t.Q6J("ngIf",a.data),t.xp6(1),t.Q6J("path",a.path)("file",a.file))},dependencies:[f.O5,c.b,y.M]})}return o})();var T=n(4398);const G=["form"];let I=(()=>{class o{constructor(e,s,a){this._service=e,this._toastr=s,this._translate=a,this.path="pages/account-settings",this.file="change-password.json"}unsavedChanges(){return this.form.unsavedChanges()}resetPassword(e){console.log(e),e.oldPassword===e.newPassword?this._toastr.showWarningCustom(this._translate.instant("resetPassword.oldAndNewPasswordCannotBeSame")):e.newPassword!==e.repeatNewPassword?this._toastr.showWarningCustom(this._translate.instant("resetPassword.passwordsNeedToBeSame")):this._service.callPostMethod("/api/changePassword",e).subscribe(s=>{s?this._toastr.showSuccessCustom(this._translate.instant("resetPassword.successfulyChangedPassword")):this._toastr.showWarningCustom(this._translate.instant("resetPassword.oldPasswordIsWrong"))})}static#t=this.\u0275fac=function(s){return new(s||o)(t.Y36(g.f),t.Y36(r.l),t.Y36(T.sK))};static#s=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-change-password"]],viewQuery:function(s,a){if(1&s&&t.Gf(G,5),2&s){let i;t.iGM(i=t.CRH())&&(a.form=i.first)}},decls:2,vars:2,consts:[[3,"path","file","submit"],["form",""]],template:function(s,a){1&s&&(t.TgZ(0,"app-dynamic-forms",0,1),t.NdJ("submit",function(l){return a.resetPassword(l)}),t.qZA()),2&s&&t.Q6J("path",a.path)("file",a.file)},dependencies:[c.b]})}return o})();const M=["form"];let Q=(()=>{class o{constructor(){this.path="pages/account-settings",this.file="information.json"}unsavedChanges(){return this.form.unsavedChanges()}static#t=this.\u0275fac=function(s){return new(s||o)};static#s=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-information"]],viewQuery:function(s,a){if(1&s&&t.Gf(M,5),2&s){let i;t.iGM(i=t.CRH())&&(a.form=i.first)}},decls:2,vars:2,consts:[[3,"path","file"],["form",""]],template:function(s,a){1&s&&t._UZ(0,"app-dynamic-forms",0,1),2&s&&t.Q6J("path",a.path)("file",a.file)},dependencies:[c.b]})}return o})();var v=n(202),A=n(930),J=n(1463),m=n(5497);const Z=[{path:"general",component:_,canDeactivate:[m.T]},{path:"change-password",component:I,canDeactivate:[m.T]},{path:"information",component:Q,canDeactivate:[m.T]}];let E=(()=>{class o{static#t=this.\u0275fac=function(s){return new(s||o)};static#s=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({providers:[r.l],imports:[f.ez,d.M,u.Z,h.Bz.forChild(Z),v.w,A.Q,J._,h.Bz,d.M,u.Z,v.w]})}return o})()}}]);